(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    534994,      11946]
NotebookOptionsPosition[    486089,      11134]
NotebookOutlinePosition[    486475,      11151]
CellTagsIndexPosition[    486432,      11148]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["PrimiCosmo", "Title",
 CellChangeTimes->{{3.772866992255372*^9, 3.7728670085361977`*^9}},
 TextAlignment->Center,
 Background->RGBColor[
  1, 0.925, 0.925],ExpressionUUID->"3c9e8cc7-abe9-4e05-bc8e-413892c2a1ef"],

Cell[TextData[{
 "Time integration of the Cosmology and weak rates for input into ",
 StyleBox["PrimiNuc",
  FontWeight->"Bold"],
 ". Options to run within the Standard Model, with additional radiation ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["\[CapitalDelta]N", "eff"], ")"}], TraditionalForm]],
  ExpressionUUID->"6ba02868-7d09-4427-8801-10195831cd7b"],
 ", or within the full WIMP paradigm."
}], "Text",
 CellDingbat->"\[FivePointedStar]",
 CellChangeTimes->{{3.772867030462081*^9, 3.77286708171566*^9}, {
  3.772867295829935*^9, 3.772867317788845*^9}, {3.772867786572171*^9, 
  3.772867794102057*^9}, {3.772867867136854*^9, 3.772867884228609*^9}, {
  3.77286792891523*^9, 3.7728679634007893`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"c91b633a-faae-415f-b6bc-8385fb70d333"],

Cell[CellGroupData[{

Cell["Usage", "Section",
 CellChangeTimes->{{3.772868344529077*^9, 3.7728683587846947`*^9}},
 Background->GrayLevel[
  1],ExpressionUUID->"b512a19a-7c9e-44d4-aecc-6f39cc96852a"],

Cell[TextData[{
 StyleBox["PrimiCosmo",
  FontWeight->"Bold"],
 " performs the cosmological evolution that is necessary for input into the \
nuclear reaction section given in ",
 StyleBox["PrimiNuc",
  FontWeight->"Bold"],
 ". Within this script, options for the various cosmological parameters such \
as the number of neutrino species, the evolution type, the temperature ranges \
etc. are made available. Options for the size of the reaction network \
(usually either 12, 17, or the full 423 reactions), the baryon density ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["\[CapitalOmega]", "b"], ")"}], TraditionalForm]],
  ExpressionUUID->"e057bf6d-a0a3-408c-91ce-7518963ea347"],
 " are made available in ",
 StyleBox["PrimiNuc",
  FontWeight->"Bold"],
 ". Importantly, for both ",
 StyleBox["PrimiCosmo",
  FontWeight->"Bold"],
 " and ",
 StyleBox["PrimiNuc",
  FontWeight->"Bold"],
 ", there are associated ",
 StyleBox[".m",
  FontSlant->"Italic"],
 " files that can be called in an external notebook with suitable \
definitions.\n\nThe modular structure of the two scripts enables easier \
parameter evaluation: the cosmology takes some time to evaluate, whilst the \
nuclear reaction rates are comparatively fast. As an example, if one is \
interested in the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["m", "\[Chi]"], ",", " ", 
     SubscriptBox["\[CapitalOmega]", "b"]}], ")"}], TraditionalForm]],
  ExpressionUUID->"9fcc7df0-5f81-4384-91cc-5ccda4d432ec"],
 " parameter space, then it is unnecessary to evaluate both ",
 StyleBox["PrimiCosmo",
  FontWeight->"Bold"],
 " and ",
 StyleBox["PrimiNuc",
  FontWeight->"Bold"],
 " for every parameter pair. Instead, for each ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "\[Chi]"], TraditionalForm]],ExpressionUUID->
  "8d13409c-a664-478a-a5ce-08ac6f85edec"],
 ", one should compute the cosmology and weak rates using ",
 StyleBox["PrimiCosmo",
  FontWeight->"Bold"],
 ", then for each ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalOmega]", "b"], TraditionalForm]],ExpressionUUID->
  "ad6d5e00-64d7-4943-89c5-1a6dee20035b"],
 " evaluate ",
 StyleBox["PrimiNuc",
  FontWeight->"Bold"],
 ", maintaining the cosmology. This will be considerably more efficient that \
evaluating both each time.\n\n",
 StyleBox["Note:",
  FontWeight->"Bold"],
 " definitions of these quantities made outside of ",
 StyleBox["PrimiCosmo",
  FontWeight->"Bold"],
 " will be overwritten at the start of this script.\n\nThis code is based on \
the original ",
 StyleBox["PRIMAT",
  FontWeight->"Bold"],
 " code [Pitrou, Coc, Uzan, Vangioni, Physics Reports, 04, (2018) 005]. For a \
complete list of references, please see the companion script."
}], "Text",
 CellChangeTimes->{{3.77286837598243*^9, 3.772868378366323*^9}, {
  3.772868657437191*^9, 3.772868895416708*^9}, {3.772868943426169*^9, 
  3.7728692035025377`*^9}, {3.772869353070979*^9, 3.772869367808241*^9}, {
  3.77287073178685*^9, 3.772870742523951*^9}, {3.772873741204465*^9, 
  3.7728737929281483`*^9}, {3.772873899961259*^9, 3.7728739037548037`*^9}},
 Background->RGBColor[
  0.9, 1, 1],ExpressionUUID->"7e89d71e-8245-4bd5-a66a-34986c2a03e2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Options", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.695012395561967*^9, 3.6950123998787746`*^9}, {
  3.715915191595689*^9, 
  3.715915192671303*^9}},ExpressionUUID->"3b47fbb6-a0dd-4746-bc0f-\
7e11ddb90e05"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Print", "[", "\"\<[PrimiCosmo]: Setting up options\>\"", "]"}], 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{"timingStart", " ", "=", " ", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}]}]], "Code",
 CellChangeTimes->{{3.772876642213325*^9, 3.772876653426634*^9}, {
   3.772876855569392*^9, 3.77287687372314*^9}, 
   3.773176531907507*^9},ExpressionUUID->"e4915f6f-84f0-44b4-8693-\
4bb34eb57aff"],

Cell[BoxData["\<\"[PrimiCosmo]: Setting up options\"\>"], "Print",
 CellChangeTimes->{3.772953199238542*^9, 3.772953270191057*^9, 
  3.772953675427761*^9, 3.772955784348278*^9},
 CellLabel->
  "During evaluation of \
In[816]:=",ExpressionUUID->"2d89178c-84c6-47d3-8fed-9c152e6a2245"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Directory set up", "Subsection",
 CellChangeTimes->{{3.700388898653942*^9, 
  3.700388907022374*^9}},ExpressionUUID->"c2a1c7cf-fbf7-40d7-b25f-\
ef0dc5406c0a"],

Cell["We set the directory.", "Text",
 CellChangeTimes->{{3.722682224785334*^9, 
  3.7226822296671753`*^9}},ExpressionUUID->"c91126d0-558a-4a7f-9deb-\
d6afa88282dd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Code",
 CellChangeTimes->{{3.722682206331841*^9, 3.722682211823627*^9}},
 CellLabel->
  "In[818]:=",ExpressionUUID->"064612ab-a9e6-48d5-be1f-bb5757d161aa"],

Cell[BoxData["\<\"/home/k1801946/Work/Projects/WIMP_BBN/PrimiDM\"\>"], \
"Output",
 CellChangeTimes->{3.7729531994269657`*^9, 3.772953270241556*^9, 
  3.7729536755385323`*^9, 3.7729557844071913`*^9},
 CellLabel->
  "Out[818]=",ExpressionUUID->"8deabded-1ee6-41c2-bc32-2f2ad29dc383"]
}, Open  ]],

Cell["To check what is the directory of your notebook :", "Text",ExpressionUUID->"51dbdcbb-414b-416d-9766-99a00845a12d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Print", "[", 
   RowBox[{"\"\<[PrimiCosmo]: The current Directory is \>\"", ",", " ", 
    RowBox[{"Directory", "[", "]"}]}], "]"}], "*)"}]], "Code",
 CellChangeTimes->{{3.715934717642374*^9, 3.7159347191378*^9}, {
   3.722682186508512*^9, 3.7226821883969088`*^9}, {3.725368999168663*^9, 
   3.7253690012051907`*^9}, {3.725369274710095*^9, 3.725369281562478*^9}, {
   3.7728694464375677`*^9, 3.772869457028479*^9}, 3.772877355606821*^9, 
   3.773176536292513*^9},ExpressionUUID->"01ee0912-a99f-403b-9928-\
d46fbcd5d1f3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"[PrimiCosmo]: The current Directory is \"\>", 
   "\[InvisibleSpace]", \
"\<\"/home/k1801946/Work/Projects/WIMP_BBN/PrimiDM\"\>"}],
  SequenceForm[
  "[PrimiCosmo]: The current Directory is ", 
   "/home/k1801946/Work/Projects/WIMP_BBN/PrimiDM"],
  Editable->False]], "Print",
 CellChangeTimes->{3.7729531994485617`*^9, 3.77295327027929*^9, 
  3.7729536755575047`*^9, 3.772955784434575*^9},
 CellLabel->
  "During evaluation of \
In[819]:=",ExpressionUUID->"4692f2de-f16f-4bb1-b791-462b0ae5aace"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Standard Model or Beyond?", "Subsection",
 CellChangeTimes->{{3.700386248040779*^9, 3.700386252678885*^9}, {
  3.715935868203154*^9, 3.715935868338502*^9}, {3.715958398945217*^9, 
  3.715958399494912*^9}, {3.772361451609809*^9, 3.772361459438465*^9}, {
  3.772869517850683*^9, 
  3.772869536975716*^9}},ExpressionUUID->"1837f081-9c3d-4dda-a6e9-\
f2e480bf68f5"],

Cell[TextData[{
 "We want the ability to choose whether we run the evolution within the \
standard model, or beyond. This is done by setting the flag ",
 StyleBox["$EvolutionType", "Input"],
 " below. There are three cases:\n\n",
 StyleBox["1.",
  FontSlant->"Italic"],
 " ",
 StyleBox["Standard Model \
(\[OpenCurlyDoubleQuote]SBBN\[CloseCurlyDoubleQuote])",
  FontWeight->"Bold"],
 " - computes the evolution in the Standard Model, no additional parameters \
are required.\n\n",
 StyleBox["2.",
  FontSlant->"Italic"],
 " ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalDelta]N", "eff"], TraditionalForm]],ExpressionUUID->
  "940a911b-3adb-4a14-88e9-6da3cd297d7d"],
 " ",
 StyleBox["(\[OpenCurlyDoubleQuote]Neff\[CloseCurlyDoubleQuote])",
  FontWeight->"Bold"],
 " - computes the evolution with additional radiation that leads to an \
enhancement of the Hubble rate. \n\n",
 StyleBox["This requires an additional parameter:",
  FontSlant->"Italic"],
 StyleBox[" ",
  FontWeight->"Bold"],
 StyleBox["\[CapitalDelta]Neffective", "Input",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["3.",
  FontSlant->"Italic"],
 " ",
 StyleBox["WIMPs (\[OpenCurlyDoubleQuote]WIMP\[CloseCurlyDoubleQuote])",
  FontWeight->"Bold"],
 " - computes the evolution with additional WIMP degrees of freedom that may \
annihilate into neutrinos, or electrons, or both.\n\n",
 StyleBox["This requires additional parameters:",
  FontSlant->"Italic"],
 StyleBox[" ",
  FontWeight->"Bold"],
 StyleBox["WIMPCase", "Input",
  FontWeight->"Bold"],
 StyleBox[", ",
  FontWeight->"Bold"],
 StyleBox["WIMPSpin", "Input",
  FontWeight->"Bold"],
 StyleBox[", ",
  FontWeight->"Bold"],
 StyleBox["WIMPgDM", "Input",
  FontWeight->"Bold"],
 StyleBox[", ",
  FontWeight->"Bold"],
 StyleBox["WIMPmDM,\[Sigma]v,BR\n\n", "Input",
  FontWeight->"Bold"],
 "Additionally, we choose which temperature to start the integration (in MeV) \
via the TnuStart variable."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.772361471895095*^9, 3.772361514494488*^9}, {
  3.772869542427751*^9, 3.772869623772221*^9}, {3.772869655086776*^9, 
  3.772869869465836*^9}, {3.772869925031715*^9, 3.7728699602650747`*^9}, {
  3.7728700155476093`*^9, 3.7728700313170547`*^9}, {3.772870078785355*^9, 
  3.7728702041894293`*^9}, {3.772870300904882*^9, 3.7728703040080967`*^9}, {
  3.773557404550207*^9, 3.773557422014119*^9}},
 Background->RGBColor[
  0.9, 1, 1],ExpressionUUID->"dc657191-56d4-48b9-914c-53c8385d1513"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical options", "Subsection",
 CellChangeTimes->{{3.700386248040779*^9, 3.700386252678885*^9}, {
  3.715935868203154*^9, 3.715935868338502*^9}, {3.715958398945217*^9, 
  3.715958399494912*^9}},ExpressionUUID->"2cf451b4-9072-4b3a-a9e8-\
d58397e7f50f"],

Cell[TextData[StyleBox["Miscellaneous options",
 FontVariations->{"Underline"->True}]], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{{3.7003874778008842`*^9, 3.700387483482605*^9}},
 FontSize->18,ExpressionUUID->"901f7b72-5f3b-49a4-b3b1-9c41a464b178"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$InterpolateAnalytics", "=", "True"}], ";"}]], "Code",
 CellChangeTimes->{{3.6993851579081182`*^9, 3.699385171547063*^9}, {
   3.6993871628730707`*^9, 3.6993871742117243`*^9}, {3.6994980068207912`*^9, 
   3.699498013232003*^9}, {3.6994980471047583`*^9, 3.699498066153912*^9}, {
   3.699498829699747*^9, 3.6994988325017776`*^9}, {3.699500777082651*^9, 
   3.699500777284808*^9}, {3.699501312634569*^9, 3.6995013127713747`*^9}, {
   3.699501554692258*^9, 3.6995015550111847`*^9}, {3.6995016329069557`*^9, 
   3.699501634671427*^9}, {3.6995019317414703`*^9, 3.699501931837109*^9}, {
   3.699502055510841*^9, 3.699502055834709*^9}, {3.6995026901575336`*^9, 
   3.6995026921821537`*^9}, {3.699504648643374*^9, 3.6995046489371*^9}, {
   3.6995115333755903`*^9, 3.699511568613559*^9}, {3.699521402762865*^9, 
   3.699521403085367*^9}, {3.699531449767974*^9, 3.699531450211914*^9}, {
   3.69959296250591*^9, 3.6995929640353413`*^9}, {3.699622886200637*^9, 
   3.699622886559758*^9}, {3.6996237952363453`*^9, 3.699623795473084*^9}, {
   3.6996465536489677`*^9, 3.6996465542379932`*^9}, {3.699647378033855*^9, 
   3.699647378373828*^9}, {3.6996476566591883`*^9, 3.699647663351665*^9}, {
   3.6996673837872*^9, 3.699667384453459*^9}, {3.69966837915664*^9, 
   3.6996683796961813`*^9}, {3.6996696576211576`*^9, 
   3.6996696602707376`*^9}, {3.699670944139523*^9, 3.699670944686871*^9}, {
   3.699688854664543*^9, 3.6996888550290203`*^9}, {3.699689990760703*^9, 
   3.6996899910443373`*^9}, {3.6996903689591208`*^9, 3.69969036952099*^9}, {
   3.699692220098979*^9, 3.699692220502163*^9}, {3.699692763412039*^9, 
   3.699692764408255*^9}, {3.69969282573429*^9, 3.699692826063775*^9}, {
   3.6996933509189177`*^9, 3.6996933514360743`*^9}, {3.699693562028426*^9, 
   3.699693562424254*^9}, {3.699694810187776*^9, 3.699694869883012*^9}, {
   3.699695532710252*^9, 3.699695535154801*^9}, {3.6996969945436897`*^9, 
   3.699696997068583*^9}, {3.699697487900846*^9, 3.699697490222937*^9}, {
   3.699697640709153*^9, 3.699697643320229*^9}, {3.699698407010436*^9, 
   3.699698409184853*^9}, {3.699698885799039*^9, 3.6996988882862387`*^9}, {
   3.699699288814641*^9, 3.699699295499733*^9}, {3.6997000782856703`*^9, 
   3.699700080530895*^9}, {3.699701816000592*^9, 3.699701816107732*^9}, {
   3.6997019320280457`*^9, 3.699701936706863*^9}, {3.699714710260702*^9, 
   3.699714712608279*^9}, {3.699714787744051*^9, 3.6997147903923798`*^9}, {
   3.699715176022615*^9, 3.699715183697859*^9}, {3.699719029466969*^9, 
   3.699719030172571*^9}, {3.6997220329183064`*^9, 3.6997220368023367`*^9}, {
   3.699722148835596*^9, 3.6997221492843246`*^9}, {3.699723510600781*^9, 
   3.699723513755426*^9}, {3.699756924584221*^9, 3.6997569248539963`*^9}, {
   3.6997613689556932`*^9, 3.6997613693997097`*^9}, {3.699762028465411*^9, 
   3.6997620290141172`*^9}, {3.699762070533902*^9, 3.69976207079259*^9}, {
   3.699762157614708*^9, 3.69976215806005*^9}, {3.699762204507255*^9, 
   3.699762212614214*^9}, {3.6997645558768663`*^9, 3.699764556403019*^9}, {
   3.699764792539681*^9, 3.699764814483069*^9}, 3.699765661492612*^9, {
   3.6997664736810493`*^9, 3.699766473780732*^9}, {3.699766614885934*^9, 
   3.699766614998595*^9}, {3.6997675603215103`*^9, 3.6997675623860903`*^9}, {
   3.699768306156986*^9, 3.699768331500252*^9}, {3.6997687161312113`*^9, 
   3.699768716550766*^9}, {3.699768925559492*^9, 3.699768926150402*^9}, {
   3.699779630275642*^9, 3.6997796341065073`*^9}, {3.699780965213791*^9, 
   3.6997809657057533`*^9}, {3.699782892937398*^9, 3.699782893092393*^9}, {
   3.699783655842507*^9, 3.699783656072939*^9}, {3.699783774223328*^9, 
   3.699783774496297*^9}, {3.699783848844009*^9, 3.69978384914837*^9}, {
   3.6997839568653584`*^9, 3.6997839724181356`*^9}, {3.69978409184991*^9, 
   3.699784092166213*^9}, {3.69978419579592*^9, 3.6997841961983023`*^9}, {
   3.69980181137759*^9, 3.6998018156709013`*^9}, {3.699803045029594*^9, 
   3.699803045304406*^9}, {3.699803585366123*^9, 3.6998035856670856`*^9}, {
   3.699806642720119*^9, 3.699806643152996*^9}, {3.699809226799025*^9, 
   3.699809241989298*^9}, {3.699811370604949*^9, 3.699811370908113*^9}, {
   3.6998119062504463`*^9, 3.699811906530702*^9}, {3.6998141005671053`*^9, 
   3.6998141008294992`*^9}, {3.6998160339833717`*^9, 3.699816034353244*^9}, {
   3.6998163509534388`*^9, 3.699816351256494*^9}, 3.6998422048187227`*^9, 
   3.699859549470825*^9, {3.699866586973955*^9, 3.699866587334921*^9}, {
   3.6998675604045277`*^9, 3.6998675846520348`*^9}, {3.699868150285165*^9, 
   3.699868150730953*^9}, {3.699871171054047*^9, 3.699871171316018*^9}, {
   3.699872075063282*^9, 3.6998720763219557`*^9}, {3.699872250993477*^9, 
   3.699872253592835*^9}, {3.699872407895013*^9, 3.699872408769968*^9}, 
   3.699872959853964*^9, {3.699873085404492*^9, 3.699873089340497*^9}, {
   3.699873184521987*^9, 3.699873184716598*^9}, {3.699873892260991*^9, 
   3.699873892607905*^9}, {3.6998853535813503`*^9, 3.699885353781975*^9}, {
   3.6998915893130836`*^9, 3.699891589577952*^9}, {3.6998917429729548`*^9, 
   3.699891743298614*^9}, {3.699891971337031*^9, 3.699891971808669*^9}, {
   3.6998949637609787`*^9, 3.699894963990222*^9}, {3.699895018562688*^9, 
   3.699895043716029*^9}, {3.6999311600107517`*^9, 3.699931160430458*^9}, {
   3.699946250485629*^9, 3.699946253373908*^9}, {3.699964056297092*^9, 
   3.699964060548348*^9}, {3.699964460284672*^9, 3.699964460768565*^9}, {
   3.699984749298872*^9, 3.699984750000888*^9}, {3.699985566615521*^9, 
   3.699985589296213*^9}, {3.69998566692557*^9, 3.699985667312055*^9}, {
   3.6999875306703663`*^9, 3.69998753094168*^9}, {3.7000292060087357`*^9, 
   3.7000292064761*^9}, {3.700030870800231*^9, 3.700030871069438*^9}, {
   3.700036397622569*^9, 3.7000364192459497`*^9}, {3.700038880145607*^9, 
   3.7000388804464397`*^9}, {3.700039493050254*^9, 3.7000394933455057`*^9}, {
   3.700041632641609*^9, 3.700041644322692*^9}, {3.7000417623632507`*^9, 
   3.700041762530818*^9}, {3.700042655350807*^9, 3.700042655452952*^9}, {
   3.700105639279317*^9, 3.7001056825626717`*^9}, {3.700122671268909*^9, 
   3.7001226714503183`*^9}, {3.700124130485792*^9, 3.7001241307636347`*^9}, {
   3.70012660430228*^9, 3.700126604724139*^9}, {3.700126743351804*^9, 
   3.7001267434561987`*^9}, {3.7001268600452414`*^9, 3.700126860225748*^9}, {
   3.700126959208153*^9, 3.7001269595221443`*^9}, {3.700127122242919*^9, 
   3.700127122466166*^9}, {3.700127799139182*^9, 3.7001277992149963`*^9}, {
   3.700128869954145*^9, 3.700128872172079*^9}, {3.700129288750081*^9, 
   3.700129289071319*^9}, {3.700130498228897*^9, 3.700130498588275*^9}, {
   3.7001310355739403`*^9, 3.70013103590257*^9}, {3.700132724552187*^9, 
   3.700132724826078*^9}, {3.700134294304407*^9, 3.700134294667096*^9}, {
   3.700134455323429*^9, 3.700134455496903*^9}, {3.700190046134569*^9, 
   3.700190046599684*^9}, {3.700192007372541*^9, 3.700192008070567*^9}, {
   3.700195130963665*^9, 3.700195134513412*^9}, {3.70021913880686*^9, 
   3.7002191393222933`*^9}, {3.700220893831923*^9, 3.70022090610618*^9}, {
   3.700221378233905*^9, 3.700221378691883*^9}, {3.700223734283134*^9, 
   3.7002237346638927`*^9}, {3.700224761328206*^9, 3.700224774566152*^9}, {
   3.7002248447127047`*^9, 3.7002248448689003`*^9}, {3.700225025649411*^9, 
   3.7002250395230837`*^9}, {3.700225151885483*^9, 3.700225152200747*^9}, {
   3.700225359193519*^9, 3.700225359304632*^9}, {3.700225669761804*^9, 
   3.700225670133162*^9}, {3.700226425036557*^9, 3.700226425508707*^9}, {
   3.700227169322074*^9, 3.7002271698288317`*^9}, {3.700228420051654*^9, 
   3.700228420389411*^9}, {3.700280881183958*^9, 3.700280881465399*^9}, {
   3.700281808102818*^9, 3.7002818083325977`*^9}, {3.70028294104377*^9, 
   3.7002829412089453`*^9}, {3.700289043077441*^9, 3.700289043255047*^9}, {
   3.70033344538449*^9, 3.700333446065071*^9}, {3.700333607937181*^9, 
   3.700333608086746*^9}, {3.700335465757985*^9, 3.700335465980031*^9}, {
   3.700335554627718*^9, 3.700335555142362*^9}, {3.700361690042951*^9, 
   3.700361690327042*^9}, {3.700368380563295*^9, 3.70036838109101*^9}, {
   3.700368508706696*^9, 3.7003685091689043`*^9}, {3.7003708303499928`*^9, 
   3.700370830559111*^9}, {3.700386239279207*^9, 3.700386279241996*^9}, {
   3.700386361830824*^9, 3.700386366150415*^9}, {3.700386396244464*^9, 
   3.700386445047923*^9}, {3.7003869390498867`*^9, 3.7003869393160477`*^9}, {
   3.700387455083169*^9, 3.700387462587202*^9}, {3.700389511566636*^9, 
   3.700389513171974*^9}, {3.7033022269340153`*^9, 3.703302227270458*^9}, {
   3.713873316913414*^9, 3.713873317538663*^9}, {3.71387338060046*^9, 
   3.713873381046557*^9}, {3.7138737951877127`*^9, 3.713873795980659*^9}, {
   3.7138738890347013`*^9, 3.713873889700223*^9}, {3.713874138356083*^9, 
   3.713874138712947*^9}, {3.713874505018674*^9, 3.713874505541852*^9}, {
   3.715915207579438*^9, 3.7159152274198914`*^9}, {3.7159164550373287`*^9, 
   3.715916500966976*^9}, {3.715918531128077*^9, 3.715918531470234*^9}, {
   3.71591860084583*^9, 3.7159186035024242`*^9}, {3.715918671880755*^9, 
   3.7159186744766417`*^9}, {3.722608235461269*^9, 3.722608237124321*^9}, {
   3.722608443072672*^9, 3.722608443479356*^9}},
 CellLabel->
  "In[822]:=",ExpressionUUID->"75269f01-b031-482d-a93f-cdc45f2113cc"],

Cell["\<\
It is slightly faster to interpolate the analytic expressions of nuclear \
reaction rates. Setting $InterpolateAnalytics to True is recommended.\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"0f6aa57c-96df-4655-ad8a-1b21e57970f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$HistoryLength", " ", "=", " ", "10"}], ";"}]], "Code",
 CellChangeTimes->{{3.7728702674509363`*^9, 3.7728702682269173`*^9}},
 CellLabel->
  "In[823]:=",ExpressionUUID->"3f3efe54-2614-4237-bcda-ebb18f47fae0"],

Cell[TextData[{
 "This is to avoid ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to store too many results in memory. Only the past $HistoryLength results \
are kept in computer memory (this is standard Mathematica option)."
}], "Text",ExpressionUUID->"865ef279-642e-4ec6-8cd1-1e51851903a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$PaperPlots", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ResultsPlots", "=", "False"}], ";"}]}], "Code",
 CellChangeTimes->CompressedData["
1:eJwdx1soA2AYgOE5JLMSF0hbNGokLOeU1F+2JJqYZZRkSIjlhiKHUlYyLdYm
kcOEie1iJXNoZnPMLqTNBeWClH+5MKIlfP938fb0Clt6a9pCORxOMsSsiDvS
GyyUKPKTDEzfw6WbZ6Wkj96jvPTDKBsolZyjw9ySJY6NEuufHM2YN+/GsE9W
25nP84N6EWje9KJ3ykz9DvjqGEETP3J9FtBwq0X9b0Pxsl1KvuqfUNd6p5h5
P3CBrn2al+vANGHSClM/dffuARXbRQEmnZ7c/ANbzz5QwY1G+bsH0ke0YWPF
GGqnZFwdPceczfpZzQO5ZYkmZvDppT8fzNiSDDAvf4PXUtCli/SgouBJOdjt
57uYO0rVaeU+JYVTbnTx1ZlSBdbIslOZTSqZfeKAkhmpCa2bVX0bQXexD+0R
p3Q8OCjJHROjo9VyIzOobUcTvM0O7jEl9YEu1FtouWLmlTlRrUYQ0gxW9unQ
9Rz3Ugvo6oxdZgYWvPwwJyW1pkYBU35eUBoOjkRY0X8MHxJQ
  "],
 CellLabel->
  "In[824]:=",ExpressionUUID->"57902212-09f8-43b6-b001-c45a1c1872c1"],

Cell["\<\
If $PaperPlots is set to True, the most important plots are constructed and \
they are output in pdf in the \[OpenCurlyQuote]Plots\[CloseCurlyQuote] \
subfolder. 
Unless interested in reproducing the plots of the companion paper, this \
should be set to False to avoid any loss of time in the code.

If $ResultsPlots is True the results for the abundances are plotted at the \
end. Similarly, to avoid loss of time this shouldbe set to False.\
\>", "Text",
 CellChangeTimes->{{3.715939517310541*^9, 3.715939599575901*^9}, 
   3.716005655861353*^9, {3.718284757113055*^9, 3.718284798261767*^9}, {
   3.7226083975533943`*^9, 3.722608397810335*^9}, {3.725262868761351*^9, 
   3.725262878210779*^9}},ExpressionUUID->"c0d10c85-4930-4caa-9988-\
efe74a26a891"],

Cell[TextData[StyleBox["Numerical precision",
 FontVariations->{"Underline"->True}]], "Text",
 CellDingbat->"\[FilledSquare]",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwd0XtIE3AQB/Chs8hAXToxY0PNpMJsmahhmnO6ReLIVxM1kDXzuawJGjEr
XyWSayqKczplaTYcllnR5owEW7MkM1NTUlapqPOxaAmKUr+7P44PB3f3x/e8
hQUJmXYUCiWcFMh3Hsimyi3s6tIbuWCgNe2KA1FiNIrAVc5MWRixLr+rHAxI
/XUfnF6NrgaTRK+WQbmTywro1ukze5boxziGivhuXuFEz6ce6LbfpQiwPS0D
NTkwzoNJ0mTUS18sBhXDt9DRFKsUtL7cRiscY0bAoK+VaGWj22AEUbfDQCep
WkYUkat29QFFOSkbXLjfL0Qj6kOnYokUExfNZV0058Bd71JUlWeU3oQ8lsdQ
X3nWOlh6uABNGQraX0HsaOWhAjpbAl7djEUPeNAbwKlIC/qGtRUsIxrKnELA
QPvMPpDJK0LvmU8nPiT+1FShW0VUGzi9TUetnInnTbC/ZkZ7BN8iFcTgvB8o
s5d5HfzTzUInj5cLmomvaXI0/6RYCYpdalD+nZBHoMQxCjVmzc6DCbY1dG4p
8h9YUh+Hcuy4SiVRzTaoQaG+8S/obZtHlzLjtS3EiVNqtH98ZxmM8+GtgMJe
910w/lwuejvZnN4K/cqRy6C+VtcEzh3dpwCraZ4fwc+7G2iw7/AJFdFj1yUA
nKFS9rbBnMQefbtwlw62qdzdQa3AlNBJ3FPsmghGjxangxmyEZSjo9SA35M2
0ZzfPde6iC8q36FDQsbiE/ibVoEGDTTbQNZBDao4M67SEAv9Q9tAa2/dhg5M
VKKODcxDBsj9gz/6eF4mRgvbUT19TAIupk+jz7r7SsB1yyBaECYvBzu66ivA
C85SzQCxauEBSouhvQepqTwTaJswfFqrtbDtZNlfwP/l2AsZ
  "],
 FontSize->18,ExpressionUUID->"abb0629c-ed68-4f46-a702-60c570246c9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CompileNDSolve", "=", "True"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.715918537297937*^9, 3.715918569352591*^9}, {
  3.715918783122307*^9, 3.7159187866242228`*^9}, {3.722071043305422*^9, 
  3.722071043907363*^9}, {3.722071187041388*^9, 3.722071187436411*^9}, {
  3.722071287316352*^9, 3.7220712878917723`*^9}, {3.722071527085211*^9, 
  3.722071527619399*^9}, {3.722760816744903*^9, 3.72276081736005*^9}, {
  3.72276142119522*^9, 3.722761421618855*^9}, {3.772436006621378*^9, 
  3.772436007398088*^9}},
 CellLabel->
  "In[826]:=",ExpressionUUID->"e0902b2a-66d7-42bf-8174-db9ec38b269e"],

Cell["\<\
If $CompileNDSolve is set to True (advised), then the differential equation \
solver uses compiled functions. This is slightly faster. \
\>", "Text",ExpressionUUID->"b8c937a7-2c92-40db-aae6-4f1613afda0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$BDFOrder", "=", "2"}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[827]:=",ExpressionUUID->"182e9cd2-a505-41dd-bd9a-2a1510ff84f4"],

Cell["\<\
Order of numerical scheme for Backward Differentiation Scheme (BDS) \
integration. 
-Order 1 works well but it is slow. 
-Order 2 (advised) is faster. Higher orders result in numerical crash.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{
  3.70038745859872*^9, {3.700388848976755*^9, 3.700388853898129*^9}, {
   3.700473501543908*^9, 3.700473501645743*^9}, {3.700475534394142*^9, 
   3.7004755362658577`*^9}, {3.700478641256626*^9, 3.700478643494192*^9}, {
   3.700489000165628*^9, 3.700489000316517*^9}, {3.7004890818537188`*^9, 
   3.700489081952688*^9}, {3.700491072645444*^9, 3.7004910727492247`*^9}, {
   3.700495299028549*^9, 3.700495301520566*^9}, {3.7004955632580013`*^9, 
   3.700495563343988*^9}, {3.7005494895662117`*^9, 3.700549489754825*^9}, {
   3.7005566119225807`*^9, 3.700556614118807*^9}, {3.7005574209011593`*^9, 
   3.700557421151629*^9}, {3.700564317703994*^9, 3.700564335717565*^9}, {
   3.7008017866015472`*^9, 3.700801790663313*^9}, {3.7008235775842123`*^9, 
   3.700823578908893*^9}, {3.700823707385934*^9, 3.700823707486866*^9}, {
   3.700823912513494*^9, 3.7008239126363173`*^9}, {3.7008240641798143`*^9, 
   3.700824064278256*^9}, {3.700824416117256*^9, 3.700824416195912*^9}, {
   3.70084657652393*^9, 3.7008465809926453`*^9}, {3.700889811368519*^9, 
   3.70088981159311*^9}, {3.700894528577209*^9, 3.700894528878921*^9}, {
   3.70090856194517*^9, 3.700908562216453*^9}, {3.700910631485035*^9, 
   3.7009106317691402`*^9}, {3.700911193103982*^9, 3.700911193339787*^9}, {
   3.700911490951714*^9, 3.7009114910640297`*^9}, {3.70091191696462*^9, 
   3.700911917439925*^9}, {3.700912272927682*^9, 3.7009122799941*^9}, {
   3.70091241923667*^9, 3.700912419318706*^9}, {3.701055819810273*^9, 
   3.701055819919148*^9}, {3.7033096650496197`*^9, 3.703309667024427*^9}, {
   3.703310099048644*^9, 3.703310099203085*^9}, {3.7034875183651333`*^9, 
   3.70348751844827*^9}, {3.7034876508636723`*^9, 3.703487650962647*^9}, {
   3.7034879875523443`*^9, 3.703487987607849*^9}, {3.703561450958935*^9, 
   3.703561465466423*^9}, {3.703562107363626*^9, 3.7035621074682302`*^9}, {
   3.703572086479877*^9, 3.703572090685356*^9}, {3.713686367482225*^9, 
   3.713686375344844*^9}, {3.713687276681143*^9, 3.713687278031447*^9}, {
   3.713763463001171*^9, 3.713763464216971*^9}, {3.713873455376417*^9, 
   3.713873470165924*^9}, {3.713874495033888*^9, 3.7138744951161137`*^9}, {
   3.713874680057331*^9, 3.7138746802058153`*^9}, {3.715673162758947*^9, 
   3.715673167179027*^9}, {3.71567321738962*^9, 3.715673217489533*^9}, {
   3.7156748729301243`*^9, 3.715674875022148*^9}, {3.7156755198242683`*^9, 
   3.7156755230974617`*^9}, {3.7158434511031733`*^9, 3.71584345152306*^9}, {
   3.715918510472128*^9, 3.7159185170851297`*^9}, {3.715918807573743*^9, 
   3.715918865100131*^9}, 3.715919918798698*^9, {3.715959475627872*^9, 
   3.7159594758981133`*^9}, {3.7227606829271603`*^9, 
   3.722760687101757*^9}},ExpressionUUID->"e6985bdd-b689-4f84-a19b-\
1fe801d46423"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrecisionNDSolve", "=", "2"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.772870360303824*^9, 3.772870361928526*^9}},
 CellLabel->
  "In[828]:=",ExpressionUUID->"30c57e32-3a14-4321-8155-782b0e8372c6"],

Cell[TextData[{
 "PrecisionNDSolve is a precision parameter used in the differential equation \
solver. It is tuned such that 0 gives reasonable results, 1 gets very good \
results, and 2 gets excellent results and 3 gets super dupper precise results \
",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["10", 
      RowBox[{"-", "5"}]], " ", "precision"}]}], TraditionalForm]],
  ExpressionUUID->"6108734a-872d-41fe-a139-c882f0ceaced"],
 ")."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{
  3.70038745859872*^9, {3.700388848976755*^9, 3.700388853898129*^9}, {
   3.700473501543908*^9, 3.700473501645743*^9}, {3.700475534394142*^9, 
   3.7004755362658577`*^9}, {3.700478641256626*^9, 3.700478643494192*^9}, {
   3.700489000165628*^9, 3.700489000316517*^9}, {3.7004890818537188`*^9, 
   3.700489081952688*^9}, {3.700491072645444*^9, 3.7004910727492247`*^9}, {
   3.700495299028549*^9, 3.700495301520566*^9}, {3.7004955632580013`*^9, 
   3.700495563343988*^9}, {3.7005494895662117`*^9, 3.700549489754825*^9}, {
   3.7005566119225807`*^9, 3.700556614118807*^9}, {3.7005574209011593`*^9, 
   3.700557421151629*^9}, {3.700564317703994*^9, 3.700564335717565*^9}, {
   3.7008017866015472`*^9, 3.700801790663313*^9}, {3.7008235775842123`*^9, 
   3.700823578908893*^9}, {3.700823707385934*^9, 3.700823707486866*^9}, {
   3.700823912513494*^9, 3.7008239126363173`*^9}, {3.7008240641798143`*^9, 
   3.700824064278256*^9}, {3.700824416117256*^9, 3.700824416195912*^9}, {
   3.70084657652393*^9, 3.7008465809926453`*^9}, {3.700889811368519*^9, 
   3.70088981159311*^9}, {3.700894528577209*^9, 3.700894528878921*^9}, {
   3.70090856194517*^9, 3.700908562216453*^9}, {3.700910631485035*^9, 
   3.7009106317691402`*^9}, {3.700911193103982*^9, 3.700911193339787*^9}, {
   3.700911490951714*^9, 3.7009114910640297`*^9}, {3.70091191696462*^9, 
   3.700911917439925*^9}, {3.700912272927682*^9, 3.7009122799941*^9}, {
   3.70091241923667*^9, 3.700912419318706*^9}, {3.701055819810273*^9, 
   3.701055819919148*^9}, {3.7033096650496197`*^9, 3.703309667024427*^9}, {
   3.703310099048644*^9, 3.703310099203085*^9}, {3.7034875183651333`*^9, 
   3.70348751844827*^9}, {3.7034876508636723`*^9, 3.703487650962647*^9}, {
   3.7034879875523443`*^9, 3.703487987607849*^9}, {3.703561450958935*^9, 
   3.703561465466423*^9}, {3.703562107363626*^9, 3.7035621074682302`*^9}, {
   3.703572086479877*^9, 3.703572090685356*^9}, {3.713686367482225*^9, 
   3.713686375344844*^9}, {3.713687276681143*^9, 3.713687278031447*^9}, {
   3.713763463001171*^9, 3.713763464216971*^9}, {3.713873455376417*^9, 
   3.713873470165924*^9}, {3.713874495033888*^9, 3.7138744951161137`*^9}, {
   3.713874680057331*^9, 3.7138746802058153`*^9}, {3.715673162758947*^9, 
   3.715673167179027*^9}, {3.71567321738962*^9, 3.715673217489533*^9}, {
   3.7156748729301243`*^9, 3.715674875022148*^9}, {3.7156755198242683`*^9, 
   3.7156755230974617`*^9}, {3.7158434511031733`*^9, 3.71584345152306*^9}, {
   3.715918510472128*^9, 3.7159185170851297`*^9}, {3.715918807573743*^9, 
   3.715918817266882*^9}, {3.715918871220862*^9, 3.71591891273265*^9}, 
   3.718339376188849*^9, {3.722069339677106*^9, 3.722069346396596*^9}, {
   3.722608479301318*^9, 3.7226084906354933`*^9}, {3.722760719363689*^9, 
   3.722760740586401*^9}},ExpressionUUID->"bb60215e-c9ee-4117-8276-\
0831d09bd473"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AccuracyNDSolve", ":=", 
   RowBox[{"15", "+", "PrecisionNDSolve"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.70038745859872*^9, {3.700388848976755*^9, 3.700388853898129*^9}, {
   3.700473501543908*^9, 3.700473501645743*^9}, {3.700475534394142*^9, 
   3.7004755362658577`*^9}, {3.700478641256626*^9, 3.700478643494192*^9}, {
   3.700489000165628*^9, 3.700489000316517*^9}, {3.7004890818537188`*^9, 
   3.700489081952688*^9}, {3.700491072645444*^9, 3.7004910727492247`*^9}, {
   3.700495299028549*^9, 3.700495301520566*^9}, {3.7004955632580013`*^9, 
   3.700495563343988*^9}, {3.7005494895662117`*^9, 3.700549489754825*^9}, {
   3.7005566119225807`*^9, 3.700556614118807*^9}, {3.7005574209011593`*^9, 
   3.700557421151629*^9}, {3.700564317703994*^9, 3.700564335717565*^9}, {
   3.7008017866015472`*^9, 3.700801790663313*^9}, {3.7008235775842123`*^9, 
   3.700823578908893*^9}, {3.700823707385934*^9, 3.700823707486866*^9}, {
   3.700823912513494*^9, 3.7008239126363173`*^9}, {3.7008240641798143`*^9, 
   3.700824064278256*^9}, {3.700824416117256*^9, 3.700824416195912*^9}, {
   3.70084657652393*^9, 3.7008465809926453`*^9}, {3.700889811368519*^9, 
   3.70088981159311*^9}, {3.700894528577209*^9, 3.700894528878921*^9}, {
   3.70090856194517*^9, 3.700908562216453*^9}, {3.700910631485035*^9, 
   3.7009106317691402`*^9}, {3.700911193103982*^9, 3.700911193339787*^9}, {
   3.700911490951714*^9, 3.7009114910640297`*^9}, {3.70091191696462*^9, 
   3.700911917439925*^9}, {3.700912272927682*^9, 3.7009122799941*^9}, {
   3.70091241923667*^9, 3.700912419318706*^9}, {3.701055819810273*^9, 
   3.701055819919148*^9}, {3.7033096650496197`*^9, 3.703309667024427*^9}, {
   3.703310099048644*^9, 3.703310099203085*^9}, {3.7034875183651333`*^9, 
   3.70348751844827*^9}, {3.7034876508636723`*^9, 3.703487650962647*^9}, {
   3.7034879875523443`*^9, 3.703487987607849*^9}, {3.703561450958935*^9, 
   3.703561465466423*^9}, {3.703562107363626*^9, 3.7035621074682302`*^9}, {
   3.703572086479877*^9, 3.703572090685356*^9}, {3.713686367482225*^9, 
   3.713686375344844*^9}, {3.713687276681143*^9, 3.713687278031447*^9}, {
   3.713763463001171*^9, 3.713763464216971*^9}, {3.713873455376417*^9, 
   3.713873470165924*^9}, {3.713874495033888*^9, 3.7138744951161137`*^9}, {
   3.713874680057331*^9, 3.7138746802058153`*^9}, {3.715673162758947*^9, 
   3.715673167179027*^9}, {3.71567321738962*^9, 3.715673217489533*^9}, {
   3.7156748729301243`*^9, 3.715674875022148*^9}, {3.7156755198242683`*^9, 
   3.7156755230974617`*^9}, {3.7158434511031733`*^9, 3.71584345152306*^9}, {
   3.715918510472128*^9, 3.7159185170851297`*^9}, {3.715918807573743*^9, 
   3.715918817266882*^9}, {3.715918871220862*^9, 3.715918876858902*^9}, {
   3.7159189155628357`*^9, 3.7159189275916433`*^9}, {3.715958406807295*^9, 
   3.715958407290904*^9}, {3.715959462140168*^9, 3.715959462544108*^9}, {
   3.715964823295443*^9, 3.715964823553335*^9}, {3.7160050898079777`*^9, 
   3.716005089930106*^9}, {3.7161713861659307`*^9, 3.7161713864689007`*^9}, {
   3.716175455118043*^9, 3.716175455400508*^9}, {3.716275809156583*^9, 
   3.7162758092683153`*^9}, {3.7163700311775103`*^9, 3.716370031502092*^9}, {
   3.718339384053173*^9, 3.7183393843226137`*^9}, {3.7186060385119534`*^9, 
   3.718606039075596*^9}, {3.7186223089115677`*^9, 3.718622309188058*^9}, {
   3.719899950057085*^9, 3.7198999501693974`*^9}, {3.719927478703187*^9, 
   3.719927479137486*^9}, {3.720085200481188*^9, 3.7200852008318367`*^9}, {
   3.7200866920968037`*^9, 3.720086692589488*^9}, {3.720087847607019*^9, 
   3.720087847964327*^9}, {3.720091437656598*^9, 3.720091437990652*^9}, {
   3.7202157899796143`*^9, 3.720215803910326*^9}, {3.720270951003339*^9, 
   3.720270951168153*^9}, {3.720346926218033*^9, 3.720346926534738*^9}, {
   3.720361619490696*^9, 3.72036161967517*^9}, {3.720364629064274*^9, 
   3.7203646294234543`*^9}, {3.720681667236768*^9, 3.720681667646491*^9}, {
   3.720682192223242*^9, 3.720682192514592*^9}, {3.720706191122177*^9, 
   3.7207061913616753`*^9}, {3.720706656669738*^9, 3.72070665696257*^9}, {
   3.720764524180368*^9, 3.720764524402521*^9}, {3.721018694562179*^9, 
   3.721018694847886*^9}, {3.721060259108539*^9, 3.7210602593271627`*^9}, {
   3.721400054297204*^9, 3.7214000547239733`*^9}, {3.7214014725073557`*^9, 
   3.721401473092038*^9}, {3.721502002921783*^9, 3.7215020032137623`*^9}, {
   3.721504096103675*^9, 3.721504096501498*^9}, {3.7215414017052593`*^9, 
   3.7215414019178953`*^9}, {3.7215452517299232`*^9, 3.721545251842252*^9}, {
   3.721553662876712*^9, 3.721553663167993*^9}, {3.721570652581805*^9, 
   3.721570652919415*^9}, {3.721572227624029*^9, 3.721572227897912*^9}, {
   3.7216285421225853`*^9, 3.721628542396306*^9}, {3.721665660482147*^9, 
   3.7216656608004923`*^9}, {3.721875776392333*^9, 3.721875776482986*^9}, {
   3.721884923748239*^9, 3.721884924024836*^9}, {3.722069324262772*^9, 
   3.722069333071021*^9}, {3.722608819649671*^9, 3.722608846211232*^9}},
 CellLabel->
  "In[829]:=",ExpressionUUID->"42d9e9d7-eb79-430b-b003-0b2b118795e6"],

Cell["\<\
We slave AccuracyNDSolve to PrecisionNDSolve. This is roughly the number of \
digits of precision behind the dot, so increasing it will lead to always \
better results but this can crash if the accuracy required is too strong.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{
  3.70038745859872*^9, {3.700388848976755*^9, 3.700388853898129*^9}, {
   3.700473501543908*^9, 3.700473501645743*^9}, {3.700475534394142*^9, 
   3.7004755362658577`*^9}, {3.700478641256626*^9, 3.700478643494192*^9}, {
   3.700489000165628*^9, 3.700489000316517*^9}, {3.7004890818537188`*^9, 
   3.700489081952688*^9}, {3.700491072645444*^9, 3.7004910727492247`*^9}, {
   3.700495299028549*^9, 3.700495301520566*^9}, {3.7004955632580013`*^9, 
   3.700495563343988*^9}, {3.7005494895662117`*^9, 3.700549489754825*^9}, {
   3.7005566119225807`*^9, 3.700556614118807*^9}, {3.7005574209011593`*^9, 
   3.700557421151629*^9}, {3.700564317703994*^9, 3.700564335717565*^9}, {
   3.7008017866015472`*^9, 3.700801790663313*^9}, {3.7008235775842123`*^9, 
   3.700823578908893*^9}, {3.700823707385934*^9, 3.700823707486866*^9}, {
   3.700823912513494*^9, 3.7008239126363173`*^9}, {3.7008240641798143`*^9, 
   3.700824064278256*^9}, {3.700824416117256*^9, 3.700824416195912*^9}, {
   3.70084657652393*^9, 3.7008465809926453`*^9}, {3.700889811368519*^9, 
   3.70088981159311*^9}, {3.700894528577209*^9, 3.700894528878921*^9}, {
   3.70090856194517*^9, 3.700908562216453*^9}, {3.700910631485035*^9, 
   3.7009106317691402`*^9}, {3.700911193103982*^9, 3.700911193339787*^9}, {
   3.700911490951714*^9, 3.7009114910640297`*^9}, {3.70091191696462*^9, 
   3.700911917439925*^9}, {3.700912272927682*^9, 3.7009122799941*^9}, {
   3.70091241923667*^9, 3.700912419318706*^9}, {3.701055819810273*^9, 
   3.701055819919148*^9}, {3.7033096650496197`*^9, 3.703309667024427*^9}, {
   3.703310099048644*^9, 3.703310099203085*^9}, {3.7034875183651333`*^9, 
   3.70348751844827*^9}, {3.7034876508636723`*^9, 3.703487650962647*^9}, {
   3.7034879875523443`*^9, 3.703487987607849*^9}, {3.703561450958935*^9, 
   3.703561465466423*^9}, {3.703562107363626*^9, 3.7035621074682302`*^9}, {
   3.703572086479877*^9, 3.703572090685356*^9}, {3.713686367482225*^9, 
   3.713686375344844*^9}, {3.713687276681143*^9, 3.713687278031447*^9}, {
   3.713763463001171*^9, 3.713763464216971*^9}, {3.713873455376417*^9, 
   3.713873470165924*^9}, {3.713874495033888*^9, 3.7138744951161137`*^9}, {
   3.713874680057331*^9, 3.7138746802058153`*^9}, {3.715673162758947*^9, 
   3.715673167179027*^9}, {3.71567321738962*^9, 3.715673217489533*^9}, {
   3.7156748729301243`*^9, 3.715674875022148*^9}, {3.7156755198242683`*^9, 
   3.7156755230974617`*^9}, {3.7158434511031733`*^9, 3.71584345152306*^9}, {
   3.715918510472128*^9, 3.7159185170851297`*^9}, {3.715918807573743*^9, 
   3.715918817266882*^9}, {3.715918871220862*^9, 3.715918876858902*^9}, {
   3.7159189155628357`*^9, 3.7159189676386137`*^9}, {3.722608488527581*^9, 
   3.7226084937968407`*^9}, {3.722608526106732*^9, 
   3.722608526692814*^9}},ExpressionUUID->"6a81e2a7-e1ee-4585-bd1a-\
cc353b6658f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NTemperaturePoints", "=", "1200"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693919825007757*^9, 3.693919827188724*^9}, {
   3.693919920227433*^9, 3.693919968566876*^9}, 3.6939200264432*^9, 
   3.693924993463049*^9, 3.693925165130599*^9, {3.693991476041897*^9, 
   3.69399147665985*^9}, {3.694008177931178*^9, 3.694008178080818*^9}, {
   3.694060547441818*^9, 3.69406054777845*^9}, {3.694277313510977*^9, 
   3.694277313806828*^9}, {3.694277508844511*^9, 3.6942775091016273`*^9}, {
   3.694278446394985*^9, 3.6942784477854967`*^9}, {3.694278811015017*^9, 
   3.69427881306723*^9}, {3.694286054225183*^9, 3.694286054476164*^9}, {
   3.694292033612823*^9, 3.694292033816464*^9}, {3.69432195523604*^9, 
   3.6943219553648577`*^9}, {3.69440988939305*^9, 3.694409892526404*^9}, {
   3.694418677026001*^9, 3.694418677100603*^9}, {3.694420539164441*^9, 
   3.6944205403667183`*^9}, {3.694426454153677*^9, 3.694426454242372*^9}, {
   3.6944643696997843`*^9, 3.694464369853479*^9}, {3.694464873581979*^9, 
   3.694464874475239*^9}, {3.694494023966104*^9, 3.694494024200348*^9}, {
   3.694494362155856*^9, 3.694494362279296*^9}, {3.6944967148820047`*^9, 
   3.694496717503488*^9}, {3.694514674772502*^9, 3.694514675500483*^9}, {
   3.694516300521201*^9, 3.69451630079802*^9}, {3.69451835052278*^9, 
   3.694518350640759*^9}, {3.694660434627787*^9, 3.694660434734524*^9}, {
   3.694756024581031*^9, 3.694756024670809*^9}, {3.694757073988193*^9, 
   3.694757074055244*^9}, {3.694758646919764*^9, 3.694758647065629*^9}, {
   3.694777477109887*^9, 3.694777477233094*^9}, {3.6947945917662277`*^9, 
   3.6947945919118433`*^9}, {3.694794790757627*^9, 3.694794790948645*^9}, {
   3.694794903528277*^9, 3.694794903809105*^9}, {3.694794973695202*^9, 
   3.694794974111109*^9}, {3.694808491394628*^9, 3.694808492142713*^9}, {
   3.694809427694816*^9, 3.694809428022513*^9}, {3.694810091904832*^9, 
   3.694810093052167*^9}, {3.694812874077598*^9, 3.6948128747435493`*^9}, {
   3.694844004183181*^9, 3.6948440043931704`*^9}, {3.6949289794613943`*^9, 
   3.6949289880294437`*^9}, 3.694929276688748*^9, {3.694930235530864*^9, 
   3.6949302357591763`*^9}, {3.695014962146056*^9, 3.6950149636530437`*^9}, {
   3.6950150614797163`*^9, 3.695015062145273*^9}, {3.695015139619598*^9, 
   3.695015161788546*^9}, {3.695020340394611*^9, 3.695020343538391*^9}, {
   3.695029258240265*^9, 3.695029258408023*^9}, {3.695033624999496*^9, 
   3.6950336251705503`*^9}, {3.695033885605542*^9, 3.6950338861165247`*^9}, {
   3.6950678251590757`*^9, 3.6950678252773123`*^9}, 3.695068669565572*^9, 
   3.6950699048894577`*^9, {3.695070404119274*^9, 3.695070410375391*^9}, {
   3.695070929783945*^9, 3.6950709304885597`*^9}, {3.695104919108881*^9, 
   3.69510491937665*^9}, {3.695105532864802*^9, 3.695105532995008*^9}, {
   3.695127815100175*^9, 3.695127815257312*^9}, {3.6951329470956163`*^9, 
   3.69513294751657*^9}, 3.695133202913519*^9, {3.695134274691687*^9, 
   3.69513427544095*^9}, {3.695172788251495*^9, 3.695172788398327*^9}, {
   3.6951735371010647`*^9, 3.695173537263588*^9}, {3.695188043719245*^9, 
   3.695188051367755*^9}, {3.695354726822894*^9, 3.695354727265984*^9}, {
   3.695450975900918*^9, 3.6954509777348623`*^9}, {3.6954511344363813`*^9, 
   3.695451134840394*^9}, {3.69545152499778*^9, 3.695451525253639*^9}, {
   3.695466940559165*^9, 3.695466940851301*^9}, {3.695468954776153*^9, 
   3.69546895515069*^9}, {3.695469286322551*^9, 3.6954692865697317`*^9}, {
   3.695469560390514*^9, 3.6954695606756287`*^9}, {3.6954763256295147`*^9, 
   3.6954763258647537`*^9}, {3.696266017370954*^9, 3.6962660174223843`*^9}, {
   3.696308623407786*^9, 3.696308645019208*^9}, {3.6963180397526608`*^9, 
   3.696318039975223*^9}, {3.6965659603736343`*^9, 3.696565963702833*^9}, {
   3.696600291960724*^9, 3.696600292061442*^9}, {3.696678558277429*^9, 
   3.696678558438232*^9}, {3.696687658056613*^9, 3.6966876589268007`*^9}, {
   3.696758954876603*^9, 3.696758955055799*^9}, {3.697957346507564*^9, 
   3.697957346569251*^9}, {3.698032748238962*^9, 3.6980327483340073`*^9}, {
   3.698034590830699*^9, 3.698034591036208*^9}, {3.698043896675248*^9, 
   3.6980438967738457`*^9}, {3.698067005299637*^9, 3.698067005501947*^9}, {
   3.698124109174444*^9, 3.6981241093744698`*^9}, {3.6981247741108837`*^9, 
   3.69812477431159*^9}, {3.698125632136797*^9, 3.698125632247128*^9}, {
   3.6981517774218616`*^9, 3.6981518055498333`*^9}, {3.698379117093444*^9, 
   3.698379119168007*^9}, {3.698386319775154*^9, 3.69838631996513*^9}, {
   3.698417957642591*^9, 3.698417957955942*^9}, 3.698433852719442*^9, {
   3.698437172553061*^9, 3.6984371726684*^9}, {3.6984815820754633`*^9, 
   3.6984815826959257`*^9}, {3.698490718725463*^9, 3.6984907188262568`*^9}, {
   3.698648752719784*^9, 3.698648753033819*^9}, {3.69980989143991*^9, 
   3.699809891989656*^9}, {3.69981045001821*^9, 3.699810454172599*^9}, {
   3.699816039644503*^9, 3.6998160398158207`*^9}, {3.699816939539505*^9, 
   3.6998169398901033`*^9}, {3.6998170394917707`*^9, 
   3.6998170398451633`*^9}, {3.6998895182326097`*^9, 3.699889518553838*^9}, {
   3.699889787845806*^9, 3.6998897888844757`*^9}, {3.700329337289765*^9, 
   3.700329459374176*^9}, {3.700330363849552*^9, 3.700330364934696*^9}, {
   3.700332221930747*^9, 3.7003322223331614`*^9}, {3.700332632295931*^9, 
   3.7003326326973057`*^9}, {3.700333322492701*^9, 3.700333322923835*^9}, {
   3.7003344790743427`*^9, 3.700334479187584*^9}, {3.700335244875441*^9, 
   3.700335245421713*^9}, {3.7003691793237953`*^9, 3.700369179626656*^9}, {
   3.700372143493657*^9, 3.7003721438368883`*^9}, {3.700373807065064*^9, 
   3.700373807630342*^9}, {3.700373963800576*^9, 3.7003739640256243`*^9}, {
   3.700374561795006*^9, 3.700374563469883*^9}, {3.700374714212393*^9, 
   3.700374714555402*^9}, {3.700387409668639*^9, 3.7003874134855556`*^9}, {
   3.7004610952961493`*^9, 3.700461095645268*^9}, {3.7004624859032793`*^9, 
   3.700462486370294*^9}, {3.700463621769759*^9, 3.700463622106921*^9}, {
   3.70046417679425*^9, 3.700464177135996*^9}, {3.700473903290784*^9, 
   3.7004739036235743`*^9}, {3.700475991003477*^9, 3.700475991271413*^9}, {
   3.7004761293068447`*^9, 3.700476129643374*^9}, {3.7004768041501503`*^9, 
   3.700476804493341*^9}, {3.7004774022905207`*^9, 3.700477402601617*^9}, {
   3.700478637439189*^9, 3.700478637784108*^9}, {3.7004889958976107`*^9, 
   3.700488996176721*^9}, {3.7005503786520243`*^9, 3.700550379686541*^9}, 
   3.700550845000527*^9, {3.700551065065806*^9, 3.700551070410396*^9}, {
   3.700557419235915*^9, 3.700557419568511*^9}, {3.700562113601376*^9, 
   3.700562114018393*^9}, {3.700638487732216*^9, 3.700638487910263*^9}, {
   3.7006459735332127`*^9, 3.70064597394914*^9}, {3.700798320813301*^9, 
   3.700798326114874*^9}, {3.700801778829228*^9, 3.700801779457828*^9}, {
   3.700824425165174*^9, 3.700824425489541*^9}, {3.700827129895815*^9, 
   3.70082713509205*^9}, {3.70082843282066*^9, 3.7008284352936077`*^9}, {
   3.7008322814072104`*^9, 3.7008322820371304`*^9}, {3.700893885411031*^9, 
   3.7008938857779617`*^9}, {3.7009021719403543`*^9, 3.700902172244708*^9}, {
   3.700908874829155*^9, 3.700908884873625*^9}, {3.700910850064476*^9, 
   3.70091085020089*^9}, {3.7009111957005*^9, 3.700911196047858*^9}, {
   3.700911599643458*^9, 3.700911600133099*^9}, {3.7009117334699183`*^9, 
   3.7009117408046427`*^9}, {3.70091185826372*^9, 3.700911858422078*^9}, {
   3.7009119147719917`*^9, 3.700911915157703*^9}, {3.700912128396771*^9, 
   3.7009121391422873`*^9}, {3.7009122774003468`*^9, 
   3.7009122775318336`*^9}, {3.713686467436698*^9, 3.713686467874507*^9}, {
   3.7136872846453247`*^9, 3.713687286050118*^9}, {3.713687633950881*^9, 
   3.713687634091032*^9}, {3.7136879829200487`*^9, 3.7136879833431377`*^9}, {
   3.713763485473946*^9, 3.713763486065607*^9}, {3.713765165702565*^9, 
   3.713765165884138*^9}, {3.713765298278651*^9, 3.713765298453245*^9}, {
   3.7137657045572357`*^9, 3.713765704879637*^9}, {3.713772092730534*^9, 
   3.713772092924706*^9}, {3.713780895382009*^9, 3.7137809244227343`*^9}, {
   3.715658759781336*^9, 3.7156587630719547`*^9}, {3.715674708102251*^9, 
   3.715674712165222*^9}, {3.7159584095863523`*^9, 3.715958409934908*^9}, {
   3.715959496094036*^9, 3.7159594962494307`*^9}, {3.715960961424556*^9, 
   3.715960961649671*^9}, {3.715964815025115*^9, 3.715964815194797*^9}, {
   3.716005366929181*^9, 3.716005367028737*^9}, {3.716177088373959*^9, 
   3.7161770887341003`*^9}, {3.7161773135600033`*^9, 3.716177319566381*^9}, {
   3.716580502516659*^9, 3.716580503275948*^9}, {3.7165837664521427`*^9, 
   3.71658376692092*^9}, {3.716685182708437*^9, 3.716685183440621*^9}, {
   3.716689551613371*^9, 3.716689551961741*^9}, {3.71739124045539*^9, 
   3.717391240842863*^9}, {3.717393139644068*^9, 3.7173931405143757`*^9}, {
   3.7174192164310703`*^9, 3.717419216788323*^9}, {3.718249673998971*^9, 
   3.718249674562117*^9}, {3.718453086832231*^9, 3.718453087719561*^9}, {
   3.718456471922202*^9, 3.7184564729897623`*^9}, {3.7185139957851343`*^9, 
   3.718513996190627*^9}, {3.718515546324294*^9, 3.7185155467281427`*^9}, {
   3.718516950057654*^9, 3.718516950295433*^9}, {3.718517459735241*^9, 
   3.718517459844698*^9}, {3.718520607116212*^9, 3.718520607362711*^9}, {
   3.718523037487176*^9, 3.718523038849866*^9}, {3.71852326416269*^9, 
   3.7185232659521523`*^9}, {3.718523638753227*^9, 3.718523639200904*^9}, {
   3.7185238860419827`*^9, 3.718523888740677*^9}, {3.721569656616775*^9, 
   3.721569656849164*^9}, {3.721570022071745*^9, 3.721570022407817*^9}, {
   3.72276082507075*^9, 3.722760825233692*^9}, {3.722760966414422*^9, 
   3.7227609666088037`*^9}, {3.722761091199164*^9, 3.722761091494932*^9}, {
   3.7227618590884743`*^9, 3.7227618647148943`*^9}, {3.722762696781184*^9, 
   3.722762696987094*^9}, {3.77287396515343*^9, 3.77287396564688*^9}},
 CellLabel->
  "In[830]:=",ExpressionUUID->"70a53b33-8cb6-4fde-847c-036ecfc3076f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "Number", " ", "of", " ", "points", " ", "in", " ", "discretization", " ", 
    "of", " ", "temperature", " ", "between", " ", "the", " ", "highest", " ",
     "temperature", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["10", "12"], "K"}], ")"}], " ", "and", " ", "the", " ", 
    "lowest", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"~", 
        SuperscriptBox["10", "7.5"]}], "K"}], ")"}], ".", "  ", "1000"}], " ",
     "is", " ", 
    RowBox[{"enough", ".", "\n", "Sampling"}], " ", "is", " ", "performed", 
    " ", "with", " ", "NTemperaturePoints"}], "+", 
   RowBox[{"1", " ", 
    RowBox[{"points", ".", " ", "Spacing"}], " ", "is", " ", "performed", " ",
     "logarithmically"}]}], ",", " ", 
  RowBox[{"with", " ", 
   RowBox[{
    SubscriptBox["Log", "10"], "."}]}]}]], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.693919825007757*^9, 3.693919827188724*^9}, {
   3.693919920227433*^9, 3.693919968566876*^9}, 3.6939200264432*^9, 
   3.693924993463049*^9, 3.693925165130599*^9, {3.693991476041897*^9, 
   3.69399147665985*^9}, {3.694008177931178*^9, 3.694008178080818*^9}, {
   3.694060547441818*^9, 3.69406054777845*^9}, {3.694277313510977*^9, 
   3.694277313806828*^9}, {3.694277508844511*^9, 3.6942775091016273`*^9}, {
   3.694278446394985*^9, 3.6942784477854967`*^9}, {3.694278811015017*^9, 
   3.69427881306723*^9}, {3.694286054225183*^9, 3.694286054476164*^9}, {
   3.694292033612823*^9, 3.694292033816464*^9}, {3.69432195523604*^9, 
   3.6943219553648577`*^9}, {3.69440988939305*^9, 3.694409892526404*^9}, {
   3.694418677026001*^9, 3.694418677100603*^9}, {3.694420539164441*^9, 
   3.6944205403667183`*^9}, {3.694426454153677*^9, 3.694426454242372*^9}, {
   3.6944643696997843`*^9, 3.694464369853479*^9}, {3.694464873581979*^9, 
   3.694464874475239*^9}, {3.694494023966104*^9, 3.694494024200348*^9}, {
   3.694494362155856*^9, 3.694494362279296*^9}, {3.6944967148820047`*^9, 
   3.694496717503488*^9}, {3.694514674772502*^9, 3.694514675500483*^9}, {
   3.694516300521201*^9, 3.69451630079802*^9}, {3.69451835052278*^9, 
   3.694518350640759*^9}, {3.694660434627787*^9, 3.694660434734524*^9}, {
   3.694756024581031*^9, 3.694756024670809*^9}, {3.694757073988193*^9, 
   3.694757074055244*^9}, {3.694758646919764*^9, 3.694758647065629*^9}, {
   3.694777477109887*^9, 3.694777477233094*^9}, {3.6947945917662277`*^9, 
   3.6947945919118433`*^9}, {3.694794790757627*^9, 3.694794790948645*^9}, {
   3.694794903528277*^9, 3.694794903809105*^9}, {3.694794973695202*^9, 
   3.694794974111109*^9}, {3.694808491394628*^9, 3.694808492142713*^9}, {
   3.694809427694816*^9, 3.694809428022513*^9}, {3.694810091904832*^9, 
   3.694810093052167*^9}, {3.694812874077598*^9, 3.6948128747435493`*^9}, {
   3.694844004183181*^9, 3.6948440043931704`*^9}, {3.6949289794613943`*^9, 
   3.6949289880294437`*^9}, 3.694929276688748*^9, {3.694930235530864*^9, 
   3.6949302357591763`*^9}, {3.695014962146056*^9, 3.6950149636530437`*^9}, {
   3.6950150614797163`*^9, 3.695015062145273*^9}, {3.695015139619598*^9, 
   3.695015161788546*^9}, {3.695020340394611*^9, 3.695020343538391*^9}, {
   3.695029258240265*^9, 3.695029258408023*^9}, {3.695033624999496*^9, 
   3.6950336251705503`*^9}, {3.695033885605542*^9, 3.6950338861165247`*^9}, {
   3.6950678251590757`*^9, 3.6950678252773123`*^9}, 3.695068669565572*^9, 
   3.6950699048894577`*^9, {3.695070404119274*^9, 3.695070410375391*^9}, {
   3.695070929783945*^9, 3.6950709304885597`*^9}, {3.695104919108881*^9, 
   3.69510491937665*^9}, {3.695105532864802*^9, 3.695105532995008*^9}, {
   3.695127815100175*^9, 3.695127815257312*^9}, {3.6951329470956163`*^9, 
   3.69513294751657*^9}, 3.695133202913519*^9, {3.695134274691687*^9, 
   3.69513427544095*^9}, {3.695172788251495*^9, 3.695172788398327*^9}, {
   3.6951735371010647`*^9, 3.695173537263588*^9}, {3.695188043719245*^9, 
   3.695188051367755*^9}, {3.695354726822894*^9, 3.695354727265984*^9}, {
   3.695450975900918*^9, 3.6954509777348623`*^9}, {3.6954511344363813`*^9, 
   3.695451134840394*^9}, {3.69545152499778*^9, 3.695451525253639*^9}, {
   3.695466940559165*^9, 3.695466940851301*^9}, {3.695468954776153*^9, 
   3.69546895515069*^9}, {3.695469286322551*^9, 3.6954692865697317`*^9}, {
   3.695469560390514*^9, 3.6954695606756287`*^9}, {3.6954763256295147`*^9, 
   3.6954763258647537`*^9}, {3.696266017370954*^9, 3.6962660174223843`*^9}, {
   3.696308623407786*^9, 3.696308645019208*^9}, {3.6963180397526608`*^9, 
   3.696318039975223*^9}, {3.6965659603736343`*^9, 3.696565963702833*^9}, {
   3.696600291960724*^9, 3.696600292061442*^9}, {3.696678558277429*^9, 
   3.696678558438232*^9}, {3.696687658056613*^9, 3.6966876589268007`*^9}, {
   3.696758954876603*^9, 3.696758955055799*^9}, {3.697957346507564*^9, 
   3.697957346569251*^9}, {3.698032748238962*^9, 3.6980327483340073`*^9}, {
   3.698034590830699*^9, 3.698034591036208*^9}, {3.698043896675248*^9, 
   3.6980438967738457`*^9}, {3.698067005299637*^9, 3.698067005501947*^9}, {
   3.698124109174444*^9, 3.6981241093744698`*^9}, {3.6981247741108837`*^9, 
   3.69812477431159*^9}, {3.698125632136797*^9, 3.698125632247128*^9}, {
   3.6981517774218616`*^9, 3.6981518055498333`*^9}, {3.698379117093444*^9, 
   3.69837915226758*^9}, {3.700373065702636*^9, 3.700373090104373*^9}, 
   3.70038742360935*^9, {3.70038749322327*^9, 3.700387494188092*^9}, {
   3.71591897824296*^9, 3.715919008384037*^9}, {3.7159190429638557`*^9, 
   3.715919047547921*^9}, {3.715960964395328*^9, 3.7159609648675747`*^9}, {
   3.715961343501638*^9, 3.71596136217603*^9}, {3.7226085346454906`*^9, 
   3.722608552571969*^9}, 3.722761872931711*^9},
 FontFamily->"Arial",ExpressionUUID->"bdf1f708-abf5-4d3e-b4f4-5df9f5e07f5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InterpOrder", "=", "3"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.69432556928328*^9, 3.694325573529868*^9}, {
   3.694327563570325*^9, 3.694327564060493*^9}, {3.694327914519815*^9, 
   3.69432791465044*^9}, {3.694419038858232*^9, 3.694419039696677*^9}, {
   3.694420535216161*^9, 3.694420535538763*^9}, {3.694424706126359*^9, 
   3.694424706216126*^9}, {3.69442657034166*^9, 3.69442657055923*^9}, {
   3.694430870919986*^9, 3.694430870996875*^9}, {3.694436203397543*^9, 
   3.694436206558812*^9}, {3.6944554162293873`*^9, 3.6944554184901533`*^9}, {
   3.69446437394552*^9, 3.6944643745760593`*^9}, {3.694493446506632*^9, 
   3.6944934470658216`*^9}, {3.694494031820558*^9, 3.694494031906804*^9}, {
   3.694495065427875*^9, 3.6944950658217382`*^9}, {3.694516291289845*^9, 
   3.694516291825053*^9}, {3.694518378867948*^9, 3.6945183793111753`*^9}, 
   3.694750919462556*^9, {3.6949289266136913`*^9, 3.69492892676458*^9}, {
   3.696566003700777*^9, 3.69656602056243*^9}, {3.698379323169591*^9, 
   3.698379339119357*^9}, {3.698482510176202*^9, 3.6984825163285923`*^9}, {
   3.698483830867948*^9, 3.698483830974658*^9}, {3.7000370627177267`*^9, 
   3.700037075664055*^9}, {3.7000374305777187`*^9, 3.70003743083928*^9}, {
   3.700037578449041*^9, 3.700037578976015*^9}, {3.700037733136401*^9, 
   3.700037733682386*^9}, {3.7000378405707283`*^9, 3.70003784143124*^9}, {
   3.700037931415854*^9, 3.700037931666994*^9}, {3.700038089163669*^9, 
   3.7000380904033213`*^9}, {3.700330964078207*^9, 3.7003309642559767`*^9}, {
   3.700801961262487*^9, 3.700801989251524*^9}, 3.703302275480196*^9, {
   3.713686473725327*^9, 3.713686474289893*^9}, {3.713686547940385*^9, 
   3.713686548329178*^9}, {3.713687694445019*^9, 3.7136877153296347`*^9}, {
   3.713687973147913*^9, 3.713687976314687*^9}, {3.713763490265787*^9, 
   3.713763490377672*^9}, {3.713765168613257*^9, 3.713765168726062*^9}, {
   3.713765300667486*^9, 3.713765300755329*^9}, {3.7137715295449743`*^9, 
   3.7137715301431704`*^9}, {3.713771877311307*^9, 3.713771880838316*^9}, {
   3.713780899994041*^9, 3.71378093096494*^9}, {3.7138711905088663`*^9, 
   3.713871190734745*^9}, {3.713871278504109*^9, 3.713871278591457*^9}, {
   3.713873817295252*^9, 3.713873817953803*^9}, {3.715658755328174*^9, 
   3.715658766068631*^9}, {3.715674864100366*^9, 3.715674870904705*^9}, {
   3.7159190628760653`*^9, 3.7159190654415817`*^9}},
 CellLabel->
  "In[831]:=",ExpressionUUID->"6f3cb3b2-b2f0-488e-9778-9576d947cf21"],

Cell["\<\
Order of polynomials used in interpolations of reaction rates. Usually with \
Spline functions. \
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.69432556928328*^9, 3.694325573529868*^9}, {
   3.694327563570325*^9, 3.694327564060493*^9}, {3.694327914519815*^9, 
   3.69432791465044*^9}, {3.694419038858232*^9, 3.694419039696677*^9}, {
   3.694420535216161*^9, 3.694420535538763*^9}, {3.694424706126359*^9, 
   3.694424706216126*^9}, {3.69442657034166*^9, 3.69442657055923*^9}, {
   3.694430870919986*^9, 3.694430870996875*^9}, {3.694436203397543*^9, 
   3.694436206558812*^9}, {3.6944554162293873`*^9, 3.6944554184901533`*^9}, {
   3.69446437394552*^9, 3.6944643745760593`*^9}, {3.694493446506632*^9, 
   3.6944934470658216`*^9}, {3.694494031820558*^9, 3.694494031906804*^9}, {
   3.694495065427875*^9, 3.6944950658217382`*^9}, {3.694516291289845*^9, 
   3.694516291825053*^9}, {3.694518378867948*^9, 3.6945183793111753`*^9}, 
   3.694750919462556*^9, {3.6949289266136913`*^9, 3.69492892676458*^9}, {
   3.696566003700777*^9, 3.69656602056243*^9}, {3.698379323169591*^9, 
   3.698379339119357*^9}, {3.698482510176202*^9, 3.6984825163285923`*^9}, {
   3.698483830867948*^9, 3.698483830974658*^9}, {3.7000370627177267`*^9, 
   3.700037075664055*^9}, {3.7000374305777187`*^9, 3.70003743083928*^9}, {
   3.700037578449041*^9, 3.700037578976015*^9}, {3.700037733136401*^9, 
   3.700037733682386*^9}, {3.7000378405707283`*^9, 3.70003784143124*^9}, {
   3.700037931415854*^9, 3.700037931666994*^9}, {3.700038089163669*^9, 
   3.7000380904033213`*^9}, {3.700330964078207*^9, 3.7003309642559767`*^9}, {
   3.700801961262487*^9, 3.700801989251524*^9}, 3.703302275480196*^9, {
   3.713686473725327*^9, 3.713686474289893*^9}, {3.713686547940385*^9, 
   3.713686548329178*^9}, {3.713687694445019*^9, 3.7136877153296347`*^9}, {
   3.713687973147913*^9, 3.713687976314687*^9}, {3.713763490265787*^9, 
   3.713763490377672*^9}, {3.713765168613257*^9, 3.713765168726062*^9}, {
   3.713765300667486*^9, 3.713765300755329*^9}, {3.7137715295449743`*^9, 
   3.7137715301431704`*^9}, {3.713771877311307*^9, 3.713771880838316*^9}, {
   3.713780899994041*^9, 3.71378093096494*^9}, {3.7138711905088663`*^9, 
   3.713871190734745*^9}, {3.713871278504109*^9, 3.713871278591457*^9}, {
   3.713873817295252*^9, 3.713873817953803*^9}, {3.715658755328174*^9, 
   3.715658766068631*^9}, {3.715674864100366*^9, 3.715674870904705*^9}, {
   3.7159190628760653`*^9, 
   3.715919085812427*^9}},ExpressionUUID->"d21bcd79-8641-4553-875f-\
a7d5d74506ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$FastPENRatesIntegrals", "=", "True"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.69432556928328*^9, 3.694325573529868*^9}, {
   3.694327563570325*^9, 3.694327564060493*^9}, {3.694327914519815*^9, 
   3.69432791465044*^9}, {3.694419038858232*^9, 3.694419039696677*^9}, {
   3.694420535216161*^9, 3.694420535538763*^9}, {3.694424706126359*^9, 
   3.694424706216126*^9}, {3.69442657034166*^9, 3.69442657055923*^9}, {
   3.694430870919986*^9, 3.694430870996875*^9}, {3.694436203397543*^9, 
   3.694436206558812*^9}, {3.6944554162293873`*^9, 3.6944554184901533`*^9}, {
   3.69446437394552*^9, 3.6944643745760593`*^9}, {3.694493446506632*^9, 
   3.6944934470658216`*^9}, {3.694494031820558*^9, 3.694494031906804*^9}, {
   3.694495065427875*^9, 3.6944950658217382`*^9}, {3.694516291289845*^9, 
   3.694516291825053*^9}, {3.694518378867948*^9, 3.6945183793111753`*^9}, 
   3.694750919462556*^9, {3.6949289266136913`*^9, 3.69492892676458*^9}, {
   3.696566003700777*^9, 3.69656602056243*^9}, {3.698379323169591*^9, 
   3.698379339119357*^9}, {3.698482510176202*^9, 3.6984825163285923`*^9}, {
   3.698483830867948*^9, 3.698483830974658*^9}, {3.7000370627177267`*^9, 
   3.700037075664055*^9}, {3.7000374305777187`*^9, 3.70003743083928*^9}, {
   3.700037578449041*^9, 3.700037578976015*^9}, {3.700037733136401*^9, 
   3.700037733682386*^9}, {3.7000378405707283`*^9, 3.70003784143124*^9}, {
   3.700037931415854*^9, 3.700037931666994*^9}, {3.700038089163669*^9, 
   3.7000380904033213`*^9}, {3.700330964078207*^9, 3.7003309642559767`*^9}, {
   3.700801961262487*^9, 3.700801989251524*^9}, 3.703302275480196*^9, {
   3.713686473725327*^9, 3.713686474289893*^9}, {3.713686547940385*^9, 
   3.713686548329178*^9}, {3.713687694445019*^9, 3.7136877153296347`*^9}, {
   3.713687973147913*^9, 3.713687976314687*^9}, {3.713763490265787*^9, 
   3.713763490377672*^9}, {3.713765168613257*^9, 3.713765168726062*^9}, {
   3.713765300667486*^9, 3.713765300755329*^9}, {3.7137715295449743`*^9, 
   3.7137715301431704`*^9}, {3.713771877311307*^9, 3.713771880838316*^9}, {
   3.713780899994041*^9, 3.71378093096494*^9}, {3.7138711905088663`*^9, 
   3.713871190734745*^9}, {3.713871278504109*^9, 3.713871278591457*^9}, {
   3.713873817295252*^9, 3.713873817953803*^9}, {3.715658755328174*^9, 
   3.715658766068631*^9}, {3.715674864100366*^9, 3.715674870904705*^9}, {
   3.7159190628760653`*^9, 3.7159191035443287`*^9}, {3.718516073699552*^9, 
   3.718516074305745*^9}, {3.7185169333270407`*^9, 3.718516933702742*^9}, {
   3.722762121136464*^9, 3.722762121701285*^9}, {3.722762203257704*^9, 
   3.722762203662095*^9}, {3.722762407331543*^9, 3.7227624078415813`*^9}, {
   3.722762816485943*^9, 3.722762816889029*^9}},
 CellLabel->
  "In[832]:=",ExpressionUUID->"6906aec7-7d72-4a33-aa3b-759e51f40261"],

Cell["\<\
If $FastPENRatesIntegrals is set to True, it uses a Simpson method for \
numerical integrals. Otherwise it uses the Mathematica function NIntegrate \
which is more accurate (adaptative refinement of integral) but much slower.\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"5d44a79b-ace1-4e24-8a7f-741c413f48aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$PENRatesIntegralsPoints", "=", "300"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.69432556928328*^9, 3.694325573529868*^9}, {
   3.694327563570325*^9, 3.694327564060493*^9}, {3.694327914519815*^9, 
   3.69432791465044*^9}, {3.694419038858232*^9, 3.694419039696677*^9}, {
   3.694420535216161*^9, 3.694420535538763*^9}, {3.694424706126359*^9, 
   3.694424706216126*^9}, {3.69442657034166*^9, 3.69442657055923*^9}, {
   3.694430870919986*^9, 3.694430870996875*^9}, {3.694436203397543*^9, 
   3.694436206558812*^9}, {3.6944554162293873`*^9, 3.6944554184901533`*^9}, {
   3.69446437394552*^9, 3.6944643745760593`*^9}, {3.694493446506632*^9, 
   3.6944934470658216`*^9}, {3.694494031820558*^9, 3.694494031906804*^9}, {
   3.694495065427875*^9, 3.6944950658217382`*^9}, {3.694516291289845*^9, 
   3.694516291825053*^9}, {3.694518378867948*^9, 3.6945183793111753`*^9}, 
   3.694750919462556*^9, {3.6949289266136913`*^9, 3.69492892676458*^9}, {
   3.696566003700777*^9, 3.69656602056243*^9}, {3.698379323169591*^9, 
   3.698379339119357*^9}, {3.698482510176202*^9, 3.6984825163285923`*^9}, {
   3.698483830867948*^9, 3.698483830974658*^9}, {3.7000370627177267`*^9, 
   3.700037075664055*^9}, {3.7000374305777187`*^9, 3.70003743083928*^9}, {
   3.700037578449041*^9, 3.700037578976015*^9}, {3.700037733136401*^9, 
   3.700037733682386*^9}, {3.7000378405707283`*^9, 3.70003784143124*^9}, {
   3.700037931415854*^9, 3.700037931666994*^9}, {3.700038089163669*^9, 
   3.7000380904033213`*^9}, {3.700330964078207*^9, 3.7003309642559767`*^9}, {
   3.700801961262487*^9, 3.700801989251524*^9}, 3.703302275480196*^9, {
   3.713686473725327*^9, 3.713686474289893*^9}, {3.713686547940385*^9, 
   3.713686548329178*^9}, {3.713687694445019*^9, 3.7136877153296347`*^9}, {
   3.713687973147913*^9, 3.713687976314687*^9}, {3.713763490265787*^9, 
   3.713763490377672*^9}, {3.713765168613257*^9, 3.713765168726062*^9}, {
   3.713765300667486*^9, 3.713765300755329*^9}, {3.7137715295449743`*^9, 
   3.7137715301431704`*^9}, {3.713771877311307*^9, 3.713771880838316*^9}, {
   3.713780899994041*^9, 3.71378093096494*^9}, {3.7138711905088663`*^9, 
   3.713871190734745*^9}, {3.713871278504109*^9, 3.713871278591457*^9}, {
   3.713873817295252*^9, 3.713873817953803*^9}, {3.715658755328174*^9, 
   3.715658766068631*^9}, {3.715674864100366*^9, 3.715674870904705*^9}, {
   3.7159190628760653`*^9, 3.715919105429565*^9}, {3.71591915680556*^9, 
   3.715919185342342*^9}, {3.715958417292342*^9, 3.715958418834148*^9}, {
   3.715960951279128*^9, 3.715960951749775*^9}, {3.7159609836096277`*^9, 
   3.715960984060555*^9}, {3.715964812270252*^9, 3.715964812416119*^9}, {
   3.7160053704620237`*^9, 3.716005370787039*^9}, {3.7161770792906723`*^9, 
   3.716177079545558*^9}, {3.7161773157767344`*^9, 3.7161773170225153`*^9}, 
   3.716580499000877*^9, 3.716583764590049*^9, {3.716685177796742*^9, 
   3.71668519419093*^9}, {3.71668955387438*^9, 3.716689554304862*^9}, {
   3.717391237221319*^9, 3.717391242845717*^9}, {3.717393134745824*^9, 
   3.717393135027178*^9}, {3.717419213498632*^9, 3.7174192137413683`*^9}, {
   3.718249677132077*^9, 3.718249679524178*^9}, {3.718453078694503*^9, 
   3.718453079152801*^9}, {3.718456466629353*^9, 3.718456468801071*^9}, {
   3.718513991848268*^9, 3.7185139921244164`*^9}, {3.718516052752803*^9, 
   3.718516052977182*^9}, {3.718516947179852*^9, 3.7185169474225063`*^9}, {
   3.7185174573268147`*^9, 3.718517457540649*^9}, {3.718518035628089*^9, 
   3.718518035842931*^9}, {3.718521156115285*^9, 3.718521156814148*^9}, {
   3.718521467232638*^9, 3.7185214677074547`*^9}, {3.718522613479751*^9, 
   3.7185226137447853`*^9}, {3.7185228789772387`*^9, 3.718522880591099*^9}, {
   3.718523025234063*^9, 3.718523031882093*^9}, {3.718526805342916*^9, 
   3.7185268054623537`*^9}, {3.7185273949542*^9, 3.7185274017148743`*^9}, {
   3.718559393464818*^9, 3.718559394210923*^9}, {3.718559504400751*^9, 
   3.7185595045488853`*^9}, {3.721984562169787*^9, 3.721984562414953*^9}, {
   3.721984781825841*^9, 3.7219847823988943`*^9}, {3.7219848958786907`*^9, 
   3.721984895990755*^9}, {3.721985128070314*^9, 3.721985131152534*^9}, {
   3.722696981684925*^9, 3.722696981794715*^9}, {3.722700751260428*^9, 
   3.7227007550294647`*^9}, {3.722701885313898*^9, 3.7227018854831667`*^9}, {
   3.722702039643715*^9, 3.72270203999065*^9}, 3.722702803614217*^9, 
   3.7227031527271347`*^9, 3.722703257681902*^9, 3.72270336299067*^9, {
   3.722760829782908*^9, 3.72276082994919*^9}, {3.7227609687938538`*^9, 
   3.7227609688538733`*^9}, {3.722761093727035*^9, 3.7227610939338303`*^9}, {
   3.722762704843966*^9, 3.7227627051053247`*^9}, 3.77287039192775*^9},
 CellLabel->
  "In[833]:=",ExpressionUUID->"9567ad4d-55ea-478b-8f82-08981a005df9"],

Cell["\<\
In case $FastPENRatesIntegrals is set to True, $PENRatesIntegralsPoints is \
the number of points used to perform the numerical integrals. 200 is enough. \
400 is ultra precise.\
\>", "Text",
 CellChangeTimes->{{3.715919159583297*^9, 3.7159191949480047`*^9}, {
  3.7182849010572653`*^9, 3.718284909053658*^9}, {3.7226085734386168`*^9, 
  3.722608584337657*^9}},ExpressionUUID->"d5e7c688-1452-4a37-a0b6-\
26ebb29c78a7"],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"SelectedNotebook", "[", "]"}], ",", 
   RowBox[{"PrintPrecision", "\[Rule]", "8"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.719115345551838*^9, 3.719115345553516*^9}, {
  3.719115432170843*^9, 3.71911544977792*^9}},
 CellLabel->
  "In[834]:=",ExpressionUUID->"7e31273b-8767-4cbd-b4c2-a09ce5fb5b98"],

Cell["We increase the number of digits which are displayed", "Text",
 CellChangeTimes->{{3.719115439459126*^9, 
  3.71911544731109*^9}},ExpressionUUID->"37970271-3a2c-4940-a69a-\
713e300e6ada"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Corrections for weak rates", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.696565735100507*^9, 3.696565742706061*^9}, {
  3.698377177300961*^9, 3.6983771789721327`*^9}, {3.715935862600801*^9, 
  3.7159358636810904`*^9}},ExpressionUUID->"39cf9565-37f8-41fc-a56d-\
b89c4ba515e1"],

Cell["\<\
Since the weak interaction rates, that is the rates of weak reactions of the \
type n + \[Nu] <-> p + e and associated reactions, depend only on temperature, 
these can be computed once and for all so as to explore the dependence in \
cosmological parameters or other parameters. 
  
If $RecomputeWeakRates is set to True, the code recomputes the weak rates. 
Otherwise it reads them from files previously stored. If the file does not \
exist it recomputes the rates.

If $ParallelWeakRates=True this is done using parallelization over the \
various CPUs that Mathematica can detect.\
\>", "Text",ExpressionUUID->"228b3b2a-a215-4fb9-bc53-53520228fa7e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$RecomputeWeakRates", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ParallelWeakRates", "=", "True"}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[835]:=",ExpressionUUID->"c968aaad-53a5-469f-9f76-4232b987e32e"],

Cell["\<\
There are several booleans corresponding to the different types of \
corrections which can be considered in these weak rates. 
The name of the file used for storing the rates is built out of these \
booleans. 

Since the corrections do not add linearly, there are in principle many \
choices of corrections, but the only meaningful
choices are those without any corrections and those with all corrections \
included. 
Or maybe those with just one correction added, so as to check its amplitude.\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"a99ca887-8e3a-44a9-8a13-8e4a7e189b89"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$RadiativeCorrections", "=", "True"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"$ResummedLogsRadiativeCorrections", "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$RelativisticFermiFunction", "=", "True"}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[837]:=",ExpressionUUID->"e6d52503-02df-4db8-9a47-a1241485febe"],

Cell["\<\
1) If $RadiativeCorrections is set to True, we use Coulomb and radiative \
corrections (see section III.E of companion paper. The corrections are \
implemented in Eqs. 101 and 104.).
If $ResummedLogsRadiativeCorrections is set to True we use Eq. 15 of \
[Czarnecki et al 2004] which amounts to resumming some higher order radiative \
corrections, and this is also Eq. B35 of the companion paper.

If $ResummedLogsRadiativeCorrections is False we use simply Eq. 7 of the same \
reference, which corresponds to Eq. 103 and B30 of the companion paper.
If $RelativisticFermiFunction is True we use the relativistic Fermi function \
(Eq. 5 in [Ivanov 2012]), which corresponds to Eq. 100 of the companion \
paper. Otherwise we use the standard non-relativistic Fermi function, given \
by Eq. 99 of the companion paper.\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"8c3bcf34-0c98-4d3a-a013-c987958c0ef0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$RadiativeThermal", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$CorrectionBremsstrahlung", "=", "True"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwl1Hs4FPgaB/CRUnJJTG7NUm651aomRzSY3YiolWqOW+40cishzXlQ0zrk
MntULtu2JW2MDeWSJJWw1q3WTg62rJySIxMmdteS5bzve/74PZ9/fs/zvu/3
d9kYHOsZtozBYBTBQtsnbe63pUu5oi3/Igc4i7x2cIVA/e+ocZFHMDr8LICc
dfvwogMcFK95ifrUXRpHDaavk6Zvj+svgQ2h2eTV1auU5DOkXAtDTfK929ry
g6A4KJGUqNRFHgIVxlrIj50/acSCVgZT5FSDWdBxUJ2TT+YzDTjnwO6VbFJh
S3FmNmhzq4L0DRgaNsuUcr8K/EC660ikn4L2o8Nk+aZ8hhU43tFLxim/fngT
9Nw9QTbpjNqUgp9Joneij975bXPPkXLn42JIVVf+5uPgfyfjycnAGuHzXMhD
1EZalX2n2wsOLNWRSfsf8kbApqmnpExF8S060s0kF0yf2OpegP1qEpKfaX4I
1WzZQT7inQxzBP060shV4wXan4NeFsWkSq/1pXDwzM/O5OEVCxN80N5LcRJt
dihQjAKbfr1FNhaNC6JBM4U50tOF1Ylevb2FdFP/uqQWPHakhCzy3NHDKIQ5
vnUiVXREqaq3pdzOldfI93asAfSOrhWZOP3NhXVg5sMSMuf5gTnUaXMouZTn
WaUJmkkDySsO3r03wGb/aPJZdvY7tGxdIWnS+rLd7o6U2xc7SXKyE5btArf5
pJHhxvXGqHZrB8noOq3rCF7qSCOn8yOHAsBJ5VTSPPlJSAR4w01Cep1oTEaj
FnrIuMSPUV1gZdbKaFS6ONzwHrQO+Z0cFv3OnwDvrFGNQGM4sep2VVJu7WsT
Jrr30cdfURNVtSGUf1T/AQcc+edmsvgfrJ3+1VJuxjkrMmrqD3f01LXl+9C+
IEFMMPg3yXnS4POb6WiBym1SctfmYDj4ft6FrJzRbuaDVfk+5AgzTHYBZE8L
SKGdy1a3GinX9uNh8nRaiN0xML7tFGmvX+YfCf60q57cdird2bwW3u/Jy6RN
f2qfBainm02+cPWesQKrB2JJoSs7zxFkGe4nF03VJoPBY7EsUvGzSFEoqFaV
TB54WheeARaJNvNRj5hNG8+DKQfZpMJRpXx0FV+f9El7LspB9WRkR65lITqx
tJsscQ2qQFM1osnKV28a0dUvZkmPyw8GUOu5H8nAtFw/EVieUEa2eiedQ1lm
6WT//tcncsH0yDVx6N7DK8vQsB3rSOW4whN5oFZDJbnQ0/ZLIdhZ0Edu+HdA
fDVocjCeTFp4XI76X+smm7oSMu+CzmMZpOgNI7sO55dXJU3jFZmL2F/DerJw
ym1a4S7c0whvUlbjmFsHMnt4ZP12K+lf4Al5Dhmrf/PcfJ2Uu17uPslyUrY2
ugd5yXTIP9e0HkM/HO4ny5eMQozBHt528ppadKgXOKl5lpTM64j9wdYg9TKU
l7CuBh1e7keyIioGUsGYlgbyst/sG7RPXXkEzV9bPoZKXjWQmd3mMtRS24GM
XmIKz4BD8kZkxi/sLPTT1TM5qG2N00VUs9qHbI15YHwWjKzfY4bGtxj6CrGP
QckRtH8fX4BmmZ4imRr1o+hQYhfpfePp1cdgiPg/pE9l7zOFeilXEPKO3KUf
5LYKTDOKIUsfz3qgzhFKB1BBxz4e2jzuTSr9rOSLphrqkQ4jEvYGcGvPK3Is
rczACzy99jEpqVDLKAbFumFkiseXPjfAdm4emZKVrH4b7GspIA2qKtxRyw2P
SAPefE4XaF+qJkKHxC7iPfehbwceKbCV/uYLNr9aJLcIP4lkN0BOK/aQCk+X
GWo9kHJP6mmT6zv1OlG/XgvSRE/eRR+0s9YiLYwmWGag7/k/yZTFT54JwLi5
raStrYZxARg4q09eMV/Rfx1MctAiL/4lV12GdWxVyf45tuX34A/fOpOt14/X
3gIF7BRyjpPdjZq7lpJRsTMazaC1jxwT3T8XoIO6M0Vk5hGTRnT6zXZS9bvR
ZcmN8B//sES+dhdnoIPLa0hZ5ZRJCtg7arQJ7ZaNnUHNQ8PPol52iRfRwa9/
JMVZJ5dSwSMZJaSjUanWGdC/6z55s3L3UVR49QuSEbpz7jIoke0lt7E4rt+A
7S9dyLtRV+KeYB1VpwR0dKg2vhn0G28md43uE6IVg4f+bxKb8VWTlPs2OIBs
s2o9egHMlO8hhYHFv/k9gXOIuEfa8wX3/MGNf3xJyg0WDjKaYV7FSnIoz3BG
Diy33Er+D95CWu4=
  "],
 CellLabel->
  "In[840]:=",ExpressionUUID->"1da5bc33-a0ed-443f-82ea-bfdb3e5e5033"],

Cell["\<\
2) If $RadiativeThermal set to True, the thermal radiative corrections are \
taken into account. 
The first expressions date back from [Dicus et al.]. However other \
expressions were derived subsequently in [Lopez&Turner 1998], [Cambier et \
al.] and [Esposito et al. 1999] among other references. [Kernan] pointed \
typos and compared the differing results of [Cambier et al.] and [Dicus et \
al.]. These were correctly computed in [Brown&Sawyer].
In the companion paper, the thermal radiative corrections are given by Eq. \
108 with the various contributions given by Eqs. 109-113. However, it is \
easier to compute the first contribution of 108 using Eqs. 109 (with \
definition B41), but to compute the second and third contributions of 108 \
using Eqs. B50-B51.

We showed in companion paper that Bremsstrahlung corrections need also to be \
added to be fully consistent with [Brown&Sawyer]. This is controlled by the \
boolean $CorrectionBremsstrahlung. If $RadiativeThermal is set to True, then \
these bremsstrahlung corrections (corresponding to Eqs. 107a and 107b in \
companion paper with the definitions B48-B49) are also incorporated if \
$CorrectionBremsstrahlung is True.\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"03af5346-b386-48d9-a17c-03d5f3f4e2de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$FiniteNucleonMass", "=", "True"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.696257255373035*^9, 3.696257256064789*^9}, 
   3.696257296494958*^9, {3.696309741556234*^9, 3.696309751116198*^9}, {
   3.696309829935615*^9, 3.696309830484921*^9}, {3.696311030050004*^9, 
   3.696311030467304*^9}, {3.696316169221385*^9, 3.696316172538637*^9}, {
   3.696316889912768*^9, 3.696316894412065*^9}, {3.696559984466227*^9, 
   3.696559985080264*^9}, {3.696560374446032*^9, 3.6965604141857758`*^9}, {
   3.696560471062442*^9, 3.6965604714332952`*^9}, {3.696560559897369*^9, 
   3.6965605818167543`*^9}, {3.696562830846023*^9, 3.696562831511578*^9}, 
   3.696565703981082*^9, {3.696572877725415*^9, 3.696572878284606*^9}, {
   3.6965845498777447`*^9, 3.6965845502367887`*^9}, {3.6965998215309753`*^9, 
   3.6965998220342712`*^9}, {3.6966782566808023`*^9, 3.696678257176117*^9}, {
   3.696841465965275*^9, 3.696841466628996*^9}, {3.696843123162903*^9, 
   3.6968431235622473`*^9}, {3.6977763073719807`*^9, 3.697776308562646*^9}, {
   3.697776958329917*^9, 3.697776958740756*^9}, {3.697959324120555*^9, 
   3.697959324822939*^9}, {3.6980332265338707`*^9, 3.698033226889229*^9}, {
   3.7003335922278557`*^9, 3.7003335928340054`*^9}, {3.700334115342485*^9, 
   3.700334116661476*^9}, {3.7003680560188913`*^9, 3.700368056515312*^9}, {
   3.7003691941175756`*^9, 3.700369194493037*^9}, {3.70047842429602*^9, 
   3.700478424843535*^9}, {3.700478627303214*^9, 3.700478627659127*^9}, {
   3.700556590247567*^9, 3.7005565907794228`*^9}, {3.700562118730177*^9, 
   3.700562119084076*^9}, {3.700634788190217*^9, 3.700634788796035*^9}, {
   3.700639602500217*^9, 3.700639602891803*^9}, {3.700648691663764*^9, 
   3.700648692270997*^9}, {3.700649577496526*^9, 3.700649578012198*^9}, {
   3.700649954068501*^9, 3.7006499546645927`*^9}, {3.7006499882850637`*^9, 
   3.700649988706751*^9}, {3.700650060905306*^9, 3.700650062788225*^9}, {
   3.700650200394396*^9, 3.7006502008223333`*^9}, {3.703572100180814*^9, 
   3.703572100707383*^9}, {3.715658750720636*^9, 3.715658751130015*^9}, {
   3.715659459415331*^9, 3.715659460020413*^9}, {3.7156732391906233`*^9, 
   3.715673239505641*^9}, {3.715674060773316*^9, 3.715674061335554*^9}, {
   3.715675532999258*^9, 3.715675533379086*^9}, {3.715964581297838*^9, 
   3.715964581847699*^9}, {3.715964744759678*^9, 3.71596474515213*^9}, {
   3.716275785196497*^9, 3.7162757856894827`*^9}, {3.71627624106304*^9, 
   3.716276241388685*^9}, {3.7163693937575083`*^9, 3.716369394327877*^9}, {
   3.7165536283192596`*^9, 3.716553628643486*^9}, {3.71663817083033*^9, 
   3.716638171519546*^9}, {3.716710933420579*^9, 3.7167109349524193`*^9}, {
   3.7183370847381763`*^9, 3.718337085354072*^9}, {3.718340264248041*^9, 
   3.718340264818782*^9}, {3.718342538972176*^9, 3.7183425395883017`*^9}, {
   3.7183448014577713`*^9, 3.718344802038682*^9}, {3.71838383035959*^9, 
   3.7183838313036213`*^9}, {3.718453107589624*^9, 3.718453107989655*^9}, {
   3.71851400544569*^9, 3.718514006053646*^9}, {3.7185142726599207`*^9, 
   3.7185142731200657`*^9}, {3.718527418749909*^9, 3.7185274194368973`*^9}, {
   3.718528084730102*^9, 3.7185280850871897`*^9}, {3.718528690116069*^9, 
   3.718528690898079*^9}, {3.718528865994302*^9, 3.7185288664112167`*^9}, {
   3.718534237925671*^9, 3.718534238569559*^9}, {3.718540024263146*^9, 
   3.718540024665361*^9}, {3.718540778018463*^9, 3.7185407791090918`*^9}, {
   3.7185409998496933`*^9, 3.718541000236936*^9}, {3.718542054882292*^9, 
   3.718542055691477*^9}, {3.718542365971279*^9, 3.718542366414542*^9}, {
   3.718548364696032*^9, 3.7185483655267878`*^9}, {3.718548802434269*^9, 
   3.7185488029738293`*^9}, {3.718557312949147*^9, 3.718557313630515*^9}, {
   3.71856169178647*^9, 3.718561692191833*^9}, {3.7186159730556297`*^9, 
   3.718615973697929*^9}, {3.718616425438203*^9, 3.718616425839451*^9}, {
   3.718622293761566*^9, 3.718622294520115*^9}, {3.7186243546336193`*^9, 
   3.71862435503564*^9}, {3.718770851340541*^9, 3.718770851918338*^9}, {
   3.718789012644764*^9, 3.718789013076885*^9}, {3.7191486844028807`*^9, 
   3.71914868507579*^9}, {3.7192948121723957`*^9, 3.719294812589398*^9}, {
   3.719812127135305*^9, 3.719812127711113*^9}, {3.719812991733274*^9, 
   3.719813007811977*^9}, {3.719817696881975*^9, 3.7198176973231573`*^9}, {
   3.719828108143326*^9, 3.7198281088775663`*^9}, {3.719839656683776*^9, 
   3.719839657106502*^9}, {3.719841797898921*^9, 3.7198417984042587`*^9}, {
   3.719897517341346*^9, 3.719897517745016*^9}, {3.7198979443860197`*^9, 
   3.719897945450293*^9}, {3.7198999322500763`*^9, 3.719899932641571*^9}, {
   3.720004389794098*^9, 3.720004391804798*^9}, {3.720408828994615*^9, 
   3.720408829786399*^9}, {3.720413609339176*^9, 3.7204136097062273`*^9}, {
   3.7205281522480993`*^9, 3.720528152985856*^9}, {3.720529685458618*^9, 
   3.720529685932016*^9}, {3.720531993132025*^9, 3.7205319938257093`*^9}, {
   3.720546338726981*^9, 3.720546339529195*^9}, {3.721967893758833*^9, 
   3.7219678944297457`*^9}, {3.721968350118881*^9, 3.721968350610475*^9}, {
   3.721984581092176*^9, 3.7219845816863527`*^9}, {3.722004714684079*^9, 
   3.7220047150818853`*^9}, {3.72270097299984*^9, 3.722700973630233*^9}, {
   3.722701149515687*^9, 3.722701149907836*^9}, {3.722762189110527*^9, 
   3.722762189659564*^9}, {3.7227628298715467`*^9, 3.722762830224641*^9}, {
   3.724841252056748*^9, 3.724841252831147*^9}, {3.72484179349761*^9, 
   3.724841793887074*^9}, {3.725256616499288*^9, 3.72525661716724*^9}, {
   3.725257469369544*^9, 3.72525746974559*^9}, {3.725258499342698*^9, 
   3.7252584999496326`*^9}, {3.7252587809784107`*^9, 
   3.7252587814005938`*^9}, {3.725259605202093*^9, 3.7252596058883047`*^9}, {
   3.725259768011099*^9, 3.725259768352838*^9}, {3.7255922951237392`*^9, 
   3.725592295747567*^9}, {3.725594524011945*^9, 3.725594524386841*^9}},
 CellLabel->
  "In[842]:=",ExpressionUUID->"d9567afb-a435-4b5e-902e-527c6697dbff"],

Cell[TextData[{
 "3) If $FiniteNucleonMass is set to True, we take into account the finite \
mass of nucleons by keeping corrections in ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "/", 
    SubscriptBox["M", "n"]}], TraditionalForm]],ExpressionUUID->
  "b11c862c-ad5c-449e-a079-78d6f20c3fd0"],
 " in the collision integrals of the weak rates.\nOur method is described in \
the companion paper and differs from earlier literature.\nThere is a \
suboption for these finite mass corrections  which is"
}], "Text",
 InitializationCell->
  True,ExpressionUUID->"fa79171f-0816-4859-84b7-be812b0cfa75"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CoupledFMandRC", "=", "True"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.696257255373035*^9, 3.696257256064789*^9}, 
   3.696257296494958*^9, {3.696309741556234*^9, 3.696309751116198*^9}, {
   3.696309829935615*^9, 3.696309830484921*^9}, {3.696311030050004*^9, 
   3.696311030467304*^9}, {3.696316169221385*^9, 3.696316172538637*^9}, {
   3.696316889912768*^9, 3.696316894412065*^9}, {3.696559984466227*^9, 
   3.696559985080264*^9}, {3.696560374446032*^9, 3.6965604141857758`*^9}, {
   3.696560471062442*^9, 3.6965604714332952`*^9}, {3.696560559897369*^9, 
   3.6965605818167543`*^9}, {3.696562830846023*^9, 3.696562831511578*^9}, 
   3.696565703981082*^9, 3.6965658075317507`*^9, {3.696573238698654*^9, 
   3.6965732408200808`*^9}, {3.696843112438918*^9, 3.696843114952989*^9}, {
   3.697959351784759*^9, 3.697959352054881*^9}, 3.698378460946106*^9, {
   3.700639604526106*^9, 3.7006396048934603`*^9}, {3.700641714347082*^9, 
   3.700641714961219*^9}, {3.700649970877749*^9, 3.700649971266274*^9}, {
   3.700794680952661*^9, 3.7007946816031733`*^9}, {3.7162786569059553`*^9, 
   3.716278677307954*^9}, {3.716310686889244*^9, 3.716310687740814*^9}, {
   3.7163108111154013`*^9, 3.716310811499847*^9}, {3.716794410624638*^9, 
   3.7167944112079697`*^9}, {3.7167985862020187`*^9, 3.716798586551841*^9}, {
   3.7183407284984207`*^9, 3.718340729134615*^9}, {3.718346314269183*^9, 
   3.718346314914109*^9}, 3.718443054969769*^9, {3.718516943381414*^9, 
   3.7185169439758043`*^9}, {3.7185288683051167`*^9, 3.71852886874713*^9}, {
   3.718534239967559*^9, 3.7185342405905857`*^9}, {3.718540026242847*^9, 
   3.718540026629977*^9}, {3.718540780801784*^9, 3.718540781479313*^9}, {
   3.718541001818665*^9, 3.718541002188855*^9}, {3.718557314999001*^9, 
   3.718557315661908*^9}, {3.718558508689618*^9, 3.718558511293496*^9}, {
   3.71856169414962*^9, 3.7185616945619593`*^9}, {3.72053040827952*^9, 
   3.720530408884296*^9}, {3.720546343008892*^9, 3.7205463434979143`*^9}, {
   3.725258797518899*^9, 3.7252587982108593`*^9}, {3.7252596301935797`*^9, 
   3.725259630523988*^9}},
 CellLabel->
  "In[843]:=",ExpressionUUID->"b99381b6-c944-4f4d-85e7-bbdc20dddd4b"],

Cell["\<\
If $CoupledFMandRC is False, finite mass corrections are computed from the \
Born results with no radiative null temperature corrections. If this is set \
to True, the finite mass corrections are applied to the rates on which the \
Coulomb and radiative corrections are taken into account. True is the advised \
value. 

The expressions implemented are Eqs. 114 when $CoupledFMandRC is False, with \
the definition B23. If $CoupledFMandRC is True, then we use Eqs. 115 with the \
Fermi and radiative corrections corresponding to the above choices for \
radiative corrections.\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"5ba47d5f-c687-4a65-8d42-ea6888a0e68a"],

Cell[TextData[{
 "4) Mass shifts due to QED plasma effects are ",
 StyleBox["ALREADY",
  FontWeight->"Bold"],
 " taken into account in thermal radiative corrections.\nHowever it is \
possible to turn the option $QEDMassShift to true to check how this affects \
the rate when taken individually.\nApart to satisfy this curiosity, ",
 StyleBox["this option should be set to False",
  FontWeight->"Bold"],
 " in all cases."
}], "Text",
 CellChangeTimes->{{3.718622268666133*^9, 3.7186222860350647`*^9}, {
  3.718622957048277*^9, 3.7186230151103487`*^9}, {3.722609352433152*^9, 
  3.722609370793644*^9}, {3.724925157208601*^9, 
  3.724925159426754*^9}},ExpressionUUID->"e49fd04f-c645-4648-a616-\
bd5d2cfe9012"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$QEDMassShift", "=", "False"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.718622288534856*^9, 3.718622303892522*^9}, {
  3.718622585396584*^9, 3.718622586005734*^9}},
 CellLabel->
  "In[844]:=",ExpressionUUID->"fa803c13-24b4-4999-b525-fb7f5fbbcb20"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plasma corrections", "Subsection",
 CellChangeTimes->{{3.700546292046062*^9, 3.700546295901968*^9}, {
  3.700794753476942*^9, 3.700794755873991*^9}, {3.7159358568409023`*^9, 
  3.715935861003707*^9}},ExpressionUUID->"5e722e23-782c-4e2a-934c-\
092750a85d70"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$QEDPlasmaCorrections", "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$CompleteQEDPressure", "=", "True"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwd030s3HcYAHCcYUQrW03Q825DO9OOem3q18mmZ0RR1NjVOYdbm6Jk9Vqr
q5fSwynDyjZsSo+Wcs4OORtndahq6Oi6VLsq+XVnLIcKuuf7/PHkkydP8jzJ
8/0+1pzzIfFaGhoacRBE6dmjWfeFNLV+dwR1WuibeFhOU3LW76jpXgf/R6C9
MgC1MSg+SRzWrUGzj8eW7YC8KxfRn3ebqojNDV2oXOTmOV1BU22un6O+1VUF
xFS6CWVe6Mx/CCb+Noy6n3FcJY7PuKPxpW0Rf4OSMBnKUa+/IKoEjEVif3ij
t5mIpsT1PSjN1T5FnJ01QieWNhc8QCO+/jMia3WT4QlmvdTRJraZLPB8wWt+
66goPyqVArMzE9AbMRsiHqn36lUSW20CVhLBgn0R6CG94vmzYLJHHep3/X7W
OfDIyz/RKcXrMaJ+v4GSOG2qbukG13q1bhKPeb3zffa3NCWMiURvBa5OadTA
Hvu0HhBrPZfz99yGvhlqNM0+YY44tZOB/pEsf1AFWiRnTBOdXwTONYF9OWx0
/49WS0RBgxPataHTMAJG51qjYVe5K8Rg7nm0I3Fm32Nw+PESqhroUD4Hy1lK
NH9o7Z73HZpSbDPGiCJxhKYP0ZaDOiRL3ycOMsZQs06+uS84fzIdXRl9+1IS
WDTKRDuk4gPdoITVh24M1Po7ddPUR3Ix6iJL1/cFXR8J0MWNugziL7p3UfY0
s4f4720XtEzBMqdArTwOKtjQ5HNBxau96HKOWkgcLH63jFjaaGlUBDYXHkTD
vylkEVMibqBbH0fGCMG56Hg0fPGEgMifYKOiSYlXBWj11whqyrVOIUZd80JZ
xnU3ic7cVtTALCy1CuSNJaGcoODQGlCbF4PGsMUtRHmTHL0ecWCe6J/hgU4V
bqd1gaoko3RiQW5KO1EhyUFt9B1LesDxYz6obfpMqQQMGnqORiZYGu+SebfU
aDjb0U2rh6aM2yKPEBMPB1pJwbFgDlpcy3Yh+pWcQ23ql47KiGavUefxte1Z
0HB3B9UuqfppDkyxEKN7bF1f7YANsRS69EOWYEsC78IoQ5Nic3x2SL5dhFZn
W4dq9cK9vPFD24cM3ezAbIY5mlP59VdEi9ASlKf5LM4evHpYhX4mdnrKlMI/
+OAT1EWR52YFbhWVorMGjbaRYDWvF81dpFbY4OWDp1C53EQnFowKcUYzdVe+
aALtnuyidyyU1iYy2H/LAiqX9V0kzk3eQ3fjPj1hCZYmnUYHL5y2cASlVDwa
JAx5L6efpgLKuaj/W8nFxLC0TNToUO3oJZLvb0NV9GV+HmjnXYa2XgncqgNZ
nDPodDuT9R1oseyANh8fUFbIaSpdNoNudzcmikBhZwf6YeekOnoI7sX9DcpX
mUq/BJ/62qPtegFPNH6lqdX6WNSH+c9/mmCl4Sb6PwT/Wnc=
  "],
 CellLabel->
  "In[845]:=",ExpressionUUID->"87d82ed7-e6e5-4764-a56f-1686c2b7371f"],

Cell["\<\
If $QEDPlasmaCorrections is set to True, the QED corrections to the pressure \
and the energy density are taken into account. This affects for instance the \
expansion rate via the Friedmann equation. 
Expressions can be found in [Lopez&Turner 1998], [Mangano et al. 2001] or in \
[Heckler 1994]. See also the companion paper where Eqs. 48-52 are used inside \
Eq. 55 to modify the entropy and Eq. 58 to modify the energy density.
If $CompleteQEDPressure is False, the subdominant term is ignored. Otherwise \
it is included. We checked it is so subdominant that it does not change the \
results.
\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"5f769a06-cbd7-43db-975e-650f6296e949"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$IncompleteNeutrinoDecoupling", "=", "True"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwl1Hk8FHgUAHAsKh2j0g5ZkpVi027Ch0bDVO5KKDkGrZX76FBWW4ZdpeTu
GNtOciWtDRXTSJQ2pjKsFCFtzg6jlGtztfve2z9+n+9fv/d5n3ct941w3iMn
IyNzGB46ZF3jw8qQckojW/+XIVxnDlpX9ZOxfhVtqNvSWvKM9kwPGnBlQS9a
azYuuwHc4Swvh8qk6gVYgidyWGS4ut5PqGqUMWn0dc5faFFDKZk893MPKmAq
9aIDdx5nbwK9O61yUNvphTfR8U/aZIGRwXebQdkQU1JeecTABvTN+mINmntB
xTEQXMfXIxsTx2LQjxVqPLTtSqYYNYguIBUDx9aGgNuPzjZEb203Sw8F7UVW
pGKSKzsM9DoSRN4d8gpDpx+GkomV7Hq0psVXgo7sdx9AlbkRZOS/1d+Eg32p
ElLeTMsL9ThgRN4daF6UjHUq6Sb3JHG00EKepg4q//q9MWqy+IIpqhTv8fEa
mN0SRjo/ciwsA0Pme5PBL7IvHuFLOWGy5eTuIpnABLCUt4BU/EVlcRIo8ltB
sk/ktGSXSDmh5cVkh0CxPQ+MSlclY2b2vUE9NI6SN5pCDOpAvxUx5JvjQ5vQ
ydpJcnWS1SNWqZQTF+RK5j/gy5qDrtZ5ZNQyhZWoSd4SUtf/hrolWB19hxRq
7OIFgfNSgkid9YtWl4FFFlrkSGWXrX6ZlDMazLBDN6SIlSzBQ1s7ydvt0eXo
q0NnSe7pqWdoEkupDc01MSqKBX0ZDmRd7Sb7E6CBtxO57bC5Pxrp6Uze8rjo
mAjudrhKZlm4dKDndwSQk7rTE+h7ozmTKFO5zi4ZtKtvI90uK1Wjb+cxyZG4
G+1oRJaYzF+izEoHrXOWkQYJZ9lnMO6zErJ16Sf+WXBjlUImKplWfYzq7j5I
aktdpOir4u/JeNf+H86BifkTpP78zY2ov48Tud+z7RAftGe/I1Pr/IdRp6oY
8lO5lmIm+KemMTlc889ldBFXvhBlzNgcvI75MzzJkqaXV9F7kYPkz0uDT5WD
2Xll5JaIVclC8Nq0ESm08V7yGQz33EvGL7cZUSyXco7fciFNm/haIjBL8Ae5
V62FWwnmC7tJdVaEVzXYZxNH8s2WmzSDade+JWNYXmlPwOHGMLK5rq8GZc8d
JnNHTj9DS90KSLfUluCnoG5cD2n7JCwN/V0cS6rtNHzbAhYMWpDG7w6cagU1
zx0jx4Udl9rB3vLX5OwtrIoZUPJgG8nsFQyifSFXSMOGN80KQvgnniINP4jU
28AY3fskm/M4fhJ8frKf7DO9Zz4Ddr1uJOeHZ7rI3YT+GZaSmQ71I7PAXwUZ
o+gH923GOqCNFpfkWVSEoM0TEnKNyMpvBeh80onsGDvWpSGCOZITkCsTWo21
wCbdbpKtMEfHDdzqrklOejUUoooRneQWwedudDhhYQ+aEe897QFe5oaSar0p
Qz5gX9slsnWPZ0Iu2OEQQFY+VdFmVko5Fin65HOmbDTKfMggR/8usVsG7oya
In3TczX1QEPzYnKwK+vLo7fhTh4vJYtUGh1R5TXt5A7Vl2Ie+CNzmFxvKQ6O
BQt2NZMM4cXJ8+CU+3VSEu1t/xuY1hBEzrq/SpJ+F+6Lvi35tPhdYAY412SC
FPDWjnNroE7tDmR4+76NXuBhlxhyrNjWB3Ue8yA760NE3uDqnVGkhmzuC5l7
sP9fVZFJ/axRWXDA35r8D6NMIME=
  "],
 CellLabel->
  "In[847]:=",ExpressionUUID->"4ab75b5d-9c3b-4da6-ac93-8ced73903c79"],

Cell["\<\
If $IncompleteNeutrinoDecoupling is set to True we use a fit for the heating \
function of the neutrinos due to incomplete decoupling. Indeed if we consider \
the details of the decoupling of neutrinos, it is found that decoupling is \
incomplete by the time electrons and positrons annihilate into photons. This \
results in a slightly overheating of neutrinos and cooling of the \
electrons/photons plasma. In principle, one should also take into account the \
spectral distortions that this heating induces on the neutrinos. But \
neglecting it we can use a fit of the neutrinos heating functions and assume \
that neutrinos always stay thermalized. This allows to graps most of the \
effect on the abundance of Helium. The fitting functions which is used is the \
one given in [PArthENoPE]. It is used in Eq. 63 of the companion paper.
The advised value for $IncompleteNeutrinoDecoupling is True.\
\>", "Text",ExpressionUUID->"81460e21-0609-43ee-806e-f2aa7e3e29ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$RecomputePlasmaCorrections", "=", "False"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.694805330140026*^9, 3.6948053312903337`*^9}, {
   3.694808255698411*^9, 3.694808257163013*^9}, {3.694808495739277*^9, 
   3.694808496313715*^9}, {3.6948085287285223`*^9, 3.694808529342678*^9}, {
   3.6948091144036016`*^9, 3.6948091148629208`*^9}, {3.694813847660728*^9, 
   3.694813848290959*^9}, {3.694928922622508*^9, 3.6949289230624313`*^9}, {
   3.6949367603330812`*^9, 3.694936760855734*^9}, {3.695014984155478*^9, 
   3.695014984505108*^9}, {3.69502921347171*^9, 3.695029214245681*^9}, {
   3.6950292633748407`*^9, 3.695029263838872*^9}, {3.695031236872306*^9, 
   3.695031237524396*^9}, {3.695031689344091*^9, 3.695031689896277*^9}, {
   3.695106268987556*^9, 3.695106269611437*^9}, {3.6951278075575457`*^9, 
   3.6951278080960903`*^9}, 3.6984125701095457`*^9, {3.698438497862186*^9, 
   3.698438498472177*^9}, {3.698481592390478*^9, 3.698481592796836*^9}, {
   3.6984870535507793`*^9, 3.6984870541933517`*^9}, {3.698560075886796*^9, 
   3.698560079029215*^9}, {3.698648748298553*^9, 3.698648765060218*^9}, {
   3.699586101193038*^9, 3.699586101608403*^9}, {3.6995885741026983`*^9, 
   3.699588575493856*^9}, {3.699591168400625*^9, 3.699591168825186*^9}, {
   3.699592182087709*^9, 3.699592182660593*^9}, {3.699809224460561*^9, 
   3.699809224903447*^9}, {3.699811357263406*^9, 3.699811357925037*^9}, {
   3.7002894695981216`*^9, 3.7002894700551*^9}, {3.70032797948444*^9, 
   3.7003279800816927`*^9}, {3.700329473772485*^9, 3.700329474217127*^9}, {
   3.7003299035305023`*^9, 3.700329904166129*^9}, {3.700330354304337*^9, 
   3.700330354780424*^9}, {3.7003333080699167`*^9, 3.700333308847991*^9}, {
   3.700333578012682*^9, 3.700333578546323*^9}, {3.700335468649378*^9, 
   3.700335469336995*^9}, {3.700368045937707*^9, 3.700368046295415*^9}, {
   3.700368392175846*^9, 3.700368392705812*^9}, {3.7003691865153837`*^9, 
   3.7003691869455357`*^9}, {3.7003708226553907`*^9, 3.700370823209661*^9}, {
   3.700373948729822*^9, 3.700373949159918*^9}, {3.700376377801631*^9, 
   3.7003763783648777`*^9}, {3.7003839126469088`*^9, 3.700383913454547*^9}, {
   3.700387181726532*^9, 3.700387182425498*^9}, {3.700448834771757*^9, 
   3.700448835169323*^9}, {3.700448905279558*^9, 3.700448905813645*^9}, {
   3.700461100677137*^9, 3.700461101150074*^9}, {3.7004630768034897`*^9, 
   3.700463086442072*^9}, {3.7004636282361317`*^9, 3.700463629219551*^9}, {
   3.7004641803142138`*^9, 3.700464180833115*^9}, {3.700473906210381*^9, 
   3.7004739065509577`*^9}, {3.70047525200138*^9, 3.700475252498476*^9}, {
   3.700476793532584*^9, 3.700476794077251*^9}, {3.700477211965539*^9, 
   3.700477212508566*^9}, {3.700477399027767*^9, 3.700477399391695*^9}, {
   3.700477876799899*^9, 3.700477879414365*^9}, {3.700478410888397*^9, 
   3.700478411282873*^9}, {3.700488902394755*^9, 3.7004889029353657`*^9}, {
   3.700488991609756*^9, 3.700488992018138*^9}, {3.7004910773222303`*^9, 
   3.7004910779544783`*^9}, {3.7004914850684547`*^9, 3.700491508087418*^9}, {
   3.700550375364585*^9, 3.700550375706896*^9}, {3.7007932861201487`*^9, 
   3.700793286634314*^9}, {3.7008284403035192`*^9, 3.7008284548810177`*^9}, {
   3.7009021829693203`*^9, 3.7009021897709427`*^9}, {3.7035721633377733`*^9, 
   3.7035721636665897`*^9}, {3.7035728489408817`*^9, 
   3.7035728494786882`*^9}, {3.703573464183345*^9, 3.703573467731658*^9}, {
   3.713686523653545*^9, 3.713686537070323*^9}, {3.7136872636018887`*^9, 
   3.7136872639748573`*^9}, {3.713687733614356*^9, 3.713687734240924*^9}, {
   3.713763478927218*^9, 3.71376347932423*^9}, {3.713764810963806*^9, 
   3.7137648115057373`*^9}, {3.713765172192951*^9, 3.713765172564128*^9}, {
   3.713765717315069*^9, 3.713765717870883*^9}, {3.713771525346353*^9, 
   3.7137715257598953`*^9}, {3.713782411844214*^9, 3.71378241240345*^9}, {
   3.713862551861219*^9, 3.7138625522146*^9}, {3.7138628769213037`*^9, 
   3.713862877450453*^9}, {3.713876075621323*^9, 3.7138760760406933`*^9}, {
   3.713876963631525*^9, 3.713876980137809*^9}, {3.71387701168572*^9, 
   3.713877012530519*^9}, {3.715658794441771*^9, 3.7156587948280697`*^9}, {
   3.715659478491951*^9, 3.71565947919001*^9}, {3.7156732338372383`*^9, 
   3.715673234206655*^9}, {3.715674554537373*^9, 3.715674555110406*^9}, {
   3.7159584335824013`*^9, 3.715958452707944*^9}, {3.715958983914315*^9, 
   3.715959012923685*^9}, {3.715960975276493*^9, 3.7159609756574297`*^9}, {
   3.71596146127967*^9, 3.715961461975339*^9}, {3.715961495343318*^9, 
   3.715961497030529*^9}, {3.715961619230983*^9, 3.7159616279360723`*^9}, {
   3.7159617328793077`*^9, 3.715961752159012*^9}, {3.7159618005928507`*^9, 
   3.7159618009642467`*^9}, {3.715961948630558*^9, 3.715961949395235*^9}, {
   3.715964608444154*^9, 3.71596461409015*^9}, 3.716005404385887*^9, {
   3.7161770683099213`*^9, 3.716177068665028*^9}, {3.7162192035309763`*^9, 
   3.716219204052115*^9}, {3.716310565531036*^9, 3.7163105760630817`*^9}, {
   3.7165228925348673`*^9, 3.716522895963201*^9}, {3.7168019050965033`*^9, 
   3.71680190806042*^9}, {3.718249705171277*^9, 3.718249707117038*^9}, {
   3.7183371026481733`*^9, 3.7183371032417994`*^9}, {3.7183823077038107`*^9, 
   3.718382308232183*^9}, {3.718383842442848*^9, 3.7183838433743467`*^9}, {
   3.7184628001598063`*^9, 3.718462800664274*^9}, {3.718532409623554*^9, 
   3.7185324102074747`*^9}, {3.718534728800343*^9, 3.718534729138707*^9}, {
   3.718539856286491*^9, 3.718539856892804*^9}, {3.71877086124398*^9, 
   3.718770861665668*^9}, {3.7187874152787933`*^9, 3.7187874158096523`*^9}, {
   3.71878902039668*^9, 3.718789020810049*^9}, {3.718980042603072*^9, 
   3.7189800431971407`*^9}, {3.719151086552423*^9, 3.719151087388424*^9}, {
   3.7191517355148478`*^9, 3.719151736099864*^9}, {3.719152006548255*^9, 
   3.7191520170410233`*^9}, {3.719208255280446*^9, 3.719208255643118*^9}, {
   3.7192128818516073`*^9, 3.7192128825167093`*^9}, {3.7202163886281776`*^9, 
   3.720216414009306*^9}, {3.725594532604672*^9, 3.725594533019259*^9}, {
   3.725594661482081*^9, 3.725594662145029*^9}},
 CellLabel->
  "In[848]:=",ExpressionUUID->"d6edfbcb-9da8-4568-a651-33e7a7447992"],

Cell["\<\
Since the QED effects depend on temperature, they need to be computed only \
once for all and they are stored on a file. But we can force the \
recomputation of these corrections by setting $RecomputePlasmaCorrections to \
True;\
\>", "Text",
 CellChangeTimes->{{3.715961498733636*^9, 3.7159615450682487`*^9}, 
   3.7160054044238987`*^9, {3.716005435709878*^9, 
   3.716005439502181*^9}},ExpressionUUID->"d101c2ed-4f04-472e-984b-\
8c8eef51f18b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Degenerate Neutrinos", "Subsection",
 CellChangeTimes->{{3.71981770782755*^9, 
  3.719817712899815*^9}},ExpressionUUID->"bee3d7aa-99b5-4852-8ff9-\
1545252b109b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$DegenerateNeutrinos", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]OverT\[Nu]", "=", "0.0"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7198113723603497`*^9, 3.719811385911289*^9}, {
   3.71981141648904*^9, 3.719811426604183*^9}, {3.719811665221279*^9, 
   3.7198116707513943`*^9}, {3.7198121389652348`*^9, 3.719812139570037*^9}, {
   3.719812734309225*^9, 3.719812734656049*^9}, 3.7198129767856503`*^9, {
   3.71981767126296*^9, 3.719817671858005*^9}, {3.719839637198943*^9, 
   3.719839641160705*^9}, 3.719841802518704*^9, 3.7198431421532907`*^9, 
   3.719890953036969*^9, {3.719892293095253*^9, 3.719892293274975*^9}, {
   3.7198979559407682`*^9, 3.719897956945006*^9}},
 CellLabel->
  "In[849]:=",ExpressionUUID->"35a7ba33-6773-4885-9f8a-d3eaf520ee5e"],

Cell[TextData[{
 "If neutrinos have a chemical potential, then $DegenerateNeutrinos = True. \
Standard BBN is with non-degenerate neutrinos and when $DegenerateNeutrinos = \
False the value of \[Mu]OverT\[Nu] is ignored. Note that in the case of \
degenerate neutrinos, one must run the code with RecomputeWeakRates = True \
because this modifies the weak rates. And for every value of \[Mu]OverT\[Nu] \
one must recompute the weak rates.\n\[Mu]OverT\[Nu] is also noted ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Xi]", "\[Nu]"], " ", "in", " ", "the", " ", "companion", 
    " ", 
    RowBox[{"paper", "."}]}], TraditionalForm]],ExpressionUUID->
  "3b87ba23-204b-499f-9596-5331b4a148e9"],
 " See section VI.C."
}], "Text",ExpressionUUID->"3973867b-932b-465c-9cb9-f80dd9abaf1c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initial definitions", "Chapter",
 CellChangeTimes->{{3.7003897626703367`*^9, 3.700389778026813*^9}, {
  3.7003898235332212`*^9, 
  3.700389826600202*^9}},ExpressionUUID->"d8c804c6-e331-4605-8de4-\
2305ab3861bb"],

Cell[CellGroupData[{

Cell["Temperature eras", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.693923053427843*^9, 3.6939230581900463`*^9}, {
  3.693930514558496*^9, 3.693930515877666*^9}, {3.70038975321306*^9, 
  3.700389755459*^9}, {3.71591956523943*^9, 
  3.715919567300664*^9}},ExpressionUUID->"2bb5b4ef-4c31-4765-a6b5-\
908196e88138"],

Cell[TextData[{
 "We choose to split the BBN numerical calculations in three eras. \n 1) \
First the high temperature era between ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Tstart", "=", 
    RowBox[{
     SuperscriptBox["10", "11"], "K"}]}], TraditionalForm]],ExpressionUUID->
  "d6d7d3be-2a59-4c7f-8904-b709d9d50c09"],
 " and TMiddle. Only neutrons and protons abundances are tracked and this is \
ruled by weak interactions. \n 2) The intermediary era, between TMiddle and \
T18, where only a small network of reactions (17 nuclear reactions plus weak \
interactions or possibly less) is used.\n 3) A low temperature region, \
between T18 and Tend, where Tend is usually slightly lower than ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["10", "8"], " ", "K"}], ",", " ", 
    RowBox[{
     RowBox[{"typically", " ", "Tend"}], "=", 
     RowBox[{"6", " ", 
      SuperscriptBox["10", "7"], 
      RowBox[{"K", "."}]}]}]}], TraditionalForm]],ExpressionUUID->
  "2875e780-710d-4685-aaf4-0b42db1bff48"],
 "\n \n So we have Tstart > TMiddle > T18 > Tf."
}], "Text",ExpressionUUID->"2da4740b-7f86-4d7f-987f-702517d25886"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Kelvin", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tstart", "=", 
   RowBox[{
    SuperscriptBox["10", "11"], "Kelvin"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TMiddle", ":=", 
   RowBox[{"0.9999", "*", 
    SuperscriptBox["10", "10"], " ", "Kelvin"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T18", ":=", 
   RowBox[{"1.25", " ", "*", 
    SuperscriptBox["10", "9"], " ", "Kelvin"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tend", "=", 
   RowBox[{"6.", "*", 
    SuperscriptBox["10", "7"], "Kelvin"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzE9Ik3EYwPE3pflnr7GJjrnFK+KfZlCUQVlN26seLDy4yEvMDhMFQ1zm
oiGYA2cRse0k9EbMzcEcikVOttUUndvonejB3pG26mSa+hpYMIkdot/zHL58
bt8Ko+l2dw5FUVUk0Bm8VjQwI7IfGL0MfFWpsoOpCIPahMw2GN5f+gEGhp5l
wBZpDHVTs/KHRIOER42Z8OVBIkXH0XOXjm6A2qcNLMiYEjUeYvud3DOgJVV0
FbyoiKLy4S8ukOe+opbxUIOP6Mq73ggyBf4HYPnqOuqUckn7W5FdKXasgelG
Qxp8JPu4Dapb6085iPpJJ9r7z106SWzieHTXIFGB1pASjSXpapB/oUZbPjVf
AOvGFtGzW/kx8PjvVBz8tmrd9RLvdtlRbfYmE5kT2ehMB6p986QO/LUzhh5t
9OjANkc/2l/r6wZL2qZRxX2p7ifRLQygtuHoCHiwqbSCPfPPhT1iuO9ECnxZ
WF5dGBBZn9+Epj3zV8BB22+097OnUkE0zh6giZxbXnDo9Sga/D6effxeZM1/
NlCVRpgzL5DvOzoAcjIv3ak+ZMsm/GhVq+beydOH7HLfefQ/QM4xuw==
  "],
 CellLabel->
  "In[851]:=",ExpressionUUID->"1a4b23d9-d13a-4a2d-8e84-5b05925e06cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Temperature sampling", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.693923053427843*^9, 3.6939230581900463`*^9}, {
  3.693930514558496*^9, 3.693930515877666*^9}, {3.70038975321306*^9, 
  3.700389755459*^9}},ExpressionUUID->"63faa59c-8f47-4ffe-9088-a1f1b545ac96"],

Cell[TextData[{
 "We choose to sample temperature starting from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["10", "12"], 
    RowBox[{"K", ".", " ", "This"}], " ", "is", " ", "interesting", " ", "to",
     " ", "check", " ", "high", " ", "T", " ", "behaviour", " ", "of", " ", 
    "some", " ", 
    RowBox[{"effects", "."}]}], TraditionalForm]],ExpressionUUID->
  "01348dbb-0f90-433b-b242-ba2bfd568b7f"]
}], "Text",
 CellChangeTimes->{{3.715961260201168*^9, 
  3.7159613029265947`*^9}},ExpressionUUID->"09d11b21-26c5-4ad6-9b4c-\
e5e10e2a2046"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ti", "=", 
   RowBox[{
    SuperscriptBox["10", "11"], "Kelvin"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tf", "=", 
   RowBox[{"6.", "*", 
    SuperscriptBox["10", "7"], "Kelvin"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LogTi", "=", 
   RowBox[{"1.", 
    RowBox[{"Log10", "[", "Ti", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LogTf", "=", 
    RowBox[{"1.", 
     RowBox[{"Log10", "[", "Tf", "]"}]}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693919761613886*^9, 3.693919818629312*^9}, 
   3.693920948790902*^9, {3.6950130244117413`*^9, 3.695013038337596*^9}, {
   3.695015535378949*^9, 3.695015539283671*^9}, {3.696282899032187*^9, 
   3.696282899450047*^9}, {3.696282997806497*^9, 3.696282998193803*^9}, {
   3.696283073426956*^9, 3.696283074134177*^9}, {3.696283502313595*^9, 
   3.696283502948208*^9}, {3.696283658937181*^9, 3.696283660106181*^9}, {
   3.6963170551309977`*^9, 3.696317055647524*^9}, {3.696317885401352*^9, 
   3.696317885759769*^9}, {3.696318033970974*^9, 3.696318034756201*^9}, {
   3.696335586857277*^9, 3.696335587677862*^9}, {3.696338029748801*^9, 
   3.696338030181481*^9}, {3.696565976985176*^9, 3.696565978055017*^9}, {
   3.696678380499899*^9, 3.696678380901224*^9}, {3.6966785514156713`*^9, 
   3.696678551799127*^9}, {3.696685333038315*^9, 3.696685333425149*^9}, {
   3.69668682311987*^9, 3.6966868238238573`*^9}, {3.6966873435026283`*^9, 
   3.6966873438658657`*^9}, {3.696756422422924*^9, 3.696756423212399*^9}, {
   3.696759389471217*^9, 3.6967593901258707`*^9}, {3.697891733548994*^9, 
   3.697891733940465*^9}, {3.697894143336885*^9, 3.697894143803648*^9}, {
   3.698040139242378*^9, 3.698040140523439*^9}, {3.698379162923264*^9, 
   3.698379170304223*^9}, {3.699985723130155*^9, 3.699985733350403*^9}, {
   3.6999861345945168`*^9, 3.699986152200953*^9}, {3.699986403037323*^9, 
   3.699986404587566*^9}, {3.700289444487681*^9, 3.700289446243494*^9}, {
   3.700333316071907*^9, 3.7003333172007637`*^9}, {3.700335247733714*^9, 
   3.700335251031063*^9}, {3.700372783370232*^9, 3.700372785272703*^9}, {
   3.700462387594635*^9, 3.7004623900440598`*^9}, {3.700462420515955*^9, 
   3.700462425946719*^9}, {3.715919605193555*^9, 3.715919620883581*^9}, {
   3.715961145218935*^9, 3.715961187502248*^9}, {3.715961923139669*^9, 
   3.715961927166081*^9}, {3.715962354714036*^9, 3.715962385919656*^9}, {
   3.716349922407201*^9, 3.716349923595511*^9}, {3.7163504720383377`*^9, 
   3.716350472536314*^9}, {3.716350528740047*^9, 3.7163505324162292`*^9}, {
   3.7163506850810127`*^9, 3.7163506872946997`*^9}, {3.7163507976365643`*^9, 
   3.716350798055196*^9}, {3.716351641713019*^9, 3.716351642103917*^9}, {
   3.7163517684918413`*^9, 3.716351769646584*^9}, {3.716368408991664*^9, 
   3.716368428154399*^9}, {3.71652244202619*^9, 3.716522442495369*^9}, {
   3.716522908581176*^9, 3.716522908702758*^9}, {3.7165234760968733`*^9, 
   3.716523476630991*^9}, {3.7167020688859987`*^9, 3.716702070318521*^9}, {
   3.716703843418407*^9, 3.716703844055389*^9}, {3.7723716994784317`*^9, 
   3.7723717041089*^9}, {3.772435219630549*^9, 3.772435221038846*^9}, {
   3.7724378939306*^9, 3.772437895626643*^9}, {3.772442389679411*^9, 
   3.772442393464878*^9}, {3.772451456366481*^9, 3.772451457745545*^9}, {
   3.772787447720744*^9, 3.7727874534409523`*^9}},
 CellLabel->
  "In[856]:=",ExpressionUUID->"109b176c-e063-4831-9779-636dac072e60"],

Cell["\<\
We first build the list of LogT points (ListLogT) and then the list of T \
points (ListT).\
\>", "Text",
 CellChangeTimes->{{3.715959741965578*^9, 
  3.7159597443163967`*^9}},ExpressionUUID->"f3f43723-9495-4281-85f4-\
29dda866f4b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ListLogT", "=", 
   RowBox[{"Sort", "@", 
    RowBox[{"DeleteDuplicates", "@", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "10.", "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "LogTf", ",", "LogTi", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"LogTi", "-", "LogTf"}], ")"}], "/", 
            "NTemperaturePoints"}]}], "}"}]}], "]"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListT", "=", 
   RowBox[{"1.", " ", 
    SuperscriptBox["10", "ListLogT"]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693919973881987*^9, 3.6939200799313183`*^9}, {
   3.693924528218768*^9, 3.693924546432506*^9}, {3.693924794613625*^9, 
   3.693924807221635*^9}, {3.694062892971739*^9, 3.6940628943557034`*^9}, {
   3.6942776342915583`*^9, 3.694277637553166*^9}, {3.694278561008986*^9, 
   3.6942785611594057`*^9}, {3.694279193597004*^9, 3.694279194579939*^9}, {
   3.6942927676784973`*^9, 3.69429276806472*^9}, {3.696565984329157*^9, 
   3.696565995927536*^9}, 3.698379225314122*^9, {3.699985740620707*^9, 
   3.699985741202445*^9}, 3.700329325449548*^9, 3.700329407814866*^9, {
   3.7003718778450937`*^9, 3.700371878369937*^9}, {3.700372680651785*^9, 
   3.700372706956308*^9}, {3.700373026113193*^9, 3.700373050433498*^9}, {
   3.700373094280715*^9, 3.700373139765266*^9}, {3.7003738732735023`*^9, 
   3.700373878003902*^9}, {3.700374044308537*^9, 3.7003740612590647`*^9}, 
   3.70038742434235*^9, 3.70046232089909*^9, 3.700462400832155*^9, {
   3.7004624504745197`*^9, 3.700462475798324*^9}},
 CellLabel->
  "In[860]:=",ExpressionUUID->"df098e13-20e0-4f68-a6ff-d5cac0c310a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListTRange", "[", 
   RowBox[{"T1_", ",", "T2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"len", "=", 
       RowBox[{"Length", "@", "ListT"}]}], ",", "imindown", ",", "imaxup", 
      ",", 
      RowBox[{"Tmin", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"T1", ",", "T2"}], "]"}]}], ",", 
      RowBox[{"Tmax", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"T1", ",", "T2"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imindown", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"ListT", ",", 
            RowBox[{"SelectFirst", "[", 
             RowBox[{"ListT", ",", 
              RowBox[{
               RowBox[{"#", ">", "Tmin"}], "&"}]}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"imaxup", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"len", ",", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"ListT", ",", 
           RowBox[{"SelectFirst", "[", 
            RowBox[{"ListT", ",", 
             RowBox[{
              RowBox[{"#", ">=", "Tmax"}], "&"}]}], "]"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ListT", "[", 
      RowBox[{"[", 
       RowBox[{"imindown", ";;", "imaxup"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.696567494183449*^9, 3.696567580351705*^9}, {
   3.700371718377239*^9, 3.7003717852096033`*^9}, {3.7003718204350147`*^9, 
   3.700371842807444*^9}, {3.7003718911419983`*^9, 3.70037198792472*^9}, {
   3.700372020010166*^9, 3.7003720831091337`*^9}, {3.7003722118083677`*^9, 
   3.700372236158132*^9}, {3.7003723988685217`*^9, 3.700372415844841*^9}, {
   3.7003725810360117`*^9, 3.7003726296984*^9}, {3.7003727387291*^9, 
   3.700372743251156*^9}, {3.700372913326993*^9, 3.7003729134708853`*^9}, {
   3.700373167072146*^9, 3.70037317118956*^9}, 3.700832178016198*^9, 
   3.70083234496251*^9},
 CellLabel->
  "In[862]:=",ExpressionUUID->"a6ebfc50-fc01-4e64-a9dd-dbcb0451fe9d"],

Cell[TextData[{
 "ListTRange is a function to select a sublist in this list of temperature, \
according to a range of temperature which makes sure to have either the \
points on the boundary or at least one point beyond (to avoid problems with \
interpolating functions).\nIf T = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["10", "10"], TraditionalForm]],ExpressionUUID->
  "53bb9bf1-40b3-4ad7-80fd-bd2694fcc2ad"],
 " is not in the list, we add it to avoid problems with interpolations of \
reactions rates which all start at 10^10 and below. "
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.69656758745322*^9, 3.696567602854609*^9}, {
   3.698379311232974*^9, 3.6983793183082657`*^9}, {3.700372113326593*^9, 
   3.7003721371464167`*^9}, 3.7159197603166933`*^9, {3.715959775288155*^9, 
   3.715959784261585*^9}, 
   3.722683861237031*^9},ExpressionUUID->"df35e7c2-f03a-4604-94ee-\
3811adb20223"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constants of Physics", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6939232074168243`*^9, 3.693923215793735*^9}, 
   3.698379341357914*^9},ExpressionUUID->"cb5bcee3-241d-44e7-9d2c-\
cc525b688a6c"],

Cell["cgs system ", "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{3.715936086907934*^9},
 FontSize->16,ExpressionUUID->"90fb0ef8-7a6e-45ed-a763-4d085ad46a27"],

Cell[BoxData[
 RowBox[{"We", " ", "use", " ", "cgs", " ", "system", " ", "with", " ", 
  RowBox[{"Kelvin", ".", " ", 
   RowBox[{"(", 
    RowBox[{
    "For", " ", "instance", " ", "an", " ", "erg", " ", "is", " ", "1", " ", 
     "g", " ", 
     SuperscriptBox["cm", "2"], " ", 
     SuperscriptBox["s", 
      RowBox[{"-", "2"}]]}], ")"}], ".", "\n", "By"}], " ", "definition", " ",
   "these", " ", "are", " ", "set", " ", "to", " ", "one", " ", "in", " ", 
  "these", " ", 
  RowBox[{"units", ".", " ", "Any"}], " ", "change", " ", "of", " ", "system",
   " ", "of", " ", "units", " ", "can", " ", "be", " ", "made", " ", "by", 
  " ", "modifying", " ", "these", " ", "variables", " ", 
  RowBox[{"only", "."}]}]], "Text",
 InitializationCell->True,
 CellChangeTimes->{
  3.693926361829739*^9, {3.694750130681004*^9, 3.694750156298362*^9}, {
   3.71593609039811*^9, 3.715936110938343*^9}},
 FontFamily->"Arial",ExpressionUUID->"98da1543-6121-48ce-ada1-2025c4dd4bbf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "For", " ", "instance", " ", "if", " ", "we", " ", "want", " ", "to", " ", 
   "use", " ", "the", " ", 
   RowBox[{
    RowBox[{"m", "/", "kg"}], "/", "s"}], " ", "system", " ", "we", " ", 
   "need", " ", "only", " ", "put", " ", "cm"}], "=", 
  RowBox[{
   RowBox[{"0.01", " ", "and", " ", "gram"}], " ", "=", " ", 
   RowBox[{"0.001", " ", 
    RowBox[{"below", ".", " "}]}]}]}]], "Text",
 InitializationCell->True,
 CellChangeTimes->{
  3.693926361829739*^9, {3.694750130681004*^9, 3.694750156298362*^9}, {
   3.71593609039811*^9, 3.715936110938343*^9}},
 FontFamily->"Arial",ExpressionUUID->"01ba93d8-c089-42a9-8e64-fe3ec967c480"],

Cell[BoxData[
 RowBox[{
  RowBox[{"As", " ", "a", " ", "check"}], ",", " ", 
  RowBox[{
  "final", " ", "results", " ", "should", " ", "not", " ", "depend", " ", 
   "on", " ", "these", " ", "conventions", " ", "since", " ", "abundance", 
   " ", "rates", " ", "are", " ", 
   RowBox[{"dimensionless", "."}]}]}]], "Text",
 InitializationCell->True,
 CellChangeTimes->{
  3.693926361829739*^9, {3.694750130681004*^9, 3.694750156298362*^9}, {
   3.71593609039811*^9, 3.7159361021487103`*^9}},
 FontFamily->"Arial",ExpressionUUID->"8689666d-02d7-4d0e-8c28-b91f1167465d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"second", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cm", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gram", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693923440850594*^9, 3.69392346729781*^9}, {
   3.693923596061167*^9, 3.693923613951198*^9}, {3.693925644692514*^9, 
   3.693925655276031*^9}, {3.693925700059594*^9, 3.693925705223542*^9}, {
   3.693925840644717*^9, 3.693925845338539*^9}, {3.693926221488364*^9, 
   3.693926224806938*^9}, {3.693926371226465*^9, 3.693926382826901*^9}, {
   3.695012634724168*^9, 3.69501263665774*^9}, {3.695012946026195*^9, 
   3.695012948128811*^9}, {3.6950131014083157`*^9, 3.695013104305449*^9}, {
   3.695013579804489*^9, 3.695013581701914*^9}, {3.695013945420559*^9, 
   3.695013948748609*^9}, {3.695020197239711*^9, 3.695020198900654*^9}, {
   3.700037685730651*^9, 3.700037691257346*^9}, {3.700222845023498*^9, 
   3.7002228481986113`*^9}, {3.700372793447097*^9, 3.700372794174239*^9}, 
   3.715936059484374*^9},
 CellLabel->
  "In[863]:=",ExpressionUUID->"106c34e7-6b39-486f-955c-0bafbde1ab58"],

Cell["\<\
When taking values from the kg/m/s system, we use the factors\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6939263844737377`*^9, 3.693926402892288*^9}, 
   3.693930457631441*^9, {3.6983793794357033`*^9, 
   3.698379389860097*^9}},ExpressionUUID->"d275115e-b9fa-42bc-883d-\
f244a8cbdf18"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kg", "=", 
   RowBox[{
    SuperscriptBox["10", "3"], " ", "gram"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meter", " ", "=", " ", 
   RowBox[{
    SuperscriptBox["10", "2"], " ", "cm"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"km", "=", 
   RowBox[{
    SuperscriptBox["10", "3"], " ", "meter"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Joule", " ", "=", 
    RowBox[{"kg", " ", 
     RowBox[{
      RowBox[{"meter", "^", "2"}], "/", 
      RowBox[{"second", "^", "2"}]}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"This", " ", "gives", " ", 
    SuperscriptBox["10", "7"], " ", "ergs"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DensityUnit", "=", 
   RowBox[{"gram", "/", 
    RowBox[{"cm", "^", "3"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hz", "=", 
   RowBox[{"1", "/", "second"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693923440850594*^9, 3.69392346729781*^9}, {
  3.693923596061167*^9, 3.693923613951198*^9}, {3.693925644692514*^9, 
  3.693925655276031*^9}, {3.693925700059594*^9, 3.693925705223542*^9}, {
  3.693925840644717*^9, 3.693925845338539*^9}, {3.693926221488364*^9, 
  3.693926224806938*^9}, {3.693926371226465*^9, 3.69392641014727*^9}, {
  3.694750425245089*^9, 3.694750425396125*^9}, {3.6950136751896553`*^9, 
  3.695013692991084*^9}, {3.71593606004537*^9, 3.7159360608867702`*^9}},
 CellLabel->
  "In[866]:=",ExpressionUUID->"4c1cb408-d9b0-4951-a2ef-626610918cb1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Giga", "=", 
   SuperscriptBox["10", "9"]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Mega", "=", 
   SuperscriptBox["10", "6"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Kilo", "=", 
   SuperscriptBox["10", "3"]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693993372584735*^9, 3.6939933858077803`*^9}, {
  3.717503253648108*^9, 3.717503260249372*^9}},
 CellLabel->
  "In[872]:=",ExpressionUUID->"8f4f4881-d61b-42a9-b3e6-45859e42105e"],

Cell["Fundamental constants", "Text",
 CellDingbat->"\[FilledSquare]",
 InitializationCell->True,
 CellChangeTimes->{{3.694750412128196*^9, 3.6947504185435123`*^9}, {
  3.694750486942068*^9, 3.694750487210312*^9}},
 FontSize->16,ExpressionUUID->"34383e91-7a39-410f-aeea-19d79f4f60e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"kB", " ", "=", 
    RowBox[{"1.3806488", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "23"}]], 
     RowBox[{"Joule", " ", "/", " ", "Kelvin"}]}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Boltzmann", " ", "constant", " ", "in", " ", 
    RowBox[{"J", "/", "K"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"clight", "=", 
    RowBox[{"2.99792458", "*", 
     SuperscriptBox["10", "8"], "*", 
     RowBox[{"meter", "/", "second"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"speed", " ", "of", " ", "light", " ", "in", " ", 
    RowBox[{"cm", "/", "s"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"hbar", "=", " ", 
   RowBox[{
    FractionBox["6.62606957", 
     RowBox[{"2", "\[Pi]"}]], 
    SuperscriptBox["10", 
     RowBox[{"-", "34"}]], 
    RowBox[{"(*", 
     RowBox[{"1.054571596", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "34"}]]}], "*)"}], " ", "Joule", " ", "second"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Avogadro", "=", 
   RowBox[{"6.0221415", " ", 
    SuperscriptBox["10", "23"]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693923220822422*^9, 3.693923249726046*^9}, {
   3.693923577955722*^9, 3.6939236348981752`*^9}, {3.693926237161207*^9, 
   3.69392624238977*^9}, 3.693930720120225*^9, {3.693990669647138*^9, 
   3.693990672366892*^9}, {3.6939933943713837`*^9, 3.693993395666225*^9}, {
   3.694264548901173*^9, 3.694264549817799*^9}, {3.6942645825140753`*^9, 
   3.694264598485705*^9}, {3.6947504224215107`*^9, 3.694750452858447*^9}, {
   3.694750488670856*^9, 3.694750489002677*^9}, {3.694867254082062*^9, 
   3.694867263601419*^9}, {3.694867304856*^9, 3.694867377955138*^9}, {
   3.694869303294401*^9, 3.694869303681827*^9}, {3.695012756210307*^9, 
   3.695012764758833*^9}, {3.69501531231142*^9, 3.695015318954904*^9}, 
   3.699772959580907*^9, {3.699952473395418*^9, 3.6999524861282997`*^9}, 
   3.7000183698890877`*^9, {3.7159361522110157`*^9, 3.715936153851223*^9}},
 CellLabel->
  "In[875]:=",ExpressionUUID->"7cb2030d-e2c6-4ab0-8f9d-e5f8f5c4c1ad"],

Cell["\<\
When using masses of particles, we use eV and MeV that we convert in the cgs \
system\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.693923220822422*^9, 3.693923249726046*^9}, {
   3.693923577955722*^9, 3.6939236348981752`*^9}, {3.693926237161207*^9, 
   3.69392624238977*^9}, 3.693930720120225*^9, {3.693990669647138*^9, 
   3.693990672366892*^9}, {3.6939933943713837`*^9, 3.693993395666225*^9}, {
   3.694264548901173*^9, 3.694264549817799*^9}, {3.6942645825140753`*^9, 
   3.694264598485705*^9}, {3.6947504224215107`*^9, 3.694750452858447*^9}, {
   3.694750488670856*^9, 3.694750489002677*^9}, {3.694867254082062*^9, 
   3.694867263601419*^9}, {3.694867304856*^9, 3.694867377955138*^9}, {
   3.694869303294401*^9, 3.694869303681827*^9}, {3.695012756210307*^9, 
   3.6950127672062798`*^9}},ExpressionUUID->"690e452c-bd75-482f-b9f5-\
391f31546bc6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eV", "=", 
   RowBox[{"1.60217653", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "19"}]], "Joule"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"keV", " ", "=", " ", 
   RowBox[{"Kilo", " ", "eV"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MeV", "=", 
   RowBox[{"Mega", " ", "eV"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GeV", "=", 
   RowBox[{"Giga", " ", "eV"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693923220822422*^9, 3.693923249726046*^9}, {
   3.693923577955722*^9, 3.6939236348981752`*^9}, {3.693926237161207*^9, 
   3.69392624238977*^9}, 3.693930720120225*^9, {3.693990669647138*^9, 
   3.693990672366892*^9}, {3.6939933943713837`*^9, 3.693993395666225*^9}, {
   3.694264548901173*^9, 3.694264549817799*^9}, {3.6942645825140753`*^9, 
   3.694264598485705*^9}, {3.6947504224215107`*^9, 3.694750452858447*^9}, {
   3.694750488670856*^9, 3.694750489002677*^9}, {3.694867254082062*^9, 
   3.694867263601419*^9}, {3.694867304856*^9, 3.694867377955138*^9}, {
   3.694869303294401*^9, 3.694869303681827*^9}, {3.695012756210307*^9, 
   3.695012790409842*^9}, {3.717503263934125*^9, 3.71750326826795*^9}},
 CellLabel->
  "In[879]:=",ExpressionUUID->"f3c0d75b-b0d5-4559-b04a-1983bdf6b342"],

Cell["Interactions constants", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698379419928007*^9, 
  3.698379427005988*^9}},ExpressionUUID->"c110bf12-59a7-4898-9852-\
80f34cbd4e1c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GN", "=", 
    RowBox[{"6.67384", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "11"}]], 
     RowBox[{
      RowBox[{
       RowBox[{"meter", "^", "3"}], "/", "kg"}], "/", 
      RowBox[{"second", "^", "2"}]}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Gravitation", " ", "constant"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GF", "=", 
    RowBox[{"1.1663787", "*", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "5"}]], "/", 
      RowBox[{
       RowBox[{"(", "GeV", ")"}], "^", "2"}]}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Fermi", " ", "Constant"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gA", "=", "1.2723"}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Axial", " ", "current", " ", "constant", " ", "of", " ", "structure", " ",
     "of", " ", "the", " ", "nucleons", " ", "Particle", " ", "data", " ", 
    RowBox[{"group", " ", ":", " ", 
     RowBox[{"1.2723", 
      RowBox[{"(", 
       RowBox[{"+", 
        RowBox[{"-", "23"}]}], ")"}], " ", "PDG2016"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "However", " ", "post", " ", "2002", " ", "data", " ", "suggest", " ", 
    "1.2755", 
    RowBox[{"(", "11", ")"}], " ", "as", " ", "advised", " ", "by", " ", 
    "William", " ", "Marciano"}], "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693923220822422*^9, 3.693923249726046*^9}, {
   3.693923577955722*^9, 3.6939236348981752`*^9}, {3.693926237161207*^9, 
   3.69392624238977*^9}, 3.693930720120225*^9, {3.693990669647138*^9, 
   3.693990672366892*^9}, {3.6939933943713837`*^9, 3.693993395666225*^9}, {
   3.694264548901173*^9, 3.694264549817799*^9}, {3.6942645825140753`*^9, 
   3.694264598485705*^9}, {3.6947504224215107`*^9, 3.694750452858447*^9}, {
   3.694750488670856*^9, 3.694750489002677*^9}, {3.694867254082062*^9, 
   3.694867263601419*^9}, {3.694867304856*^9, 3.694867377955138*^9}, {
   3.694869303294401*^9, 3.694869303681827*^9}, {3.695012756210307*^9, 
   3.695012787721487*^9}, {3.695015325158003*^9, 3.6950153272527857`*^9}, {
   3.695472791675076*^9, 3.695472792506543*^9}, {3.69632493626849*^9, 
   3.696324942298305*^9}, {3.696328715274459*^9, 3.696328717343588*^9}, {
   3.696338716521885*^9, 3.696338718506015*^9}, {3.696339975706653*^9, 
   3.696339977782195*^9}, {3.6965866771790953`*^9, 3.696586681555154*^9}, {
   3.6965871060673513`*^9, 3.69658710803463*^9}, {3.6967570003141003`*^9, 
   3.6967570025110073`*^9}, {3.696757037488596*^9, 3.696757038426887*^9}, {
   3.696757081268689*^9, 3.696757084090412*^9}, {3.696847212611784*^9, 
   3.696847217213305*^9}, 3.6968486308784237`*^9, {3.696928292444233*^9, 
   3.69692829455232*^9}, {3.6969305080442944`*^9, 3.696930510915001*^9}, {
   3.6969312500238113`*^9, 3.696931250181245*^9}, {3.696933465644796*^9, 
   3.696933467679583*^9}, {3.697776965330315*^9, 3.69777696748818*^9}, {
   3.697777533477244*^9, 3.697777533687099*^9}, {3.69777822083049*^9, 
   3.6977782209527683`*^9}, {3.6983800935219803`*^9, 3.698380142800619*^9}, {
   3.698380200092586*^9, 3.698380212224663*^9}, {3.698734275750132*^9, 
   3.698734279401188*^9}, 3.700018070341447*^9, {3.715936183451766*^9, 
   3.715936189051949*^9}, 3.715936221521611*^9, {3.7167034115272827`*^9, 
   3.7167034240933104`*^9}, {3.717314706633568*^9, 3.717314717412601*^9}, {
   3.719164663466783*^9, 3.719164668908475*^9}, {3.719164829339843*^9, 
   3.71916484639606*^9}, {3.71916496546945*^9, 3.7191649702619123`*^9}, {
   3.719165124203198*^9, 3.719165124483288*^9}, {3.71916520432227*^9, 
   3.719165214229258*^9}, {3.7191653005252647`*^9, 3.719165300657933*^9}, {
   3.719165395106965*^9, 3.719165395234828*^9}, {3.7191655397619543`*^9, 
   3.719165540317767*^9}, {3.719165674855405*^9, 3.719165680597529*^9}, {
   3.719165902931041*^9, 3.7191659049320097`*^9}, 3.719208283127981*^9, {
   3.720249048261566*^9, 3.720249062198172*^9}, {3.720267008087366*^9, 
   3.720267030535912*^9}, {3.720267376373246*^9, 3.720267385363535*^9}, {
   3.7202690907144623`*^9, 3.720269093678475*^9}, 3.722261142021186*^9, 
   3.722261259216363*^9, {3.7247576220868692`*^9, 3.724757683100952*^9}, {
   3.724925175472443*^9, 3.724925199292109*^9}, {3.725023864380587*^9, 
   3.72502386477339*^9}, {3.7250239506152477`*^9, 3.725023951038744*^9}, {
   3.725257705920218*^9, 3.725257706401054*^9}, {3.725258218938532*^9, 
   3.725258219308012*^9}, {3.725258261081778*^9, 3.7252582612282*^9}, {
   3.725368114069293*^9, 3.7253681353476458`*^9}},
 CellLabel->
  "In[883]:=",ExpressionUUID->"7aa32139-949f-4328-8e6d-40518a62c2f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fWM", "=", 
    RowBox[{"3.7058", "/", "2"}]}], 
   RowBox[{"(*", "1.853", "*)"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Weak", " ", "magnetism", " ", "see", " ", "1212.0332"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"radiusproton", "=", 
    RowBox[{"0.841", "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "15"}]}], " ", "meter"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"(", 
    RowBox[{"arXiv", ":", "1212.0332"}], ")"}], "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693923220822422*^9, 3.693923249726046*^9}, {
   3.693923577955722*^9, 3.6939236348981752`*^9}, {3.693926237161207*^9, 
   3.69392624238977*^9}, 3.693930720120225*^9, {3.693990669647138*^9, 
   3.693990672366892*^9}, {3.6939933943713837`*^9, 3.693993395666225*^9}, {
   3.694264548901173*^9, 3.694264549817799*^9}, {3.6942645825140753`*^9, 
   3.694264598485705*^9}, {3.6947504224215107`*^9, 3.694750452858447*^9}, {
   3.694750488670856*^9, 3.694750489002677*^9}, {3.694867254082062*^9, 
   3.694867263601419*^9}, {3.694867304856*^9, 3.694867377955138*^9}, {
   3.694869303294401*^9, 3.694869303681827*^9}, {3.695012756210307*^9, 
   3.695012787721487*^9}, {3.695015325158003*^9, 3.6950153272527857`*^9}, {
   3.695472791675076*^9, 3.695472792506543*^9}, {3.69632493626849*^9, 
   3.696324942298305*^9}, {3.696328715274459*^9, 3.696328717343588*^9}, {
   3.696338716521885*^9, 3.696338718506015*^9}, {3.696339975706653*^9, 
   3.696339977782195*^9}, {3.6965866771790953`*^9, 3.696586681555154*^9}, {
   3.6965871060673513`*^9, 3.69658710803463*^9}, {3.6967570003141003`*^9, 
   3.6967570025110073`*^9}, {3.696757037488596*^9, 3.696757038426887*^9}, {
   3.696757081268689*^9, 3.696757084090412*^9}, {3.696847212611784*^9, 
   3.696847217213305*^9}, 3.6968486308784237`*^9, {3.696928292444233*^9, 
   3.69692829455232*^9}, {3.6969305080442944`*^9, 3.696930510915001*^9}, {
   3.6969312500238113`*^9, 3.696931250181245*^9}, {3.696933465644796*^9, 
   3.696933467679583*^9}, {3.697776965330315*^9, 3.69777696748818*^9}, {
   3.697777533477244*^9, 3.697777533687099*^9}, {3.69777822083049*^9, 
   3.6977782209527683`*^9}, {3.6983800935219803`*^9, 3.698380142800619*^9}, {
   3.698380200092586*^9, 3.698380212224663*^9}, {3.698734275750132*^9, 
   3.698734279401188*^9}, 3.700018070341447*^9, {3.715936183451766*^9, 
   3.715936189051949*^9}, 3.715936221521611*^9, 3.716542438473713*^9, {
   3.71731584610433*^9, 3.7173158708317327`*^9}, {3.717867214027203*^9, 
   3.717867283677396*^9}, {3.7183448107281103`*^9, 3.71834481111875*^9}, {
   3.7183462863611603`*^9, 3.7183462864797792`*^9}, {3.718528432232049*^9, 
   3.718528432455831*^9}, {3.7185286495078773`*^9, 3.7185286496145277`*^9}, {
   3.720530393837102*^9, 3.7205304128326273`*^9}, {3.7205314017539997`*^9, 
   3.720531401987769*^9}, {3.720531976803669*^9, 3.720531976937608*^9}, 
   3.7222611216238947`*^9, {3.725258743703373*^9, 3.725258743988019*^9}, {
   3.725258811926053*^9, 3.725258812046845*^9}, {3.725259116262991*^9, 
   3.725259116539555*^9}, {3.725259593483186*^9, 3.7252595936066923`*^9}, 
   3.772874120408123*^9},
 CellLabel->
  "In[886]:=",ExpressionUUID->"68be6e2a-4928-4b2e-9f55-68f65075498d"],

Cell[TextData[{
 Cell[BoxData["fWM"],
  InitializationCell->True,
  CellChangeTimes->{{3.693923220822422*^9, 3.693923249726046*^9}, {
    3.693923577955722*^9, 3.6939236348981752`*^9}, {3.693926237161207*^9, 
    3.69392624238977*^9}, 3.693930720120225*^9, {3.693990669647138*^9, 
    3.693990672366892*^9}, {3.6939933943713837`*^9, 3.693993395666225*^9}, {
    3.694264548901173*^9, 3.694264549817799*^9}, {3.6942645825140753`*^9, 
    3.694264598485705*^9}, {3.6947504224215107`*^9, 3.694750452858447*^9}, {
    3.694750488670856*^9, 3.694750489002677*^9}, {3.694867254082062*^9, 
    3.694867263601419*^9}, {3.694867304856*^9, 3.694867377955138*^9}, {
    3.694869303294401*^9, 3.694869303681827*^9}, {3.695012756210307*^9, 
    3.695012787721487*^9}, {3.695015325158003*^9, 3.6950153272527857`*^9}, {
    3.695472791675076*^9, 3.695472792506543*^9}, {3.69632493626849*^9, 
    3.696324942298305*^9}, {3.696328715274459*^9, 3.696328717343588*^9}, {
    3.696338716521885*^9, 3.696338718506015*^9}, {3.696339975706653*^9, 
    3.696339977782195*^9}, {3.6965866771790953`*^9, 3.696586681555154*^9}, {
    3.6965871060673513`*^9, 3.69658710803463*^9}, {3.6967570003141003`*^9, 
    3.6967570025110073`*^9}, {3.696757037488596*^9, 3.696757038426887*^9}, {
    3.696757081268689*^9, 3.696757084090412*^9}, {3.696847212611784*^9, 
    3.696847217213305*^9}, 3.6968486308784237`*^9, {3.696928292444233*^9, 
    3.69692829455232*^9}, {3.6969305080442944`*^9, 3.696930510915001*^9}, {
    3.6969312500238113`*^9, 3.696931250181245*^9}, {3.696933465644796*^9, 
    3.696933467679583*^9}, {3.697776965330315*^9, 3.69777696748818*^9}, {
    3.697777533477244*^9, 3.697777533687099*^9}, {3.69777822083049*^9, 
    3.6977782209527683`*^9}, {3.6983800935219803`*^9, 3.698380142800619*^9}, {
    3.698380200092586*^9, 3.698380212224663*^9}, {3.698734275750132*^9, 
    3.698734279401188*^9}, 3.700018070341447*^9, {3.715936183451766*^9, 
    3.715936189051949*^9}, 3.715936221521611*^9},ExpressionUUID->
  "6cec64ba-526f-4161-94a1-1e1fdd959366"],
 " is the weak magnetism constant.  See Eq. [Horowitz&Li] for definition with \
the value given by its Table 1. \nNote that all expression in [Seckel 1993] \
seem to have a factor 2 difference. That is all interaction rates involving \
the weak magnetism in [Seckel 1993] are underestimated by a factor 2. \
Expressions in [Lopez et al. 1997] seem correct however."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.693923220822422*^9, 3.693923249726046*^9}, {
   3.693923577955722*^9, 3.6939236348981752`*^9}, {3.693926237161207*^9, 
   3.69392624238977*^9}, 3.693930720120225*^9, {3.693990669647138*^9, 
   3.693990672366892*^9}, {3.6939933943713837`*^9, 3.693993395666225*^9}, {
   3.694264548901173*^9, 3.694264549817799*^9}, {3.6942645825140753`*^9, 
   3.694264598485705*^9}, {3.6947504224215107`*^9, 3.694750452858447*^9}, {
   3.694750488670856*^9, 3.694750489002677*^9}, {3.694867254082062*^9, 
   3.694867263601419*^9}, {3.694867304856*^9, 3.694867377955138*^9}, {
   3.694869303294401*^9, 3.694869303681827*^9}, {3.695012756210307*^9, 
   3.695012787721487*^9}, {3.695015325158003*^9, 3.6950153272527857`*^9}, {
   3.695472791675076*^9, 3.695472792506543*^9}, {3.69632493626849*^9, 
   3.696324942298305*^9}, {3.696328715274459*^9, 3.696328717343588*^9}, {
   3.696338716521885*^9, 3.696338718506015*^9}, {3.696339975706653*^9, 
   3.696339977782195*^9}, {3.6965866771790953`*^9, 3.696586681555154*^9}, {
   3.6965871060673513`*^9, 3.69658710803463*^9}, {3.6967570003141003`*^9, 
   3.6967570025110073`*^9}, {3.696757037488596*^9, 3.696757038426887*^9}, {
   3.696757081268689*^9, 3.696757084090412*^9}, {3.696847212611784*^9, 
   3.696847217213305*^9}, 3.6968486308784237`*^9, {3.696928292444233*^9, 
   3.69692829455232*^9}, {3.6969305080442944`*^9, 3.696930510915001*^9}, {
   3.6969312500238113`*^9, 3.696931250181245*^9}, {3.696933465644796*^9, 
   3.696933467679583*^9}, {3.697776965330315*^9, 3.69777696748818*^9}, {
   3.697777533477244*^9, 3.697777533687099*^9}, {3.69777822083049*^9, 
   3.6977782209527683`*^9}, {3.6983800935219803`*^9, 3.698380142800619*^9}, {
   3.698380200092586*^9, 3.698380207865015*^9}, {3.698380692576619*^9, 
   3.69838069276925*^9}, {3.698380886393242*^9, 3.698380983122994*^9}, {
   3.698381261611141*^9, 3.698381283165682*^9}, {3.698381444277872*^9, 
   3.6983814560544043`*^9}, 3.715934614679022*^9, {3.715936278903503*^9, 
   3.715936288535241*^9}, 3.718690607612535*^9, {3.7222611235924788`*^9, 
   3.722261123592503*^9}},ExpressionUUID->"e121256a-1a97-4cf3-8fa1-\
61014616f777"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]FS", "=", 
    RowBox[{"1", "/", "137.03599911"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Fine", " ", "structure", " ", "constant"}], " ", "=", 
    RowBox[{
     SuperscriptBox["e", "2"], "/", 
     RowBox[{"(", 
      RowBox[{"4", "\[Pi]"}], ")"}]}]}], " ", "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.694797263847761*^9, 3.694797271089209*^9}, {
   3.6947973065481453`*^9, 3.694797307855529*^9}, 3.6947976475370283`*^9, {
   3.696318506283635*^9, 3.696318511263999*^9}, {3.6963197995043592`*^9, 
   3.696319800141852*^9}, {3.6963279967679*^9, 3.696327997855742*^9}, {
   3.696337988249494*^9, 3.69633798879922*^9}, {3.696338035949452*^9, 
   3.696338038488804*^9}, {3.696340916073756*^9, 3.69634091677864*^9}, {
   3.698380089607482*^9, 3.6983801232609463`*^9}, 3.700019026305037*^9},
 CellLabel->
  "In[888]:=",ExpressionUUID->"d86a4c70-2445-4ad9-aee2-77269380bb5c"],

Cell["Particle masses", "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{{3.715936445488145*^9, 3.715936448106606*^9}, {
  3.716369257655761*^9, 3.716369259952797*^9}},
 FontSize->16,ExpressionUUID->"92798007-f153-468c-96cc-15dd5bd833af"],

Cell[BoxData[
 RowBox[{"Throughout", ",", " ", 
  RowBox[{"masses", " ", "stand", " ", "always", " ", "for", " ", 
   SuperscriptBox["mc", "2"], " ", "so", " ", "that", " ", "they", " ", "are",
    " ", "in", " ", "fact", " ", 
   RowBox[{"energies", ".", " ", "This"}], " ", "avoids", " ", "putting", " ",
    "unnecessary", " ", 
   SuperscriptBox["c", "2"], " ", "factors"}]}]], "Text",
 InitializationCell->True,
 CellChangeTimes->{
  3.694750261860407*^9, {3.715936321384738*^9, 3.715936341443548*^9}},
 FontFamily->"Arial",ExpressionUUID->"ce9153e3-7ae0-4862-9ee2-b7d0ad9bbf17"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"me", "=", 
    RowBox[{"0.510998918", " ", "MeV"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mn", "=", 
   RowBox[{"939.565360", " ", "MeV"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mp", "=", 
    RowBox[{"938.272029", " ", "MeV"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Q", "=", 
    RowBox[{"mn", "-", "mp"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Mass", " ", "difference", " ", "between", " ", "neutrons", " ", "and", 
    " ", "protons"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["m", "Nucleon"], "=", "mn"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["m", "W"], "=", 
    RowBox[{"80.385", " ", "GeV"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Mass", " ", "of", " ", "the", " ", "W", " ", 
    RowBox[{"Boson", "."}]}], " ", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["m", "Z"], "=", 
   RowBox[{"91.1876", " ", "GeV"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693923260376031*^9, 3.693923261617861*^9}, {
   3.693923369707652*^9, 3.693923375874906*^9}, {3.693923500490201*^9, 
   3.693923503198977*^9}, {3.693926209891636*^9, 3.693926215858143*^9}, 
   3.693930710383514*^9, {3.6939933894207478`*^9, 3.693993397668519*^9}, {
   3.69400613830464*^9, 3.694006174439643*^9}, {3.694006228060959*^9, 
   3.694006251674499*^9}, {3.6940063660268307`*^9, 3.694006368124262*^9}, {
   3.694006459289083*^9, 3.694006462018107*^9}, {3.694062951265053*^9, 
   3.69406296282859*^9}, {3.694264422349885*^9, 3.694264449675281*^9}, {
   3.694264485336725*^9, 3.694264485760111*^9}, {3.694750255974249*^9, 
   3.694750286363763*^9}, {3.695012795787854*^9, 3.695012797122695*^9}, {
   3.6950192190592823`*^9, 3.6950192380222473`*^9}, {3.69633213472955*^9, 
   3.696332151840399*^9}, {3.6963322442649803`*^9, 3.6963322448413982`*^9}, {
   3.696332299735208*^9, 3.6963323000264807`*^9}, {3.696565870422139*^9, 
   3.696565870656666*^9}, 3.698379440397401*^9, 3.6997727476305037`*^9, {
   3.699775573341443*^9, 3.699775575403845*^9}, {3.7159363709863253`*^9, 
   3.715936425165913*^9}, {3.716723513664488*^9, 3.716723543188222*^9}, {
   3.717581553635709*^9, 3.7175815547174263`*^9}, {3.725263669410983*^9, 
   3.725263676621472*^9}},
 CellLabel->
  "In[889]:=",ExpressionUUID->"fa14aca9-e004-4f1f-85e5-3f5a22912e21"],

Cell["Cosmology constants", "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{{3.7159364671148233`*^9, 3.715936497738949*^9}},
 FontSize->16,ExpressionUUID->"eb7e8293-e8bc-4cc0-b4ed-cc112d58370d"],

Cell["h is the Hubble rate in units of 100 km/s/Mpc.", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.694750466164312*^9, 3.694750505939653*^9}, {
  3.698379451381434*^9, 3.6983794522766857`*^9}, {3.715936493823441*^9, 
  3.715936495320258*^9}},ExpressionUUID->"6e77f860-cc16-47a9-b99d-\
61e40fbca22e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pc", "=", 
    RowBox[{"3.0856777807", " ", 
     SuperscriptBox["10", "16"], " ", "meter"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"The", " ", "parsec"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"Mpc", "=", 
   RowBox[{"Mega", " ", "pc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H0", "=", 
    RowBox[{"100", " ", "h", " ", 
     RowBox[{
      RowBox[{"km", "/", "second"}], "/", "Mpc"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Hubble", " ", "constant", " ", "today"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H100", "=", 
    RowBox[{"100", " ", 
     RowBox[{
      RowBox[{"km", "/", "second"}], "/", "Mpc"}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Fake", " ", "Hubble", " ", "rate", " ", "given", " ", "by", " ", "100", 
     " ", 
     RowBox[{
      RowBox[{"km", "/", "s"}], "/", "Mpc"}], " ", "so", " ", "that", " ", 
     "h"}], " ", "=", " ", 
    RowBox[{"H0", "/", "H100"}]}], " ", "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693925617589733*^9, 3.693925665582253*^9}, {
  3.694264129460785*^9, 3.6942641351705837`*^9}, {3.694750444586356*^9, 
  3.694750445127878*^9}, {3.694750510489819*^9, 3.694750511723637*^9}, {
  3.6983794601699877`*^9, 3.698379485733511*^9}, {3.7000186530765944`*^9, 
  3.700018661428969*^9}, {3.715936503172858*^9, 3.715936570942239*^9}},
 CellLabel->
  "In[896]:=",ExpressionUUID->"d1d595b7-f1ac-4227-9846-64a20efad353"],

Cell["\<\
We define two critical densities. One for the actual Hubble rate, and one for \
the rate at 100km/s/Mpc.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.694750516314451*^9, 
  3.694750551851091*^9}},ExpressionUUID->"be56230d-fea1-42bb-99f1-\
c376b9383c4b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Rho]", "crit"], "=", 
    RowBox[{
     FractionBox["3.", 
      RowBox[{"8", "\[Pi]", " ", "GN"}]], 
     SuperscriptBox[
      RowBox[{"(", "H0", ")"}], "2"]}]}], " ", ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"in", " ", "g", " ", 
    SuperscriptBox["cm", 
     RowBox[{"-", "3"}]], " ", "by", " ", "construction"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]crit100", "=", 
    RowBox[{
     FractionBox["3.", 
      RowBox[{"8", "\[Pi]", " ", "GN"}]], 
     SuperscriptBox[
      RowBox[{"(", "H100", ")"}], "2"]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"in", " ", "g", " ", 
    SuperscriptBox["cm", 
     RowBox[{"-", "3"}]], " ", "by", " ", "construction"}], " ", 
   "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693925795781331*^9, 3.6939258015660954`*^9}, {
   3.6939258546917067`*^9, 3.693925858739133*^9}, {3.693925988036828*^9, 
   3.693926005969474*^9}, {3.693926119262619*^9, 3.693926124738615*^9}, {
   3.69392628147187*^9, 3.693926296464093*^9}, {3.694264143090674*^9, 
   3.694264150077724*^9}, {3.695015352684407*^9, 3.695015373120964*^9}, 
   3.6997778069258823`*^9, {3.700018071386217*^9, 3.700018072037242*^9}, {
   3.700018653054071*^9, 3.700018661432781*^9}, {3.700039225571054*^9, 
   3.7000392275398197`*^9}, {3.772874153508987*^9, 3.772874155135419*^9}},
 CellLabel->
  "In[900]:=",ExpressionUUID->"069349e2-12e2-4d7c-9624-d49c8c262669"],

Cell["Neutron life time (Particle Data Group 2017).", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.694750563728033*^9, 3.6947505702755537`*^9}, {
  3.6965658813774633`*^9, 3.6965658935775948`*^9}, {3.698379509715267*^9, 
  3.698379510206923*^9}, {3.715936589001328*^9, 3.715936590415827*^9}, {
  3.7198911463834543`*^9, 
  3.719891151888564*^9}},ExpressionUUID->"52254313-2c55-4945-b441-\
cc323d6ebb1c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Mean\[Tau]neutron", ":=", "879.5"}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"880.2", "second"}], "+", 
     RowBox[{
      RowBox[{"-", "1.1"}], "s", " ", "was", " ", "previous", " ", "value", 
      " ", "from", " ", "PDG2017"}]}], " ", "*)"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Now", " ", "we", " ", "use", " ", "1712.05663", " ", "Section", " ", "11",
     " ", "which", " ", "includes", " ", "recente", " ", "2017", " ", 
    RowBox[{"measurements", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]\[Tau]neutron", ":=", 
   RowBox[{"0.8", " ", "second"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]neutron", "=", "Mean\[Tau]neutron"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.694007319498481*^9, 3.694007324051613*^9}, {
   3.694007370946267*^9, 3.6940073732377777`*^9}, 3.6940074205451403`*^9, {
   3.694252401647462*^9, 3.694252405842175*^9}, {3.700828461847847*^9, 
   3.700828465399629*^9}, {3.700830134146164*^9, 3.700830136720793*^9}, {
   3.713766756424307*^9, 3.713766756686467*^9}, 3.715936594769825*^9, {
   3.71794449397731*^9, 3.7179444948613443`*^9}, {3.7179460852859097`*^9, 
   3.717946085900929*^9}, {3.7186161344164953`*^9, 3.7186161357568007`*^9}, {
   3.718616402772394*^9, 3.718616403693387*^9}, {3.7190583081133204`*^9, 
   3.719058309087386*^9}, {3.71905877999292*^9, 3.719058780660181*^9}, {
   3.719063474935317*^9, 3.7190634765498953`*^9}, {3.7190636365648937`*^9, 
   3.7190636372068863`*^9}, {3.7191154870232267`*^9, 3.719115492150668*^9}, 
   3.7191185066851683`*^9, {3.719118935391531*^9, 3.719118936355598*^9}, {
   3.719850750083679*^9, 3.719850762132626*^9}, {3.719891059339814*^9, 
   3.71989108540561*^9}, {3.7198911235585203`*^9, 3.719891123560762*^9}, {
   3.719897313444852*^9, 3.7198973201150084`*^9}, 3.719897613505631*^9, {
   3.719898071897002*^9, 3.719898075809095*^9}, {3.719898128217814*^9, 
   3.719898136471595*^9}, {3.720455875065995*^9, 3.72045587526683*^9}, {
   3.724760218226038*^9, 3.724760268750722*^9}, {3.7250238768692627`*^9, 
   3.725023878520499*^9}, {3.725023937991943*^9, 3.725023939855681*^9}, {
   3.725254390776483*^9, 3.725254392275112*^9}, {3.725254692958272*^9, 
   3.725254722338711*^9}, {3.725258286322378*^9, 3.72525829071138*^9}, {
   3.7252587027742653`*^9, 3.7252587051740513`*^9}, {3.72536528342351*^9, 
   3.725365308156328*^9}, {3.72536815040213*^9, 3.7253681659656963`*^9}, 
   3.772874161554386*^9},
 CellLabel->
  "In[902]:=",ExpressionUUID->"117e85d4-5807-49ab-a7f8-774cf4f53d39"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cosmological Parameters", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.69392305952987*^9, 3.693923065277337*^9}, {
  3.694264606985589*^9, 3.6942646081271057`*^9}, {3.6983795219889603`*^9, 
  3.698379523393656*^9}},ExpressionUUID->"aa1b8520-b11e-4357-a3ec-\
964079b564bb"],

Cell["\<\
Neutrinos generations and possible neutrino degeneracy (neutrino chemical \
potential).\
\>", "Text",
 CellChangeTimes->{{3.7198123234977407`*^9, 3.719812330443225*^9}, {
  3.722683898069311*^9, 
  3.722683909229216*^9}},ExpressionUUID->"b63a093e-c3d0-4b46-aa6f-\
612d10b4efd8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NeutrinosGenerations", ":=", "3."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Xi]\[Nu]", ":=", 
   RowBox[{"If", "[", 
    RowBox[{"$DegenerateNeutrinos", ",", "\[Mu]OverT\[Nu]", ",", "0"}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[905]:=",ExpressionUUID->"977058ec-d41e-47d4-9d2b-d7ee5e6cf9ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]FD", "[", "c_", "]"}], "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", 
      SuperscriptBox["\[Pi]", "2"]}]], 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "Infinity"], 
     RowBox[{
      FractionBox[
       SuperscriptBox["y", "3"], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"y", "-", "c"}]], "+", "1"}], ")"}]], 
      RowBox[{"\[DifferentialD]", "y"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nFD", "[", "c_", "]"}], "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", 
      SuperscriptBox["\[Pi]", "2"]}]], 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "Infinity"], 
     RowBox[{
      FractionBox[
       SuperscriptBox["y", "2"], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"y", "-", "c"}]], "+", "1"}], ")"}]], 
      RowBox[{"\[DifferentialD]", "y"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]FDNonDegenerate", "=", 
   RowBox[{"\[Rho]FD", "[", "0", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.719810734101269*^9, 3.7198107471472273`*^9}, {
  3.719810815158649*^9, 3.71981082002866*^9}, {3.719811098574154*^9, 
  3.71981129102695*^9}, {3.719814610298039*^9, 3.719814614720055*^9}, {
  3.719814801540749*^9, 3.719814803102343*^9}},
 CellLabel->
  "In[907]:=",ExpressionUUID->"5ad1d76e-a27d-43e1-b9d5-ef8f3a18a8c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "Effective", " ", "number", " ", "of", " ", "neutrinos", " ", "generation", 
   " ", "due", " ", "to", " ", "chemical", " ", "potential"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"(", 
  RowBox[{"this", " ", "is", " ", "different", " ", "from", " ", 
   SubscriptBox["N", "eff"], " ", "which", " ", "takes", " ", "into", " ", 
   "account", " ", "also", " ", "QED", " ", "and", " ", "incomplete", " ", 
   "neutrino", " ", "decoupling"}], ")"}]}], "Text",
 CellChangeTimes->{{3.722332389439705*^9, 3.722332422380188*^9}, {
  3.722683978744707*^9, 3.722683995079027*^9}},
 FontFamily->"Arial",ExpressionUUID->"60681f89-cd1b-454f-894b-2ab99d60db98"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Nneu", ":=", 
   RowBox[{"NeutrinosGenerations", "*", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Rho]FD", "[", "\[Xi]\[Nu]", "]"}], "+", 
      RowBox[{"\[Rho]FD", "[", 
       RowBox[{"-", "\[Xi]\[Nu]"}], "]"}]}], 
     RowBox[{"2", "\[Rho]FDNonDegenerate"}]]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6939278177927303`*^9, 3.6939278388799*^9}, {
   3.69486555051721*^9, 3.69486555131546*^9}, {3.694865753014146*^9, 
   3.694865755101672*^9}, {3.694866259780467*^9, 3.6948662603700943`*^9}, {
   3.694866834018346*^9, 3.69486684792451*^9}, {3.69837954368004*^9, 
   3.6983795586950903`*^9}, 3.698438903024732*^9, {3.699989235615212*^9, 
   3.699989236178937*^9}, {3.699989384783066*^9, 3.69998938489108*^9}, 
   3.7000186394350567`*^9, {3.700039220891919*^9, 3.700039222490699*^9}, 
   3.715936603253501*^9, {3.719310659299971*^9, 3.719310660272794*^9}, {
   3.7193114717773943`*^9, 3.719311472338099*^9}, {3.7193122419500093`*^9, 
   3.7193122423634577`*^9}, {3.7198113013963327`*^9, 3.719811322114861*^9}, {
   3.71981143463351*^9, 3.719811435205289*^9}, 3.719812317670678*^9, {
   3.719813990824696*^9, 3.7198139936986856`*^9}, {3.72269463512318*^9, 
   3.722694635127256*^9}, {3.772778975697925*^9, 3.7727789866092577`*^9}, {
   3.772874204162088*^9, 3.7728742046406727`*^9}},
 CellLabel->
  "In[910]:=",ExpressionUUID->"a5157e2f-a042-4ccc-be36-d93c5ef24f7d"],

Cell["CMB temperature today", "Text",
 CellChangeTimes->{{3.71981239548771*^9, 
  3.71981241624485*^9}},ExpressionUUID->"9ff5eacb-4cc1-4444-95b3-\
ba7c78f2a575"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TCMB0", ":=", 
   RowBox[{"2.7255", "Kelvin"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]TCMB0", ":=", 
    RowBox[{"0.0006", " ", "Kelvin"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"[", 
    RowBox[{"Planck", " ", "2015", " ", "XIII"}], "]"}], " ", 
   "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693923077363378*^9, 3.693923141525693*^9}, 
   3.693926580369294*^9, {3.693926742560523*^9, 3.69392674347363*^9}, {
   3.693926947201304*^9, 3.693926955730639*^9}, {3.693930631806753*^9, 
   3.6939306340296173`*^9}, {3.694007970634153*^9, 3.694007971578045*^9}, {
   3.694062908075718*^9, 3.694062928911628*^9}, {3.6942638628001328`*^9, 
   3.694263926498218*^9}, {3.694264063552062*^9, 3.694264064051815*^9}, {
   3.698039037223589*^9, 3.698039118295685*^9}, {3.6980436781277933`*^9, 
   3.6980436783290052`*^9}, 3.698379630622766*^9, {3.69843884518081*^9, 
   3.6984388459386*^9}, 3.698438917646599*^9, {3.719850802279497*^9, 
   3.7198508057847433`*^9}, {3.719891269160615*^9, 3.71989129357329*^9}},
 CellLabel->
  "In[911]:=",ExpressionUUID->"7e866660-f5ed-4269-8b06-a511fd00ced3"],

Cell["\<\
Temperature of CMB today in Kelvin. We consider the case where QED effects \
are ignored or taken into account. This is the implementation of (the inverse \
of) Eq. 56 in companion paper.\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"75c1409c-4969-4180-a00f-3d5148845d7e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FourOverElevenQED", ":=", 
   RowBox[{
    FractionBox["4", "11"], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{"25", " ", "\[Alpha]FS"}], 
       RowBox[{"22", "\[Pi]"}]]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FourOverElevenNoQED", ":=", 
   FractionBox["4", "11"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FourOverEleven", ":=", 
    RowBox[{"If", "[", 
     RowBox[{
     "$QEDPlasmaCorrections", ",", "FourOverElevenQED", ",", 
      "FourOverElevenNoQED"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T\[Nu]0", "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", "FourOverEleven", ")"}], 
     RowBox[{"1", "/", "3"}]], "TCMB0"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693923077363378*^9, 3.693923141525693*^9}, 
   3.693926580369294*^9, {3.693926742560523*^9, 3.69392674347363*^9}, {
   3.693926947201304*^9, 3.693926955730639*^9}, {3.693930631806753*^9, 
   3.6939306340296173`*^9}, {3.694007970634153*^9, 3.694007971578045*^9}, {
   3.694062908075718*^9, 3.694062928911628*^9}, {3.6942638628001328`*^9, 
   3.694263926498218*^9}, {3.694264063552062*^9, 3.694264064051815*^9}, {
   3.698039037223589*^9, 3.698039118295685*^9}, {3.6980436781277933`*^9, 
   3.6980436783290052`*^9}, {3.698379630622766*^9, 3.698379650442213*^9}, {
   3.698381473515275*^9, 3.698381473684519*^9}, 3.698438920568984*^9, 
   3.7000190263131857`*^9, {3.716025467940936*^9, 3.716025471933064*^9}, {
   3.718443827382544*^9, 3.71844386496371*^9}},
 CellLabel->
  "In[913]:=",ExpressionUUID->"eb4ea9b3-8370-4d00-93c9-a3f4e1d1fa02"],

Cell[TextData[{
 "Temperature of neutrinos today is lower than photons because they decoupled \
earlier and electron/positron annihilation has only reheated photons. This \
leads to the famous ratio of 4/11 between the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["T", "3"], " ", "of", " ", "the", " ", "neutrinos", " ", 
    "and", " ", 
    RowBox[{"photons", "."}]}], TraditionalForm]],ExpressionUUID->
  "4e3b0c92-8647-46b8-8bfb-a6557c7e53e8"],
 " However, since decoupling is slightly incomplete, this in principle should \
be corrected like in [Mangano et al. 2005] or [Grohs et al. 2012]. \n\n\
Additionally, there is another source of modification to this 4/11 ratio \
which comes from the QED corrections to the plasma thermodynamic quantities \
(modification of pressure and energy density and thus of entropy). Taking the \
high temperature modification leads to the correction added above in the \
variable ",
 StyleBox["FourOverEleven. ",
  FontFamily->"Times"],
 "See e.g. Eq. 41 of [Lopez&Turner 1998] and/or the companion paper (Eq. 56). \
The effect of incomplete neutrino decoupling is considered further below."
}], "Text",
 InitializationCell->
  True,ExpressionUUID->"b72ad87a-4d11-4717-af22-f5488988c9d0"],

Cell["Hubble rate in units of 100 km/s/Mpc.", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.694750599184182*^9, 3.694750610350415*^9}, 
   3.698381487799547*^9},ExpressionUUID->"2420f904-b01d-41d2-afc5-\
92659a65cfe9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"h", ":=", "0.6727"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"+", 
    RowBox[{"-", "0.0066"}]}], " ", "*)"}], 
  RowBox[{"(*", 
   RowBox[{"[", 
    RowBox[{"Planck", " ", "2015", " ", "XIII"}], "]"}], "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693925746347927*^9, 3.69392578361104*^9}, {
   3.69392658817782*^9, 3.6939265883387337`*^9}, {3.6939269787330427`*^9, 
   3.693926979360106*^9}, {3.694252149557715*^9, 3.69425215062607*^9}, 
   3.694750593302685*^9, 3.698438935322433*^9, {3.71593671397374*^9, 
   3.7159367248753157`*^9}, {3.719891237946465*^9, 3.719891246866857*^9}, {
   3.720155591105739*^9, 3.72015561097861*^9}, {3.720495160995268*^9, 
   3.7204951734800663`*^9}},
 CellLabel->
  "In[917]:=",ExpressionUUID->"7cd98e4a-a313-4252-a61d-f88d187f729d"],

Cell["Cold Dark Matter density parameter,", "Text",
 CellChangeTimes->{{3.772874531928227*^9, 
  3.772874544733276*^9}},ExpressionUUID->"97291d97-453b-49d5-8c32-\
b727a0dd1e2f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Meanh2\[CapitalOmega]c0", "=", "0.1198"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"[", 
    RowBox[{"Planck", " ", "2015", " ", "XIII"}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]h2\[CapitalOmega]c0", "=", "0.0015"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h2\[CapitalOmega]c0", "=", "Meanh2\[CapitalOmega]c0"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.721364112991704*^9, 3.7213641556163273`*^9}, {
  3.721364397941206*^9, 3.721364422655567*^9}},
 CellLabel->
  "In[918]:=",ExpressionUUID->"c126d17c-91be-4d13-8587-02c29a846222"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Density of photons and neutrinos", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.69426114303646*^9, 3.6942611464325237`*^9}, {
  3.694263929215026*^9, 3.6942639304736156`*^9}, {3.694750860699705*^9, 
  3.694750866580652*^9}, {3.70038984936861*^9, 
  3.700389857152976*^9}},ExpressionUUID->"75bc1380-6397-4363-acf9-\
cae5475d916d"],

Cell["The Black Body constant is defined as", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6947506823691998`*^9, 
  3.694750694469746*^9}},ExpressionUUID->"26563769-5afb-4f1f-a00a-\
d16f09b196fb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"aBB", "=", 
  FractionBox[
   SuperscriptBox["\[Pi]", "2"], 
   RowBox[{"15", " ", 
    SuperscriptBox["hbar", "3"], 
    SuperscriptBox[
     RowBox[{"(", "clight", ")"}], "5"]}]], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.69392882460056*^9, 3.69392891432789*^9}, {
   3.693928972087034*^9, 3.693929040138241*^9}, {3.693930493352439*^9, 
   3.693930495309888*^9}, 3.694750697316946*^9, 3.700018369897241*^9, 
   3.700018689814373*^9},
 CellLabel->
  "In[921]:=",ExpressionUUID->"3acb21ce-8991-4b90-a57b-2d0178678e4e"],

Cell[BoxData["2.316736294723692`*^28"], "Output",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzVtIk3EABfBtWpqNZTFty2XN4YtLYV0ka04+CwdlTjfaTOaaA0eUtAWS
wbdguQx1Ulgxls2aOlyIN8SHLgPHwjHGRLTInNEFh4J8RlagCGb/48Ph93IO
R2yyqOvZLBariuTXqOoGI2Co9ZrrP+RChnq+j5alHmIogyLK5xKzc57a4HhP
aTA1i6FecrwLp4izSiqtkOjrmpLC3w1KC5x9pXHAyTeHZUXEzZ+eWzDN422B
/UOBOXg7VJZ0hrjgs0vgdE16EbQuf7dBp9NqvkJcycjrgBce8mPw/Yv7X6Fv
rU+lJ8arRxIwMHdsA7ozzgtqiRum7ehVYpv/RAImCYJ7jcT0B/tFcCAvXFxH
5DuKdbC7/u8EDPrVMzAs3FPAFjGU/KSqFG6VbM1DxkGvwreLvBQOMaHX5MDl
m/NSyM2NH4fWkW4FPNCqPgcnpWEl7HiiuATZJTwN1HZSBhj598cMv1xmW+Dg
NVETbKgtuAebm1ztMFtif7TTr6BdMPljlQd29eh7d3ahZj/sdbcOQl1l+Rhs
cRnewbNCXmwXMfS5/RsciORuw0+n7Ud2E7OWGs0wLqqjYfmd/GfQW0avwaMH
3ZIUou21+CLkmguNcEy+eBeuDDsfw0yZsR+K10cDMNLHqdDiN/pBC2NCWxs0
LWV26oj/AWugFBI=
  "],
 CellLabel->
  "Out[921]=",ExpressionUUID->"a4c117e6-2a47-443a-a19c-db8335e5960c"]
}, Open  ]],

Cell["\<\
Energy density and number density of CMB today (See appendix A1 in companion \
paper)\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"e591b665-7f01-4b7a-b02b-cc457982cacc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Rho]", "CMB0"], ":=", 
    RowBox[{"aBB", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"kB", " ", "TCMB0"}], ")"}], "4"]}]}], " ", ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"in", " ", "g", " ", 
    SuperscriptBox["cm", 
     RowBox[{"-", "3"}]]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["n", "CMB0"], ":=", 
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"Zeta", "[", "3", "]"}]}], 
    RowBox[{
     SuperscriptBox["\[Pi]", "2"], 
     SuperscriptBox["hbar", "3"], 
     SuperscriptBox[
      RowBox[{"(", "clight", ")"}], "3"]}]], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"kB", " ", "TCMB0"}], ")"}], "3"]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693926846259387*^9, 3.693926874304302*^9}, {
   3.6939269356159487`*^9, 3.6939269609896812`*^9}, {3.6939272186268883`*^9, 
   3.6939272306157618`*^9}, {3.693927462566523*^9, 3.6939274811705227`*^9}, {
   3.693927626088758*^9, 3.6939276770637903`*^9}, 3.693929051941918*^9, {
   3.693930642931737*^9, 3.693930644758774*^9}, {3.694260559321546*^9, 
   3.694260573958054*^9}, {3.694260625769204*^9, 3.6942606661048727`*^9}, {
   3.694260829322421*^9, 3.6942608298302383`*^9}, 3.694260880976536*^9, 
   3.694260983027803*^9, 3.6942615093722553`*^9, {3.6984389446755447`*^9, 
   3.6984389471593857`*^9}, {3.6997729607604427`*^9, 3.6997729621651077`*^9}, 
   3.700018369905224*^9, 3.700018689819116*^9},
 CellLabel->
  "In[922]:=",ExpressionUUID->"c5c6a43d-0eea-4721-8bc9-594ed9333c22"],

Cell["\<\
We recover the number of photons per cubic centimeter (410) :\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698381595264773*^9, 3.698381615055772*^9}, {
  3.715936881363347*^9, 
  3.7159368872792664`*^9}},ExpressionUUID->"8fac4809-95f8-4aa5-ad77-\
3798ca8162cb"],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox["n", "CMB0"]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[924]:=",ExpressionUUID->"bbd3b1d9-cdd0-422e-8076-0887eacce247"],

Cell[BoxData["410.72677728839284`"], "Output",
 CellChangeTimes->CompressedData["
1:eJwdyV1IUwEchvGzqU2ssI/TZjXUtqDCjG2QtFrmaWaY22zTbRhtbnVaUdII
Ai+cg1xiDlEMWnlmMkoSUsSGd0UtlOhjXajDKPsSpkScooIyvHD93y4efhfP
tlN+2xkJwzBW6vgL6wWxQOTC0aZ5w2aRWyls1eZuEbnKudfsGjI4HQlA0xFT
IneryJ1VDs7tJc9PG/PKSMum2RIoOVTth5/NjhDMxFVaPZkSYpeg0Hi3HarH
Em+gufhi1n6S/3JVDUtlrB4u71wIwNTwZV8DufJsdxeUH1MkId/Z8RHWx4Zq
T5IDtfE0/N5k+gurblYVuMhBf/6rRtIwWpaGYvHEag/5y8YqIdM2c9BLdjyt
cEK7fOkJfLzDPQWHWXaPRClyM0nrYRiYz7yFvfeD32C5a6NMSvLddhUUT7wv
gT+sH3RQ+jJW/v9r7EZ4K/n8KDyn4MxwbHJdHexvqHTDSN6SD07Ks/1ww0Jh
M8xOa67A39K+MFysDvXAG/nBCHS56vuhKuy9A3WJ9iEoN3SNwPCsJQ6FHO9D
WKpdn8who0zPJ1j3blcGChNtRavg12YftBn5Fhi6pumDf1qCPyFbFFXLyOWp
7TXQLeg9cLxmsRWaHnRfh7p9p+9Bj2T8Eaw4kGVxkLf5lAM6E4FOuDaq6HWS
/wBQgAyE
  "],
 CellLabel->
  "Out[924]=",ExpressionUUID->"d9bb458d-f491-4fdd-8c39-3ff836c39554"]
}, Open  ]],

Cell["The fraction of energy content due to photons is simply", "Text",
 CellChangeTimes->{{3.715936911273622*^9, 
  3.715936924429003*^9}},ExpressionUUID->"942c6aa6-85dc-41d2-98a7-\
f806b65663fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalOmega]", "\[Gamma]0"], ":=", 
   RowBox[{
    SubscriptBox["\[Rho]", "CMB0"], "/", 
    SubscriptBox["\[Rho]", "crit"]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693927685130679*^9, 3.693927703556861*^9}, {
   3.693927745863163*^9, 3.693927775342533*^9}, {3.693927808595558*^9, 
   3.693927810415256*^9}, {3.6939278485273457`*^9, 3.693927851230754*^9}, 
   3.694062935801993*^9, 3.6980391805991793`*^9, 3.69843888703197*^9, 
   3.698438950333075*^9, 3.700018639440956*^9, 3.715936927837406*^9},
 CellLabel->
  "In[925]:=",ExpressionUUID->"5dabe352-99ef-459c-a307-ac26a4c32342"],

Cell["\<\
For neutrinos, we must take into account the temperature of neutrinos today, \
the number of neutrinos, and the fact that they are Fermions. 
See companion paper for details.\
\>", "Text",
 CellChangeTimes->{{3.715936929679759*^9, 3.7159369658601913`*^9}, {
  3.722684150050291*^9, 
  3.72268415592127*^9}},ExpressionUUID->"dc550510-17a0-4ed7-afbc-\
62f30a56b828"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalOmega]", "\[Nu]0"], ":=", 
   RowBox[{"Nneu", "*", 
    FractionBox["7", "8"], "*", 
    SuperscriptBox[
     RowBox[{"(", "FourOverEleven", ")"}], 
     RowBox[{"1", "/", "3"}]], 
    SubscriptBox["\[CapitalOmega]", "\[Gamma]0"]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.693927685130679*^9, 3.693927703556861*^9}, {
   3.693927745863163*^9, 3.693927775342533*^9}, {3.693927808595558*^9, 
   3.693927810415256*^9}, {3.6939278485273457`*^9, 3.693927851230754*^9}, 
   3.694062935801993*^9, 3.6980391805991793`*^9, 3.69843888703197*^9, 
   3.698438950333075*^9, 3.700018639440956*^9, 3.715936927837406*^9},
 CellLabel->
  "In[926]:=",ExpressionUUID->"1db81fb1-c74f-44aa-9afe-4d9bb0c74157"],

Cell["\<\
The contribution to the energy content is obtained by the ratio between \
energy densities and critical density. We check that today it is around 0.1%.\
\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698381635493601*^9, 3.698381658143738*^9}, {
  3.715936969864704*^9, 
  3.715936998585771*^9}},ExpressionUUID->"95fe0ddf-f769-408d-a339-\
b56cb9cd2a1e"],

Cell[CellGroupData[{

Cell[BoxData[
 FractionBox[
  RowBox[{
   SubscriptBox["\[CapitalOmega]", "\[Gamma]0"], 
   SuperscriptBox["h", "2"]}], "h2\[CapitalOmega]b0"]], "Input",
 CellChangeTimes->{{3.7083211797875967`*^9, 3.708321191787488*^9}, {
  3.722691581511693*^9, 3.722691611276656*^9}},
 CellLabel->
  "In[927]:=",ExpressionUUID->"66ce3f35-6c03-4292-bc56-76f14d335dd4"],

Cell[BoxData[
 FractionBox["0.000024728044243746322`", "h2\[CapitalOmega]b0"]], "Output",
 CellChangeTimes->CompressedData["
1:eJwdz2tIU3EYBvBpa1sqSnlbuqhmF0Lxrjhp4mmBNTGtyU5pblNzSk1PKiSl
IzwpujTKEd4aBmaLUX2pxCIpg1ihwxgZwQbbiiFsnYIEXYlh/8cPLz+eD88D
7/465kxDGI/HO02uZ4/6EifmqOqK9m9Hd3MUl3A9S5TEUQLGGRdFlBeMd0FR
tHZOlMxR33e+cufBYmVEPnGFcaXCSmMZA23Cqhvws/twloyYdPFhK9T8tfbC
sY/vv8KC6LZthcTiT6YU2OISy6CODXbBpXcd+nPEmF/5g3DHC4kDTo8MeKCr
+nn5eWKeatoP+1ndHxg5eFJcQxy9krOgJVrnZH7oLLJH6oh9hkQJTL8VlNdi
d0NBw0Dy+luocTc7oV17ID1MwlHX+iuPQYsv3AUvz7A/oTIULwwn2kO0FBpi
valw+YcvG/awU0XwYOCsAnr4jhI46jleBqd8sSoYMV+igRcer+vhy31CBt6d
kHbA8dWcbmhbvHcTroT6bkMF3T0MWzJoCzwR1TAJlUbTI3h14c4TqI5RPYOs
uf41rPDEObYTg7NDXvjgadomnDD17hWgP9CpF2zlpk5oOJQ7Bvkf2N+wsOl+
ipD4RnqkFEr9ch2s+hcwwvZVsxnydzVaodc6MwvXRPxTavyZ+UUNF21GE1yy
iIdo4n/gbBO0
  "],
 CellLabel->
  "Out[927]=",ExpressionUUID->"ae2e4de9-81a2-4dc2-b408-7dbc961a33f5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Distribution functions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.695399796918549*^9, 3.695399804547086*^9}, {
  3.6965665683483*^9, 
  3.696566568511149*^9}},ExpressionUUID->"205a59ac-1e4a-40ba-9e3b-\
907e6274a58b"],

Cell[TextData[{
 "Basic Fermi - Dirac (FD) and Bose - Einstein (BE) functions. x here ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["k", "B"], "T"}]}]}], TraditionalForm]],ExpressionUUID->
  "d39552cc-d2c0-4257-b162-7b85f07c7bbb"],
 "). "
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698381806780798*^9, 3.6983818155374413`*^9}, {
   3.715938426265527*^9, 3.715938486780675*^9}, {3.71593857567865*^9, 
   3.7159385808169727`*^9}, 3.7159386456188374`*^9, {3.722684697818555*^9, 
   3.722684709266008*^9}},ExpressionUUID->"7ff3ae13-0dab-445f-83a2-\
0ff24f742e74"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FD", "[", "EoverT_", "]"}], "=", 
    FractionBox["1", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Exp", "[", "EoverT", "]"}], "+", "1"}], ")"}]]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Fermi", " ", "Dirac", " ", "Distribution"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FD", "[", 
    RowBox[{"Energy_", ",", "x_"}], "]"}], "=", 
   FractionBox["1", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"x", " ", "Energy"}], "]"}], "+", "1"}], ")"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BE", "[", "EoverT_", "]"}], "=", 
    FractionBox["1", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Exp", "[", "EoverT", "]"}], "-", "1"}], ")"}]]}], ";"}], " ", 
  
  RowBox[{"(*", " ", 
   RowBox[{"Bose", " ", "Einstein", " ", "Distribution"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BE", "[", 
     RowBox[{"Energy_", ",", "x_"}], "]"}], "=", 
    FractionBox["1", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"x", " ", "Energy"}], "]"}], "-", "1"}], ")"}]]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "For", " ", "neutrinos", " ", "with", " ", "a", " ", "chemical", " ", 
    "potential"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FD\[Nu]", "[", 
    RowBox[{"Energy_", ",", "\[Phi]_", ",", "x_"}], "]"}], "=", 
   FractionBox["1", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"x", " ", "Energy"}], "-", "\[Phi]"}], "]"}], "+", "1"}], 
     ")"}]]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.694867621154951*^9, 3.694867643230753*^9}, {
   3.695060258011354*^9, 3.695060298815854*^9}, {3.695060621478839*^9, 
   3.695060640041944*^9}, {3.695063014887841*^9, 3.695063061511763*^9}, {
   3.695398913508184*^9, 3.69539892344058*^9}, {3.695413265412278*^9, 
   3.695413333056735*^9}, {3.696566282219267*^9, 3.6965662862678423`*^9}, {
   3.698029560270629*^9, 3.6980295610167313`*^9}, {3.698030116167626*^9, 
   3.698030124214801*^9}, 3.698381805311557*^9, {3.7159384126126623`*^9, 
   3.715938424500524*^9}, {3.715938488860979*^9, 3.7159384923371*^9}, {
   3.715938584406673*^9, 3.7159386342035303`*^9}, {3.719811627516124*^9, 
   3.719811651189975*^9}, {3.722691473998188*^9, 3.722691519025485*^9}},
 CellLabel->
  "In[928]:=",ExpressionUUID->"62f85db8-df22-44d9-b926-a5f2df9d5385"],

Cell["Derivatives of FD wrt to energy.", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6983818458867826`*^9, 3.6983818542910023`*^9}, {
  3.715938467114118*^9, 3.715938495329319*^9}, {3.715938528147161*^9, 
  3.715938530664877*^9}},ExpressionUUID->"aedfafb5-c089-4edc-9225-\
200b851e1090"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FDp", "[", 
    RowBox[{"Energy_", ",", "x_"}], "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"x", " ", "Energy"}], "]"}], "+", "1"}], ")"}]], ",", 
     "Energy"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6980295624322577`*^9, 3.698029591748794*^9}, {
  3.715938498322832*^9, 3.715938524249474*^9}, {3.7159386581421623`*^9, 
  3.7159386624381123`*^9}, {3.722691523112835*^9, 3.7226915248010893`*^9}},
 CellLabel->
  "In[933]:=",ExpressionUUID->"1795a94b-77fb-470c-ab04-760ac29a09c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Customized Mathematica tools", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6944952342663107`*^9, 3.694495239582594*^9}, {
  3.694750049551672*^9, 3.694750050847395*^9}, {3.69501241939677*^9, 
  3.6950124195948133`*^9}, {3.7003898646572943`*^9, 
  3.700389870088821*^9}},ExpressionUUID->"9e0467e6-6766-400d-b0f9-\
7d10bf47cce8"],

Cell["\<\
This function NP displays a certain number of digits for a given real number\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6947500522082653`*^9, 3.694750066921056*^9}, {
  3.715938706900445*^9, 
  3.715938707177966*^9}},ExpressionUUID->"8dec58f7-4b1e-452e-88c7-\
79cd55d3f051"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NP", "[", "number_", "]"}], ":=", 
  RowBox[{"NumberForm", "[", 
   RowBox[{"number", ",", "8"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6944952484001493`*^9, 3.694495283186882*^9}, {
  3.694795540125854*^9, 3.694795540182535*^9}, {3.69656982030233*^9, 
  3.6965698206787024`*^9}},
 CellLabel->
  "In[934]:=",ExpressionUUID->"0c8a7072-6039-4b2a-9d33-cbafcfb63774"],

Cell["\<\
This function displays a table in grid form, that is with lines between the \
entries\
\>", "Text",
 CellChangeTimes->{{3.6984821557076397`*^9, 
  3.698482173863063*^9}},ExpressionUUID->"e670a318-713d-4447-938b-\
2b3ad0677af0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyGrid", "[", "Table_List", "]"}], ":=", 
  RowBox[{"Grid", "[", 
   RowBox[{"Table", ",", 
    RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.698482175566115*^9, 3.698482191512245*^9}},
 CellLabel->
  "In[935]:=",ExpressionUUID->"4ab1e4b7-ff8e-4a70-bdf2-272883179021"],

Cell["\<\
This function performs interpolation on a list of points (x, f(x)) to the \
required order. \
\>", "Text",
 CellChangeTimes->{{3.698482456688301*^9, 3.698482476241219*^9}, {
   3.698483884160187*^9, 3.698483890053114*^9}, 3.7159387205860777`*^9, 
   3.722684797773628*^9},ExpressionUUID->"526cb019-f861-4d37-8e35-\
4693265010b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MyInterpolation", "[", "Tab_List", "]"}], ":=", 
    RowBox[{"Interpolation", "[", 
     RowBox[{"Tab", ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "InterpOrder"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Does", " ", "not", " ", "work", " ", "to", " ", "interpolate", " ", "the",
     " ", "log", " ", "of", " ", "rates", " ", "because", " ", "it", " ", 
    "fails", " ", "when", " ", "rates", " ", 
    RowBox[{
     RowBox[{"vanish", " ", "!!"}], "!"}]}], "*)"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MyInterpolationLog", "[", "Tab_List", "]"}], ":=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"Log", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
           "Tab"}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "InterpOrder"}]}], "]"}], 
        "[", "x", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$InterpolateLogRate", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyInterpolationRate", "[", "Tab_List", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{"$InterpolateLogRate", ",", 
    RowBox[{"MyInterpolationLog", "[", "Tab", "]"}], ",", 
    RowBox[{"MyInterpolation", "[", "Tab", "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[936]:=",ExpressionUUID->"18a3433d-2269-4ea7-b60f-90c2da005fcd"],

Cell["\<\
Tools to avoid too small numbers in numerics.
MyChop chops small numbers and replaces them by 0.\
\>", "Text",
 CellChangeTimes->{{3.7003741564537983`*^9, 3.700374163021914*^9}, {
  3.715938751118059*^9, 
  3.71593876866858*^9}},ExpressionUUID->"fc30af7b-45e1-4564-90de-\
eff693ea30ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MyChop", "[", 
    RowBox[{"el_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"Chop", "[", 
     RowBox[{"el", ",", "$MinMachineNumber"}], "]"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"MyChop", ",", "Listable"}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.700124060587042*^9, 3.7001240951767483`*^9}, 
   3.700124870395438*^9, {3.700148723007616*^9, 3.7001487239155703`*^9}, {
   3.70018312866718*^9, 3.700183142755645*^9}, {3.7001855038737087`*^9, 
   3.7001855053032503`*^9}, {3.700185879059705*^9, 3.700185891353445*^9}, {
   3.700188239945805*^9, 3.700188240717269*^9}, {3.700311571157694*^9, 
   3.7003115908668423`*^9}, {3.700823375372863*^9, 3.700823380831126*^9}, {
   3.700823422041391*^9, 3.70082343043011*^9}, 3.715938757904622*^9, {
   3.718328090126343*^9, 3.7183281618893137`*^9}, {3.718328204048663*^9, 
   3.718328206159741*^9}, {3.718328410486248*^9, 3.718328410663019*^9}, {
   3.722259849710515*^9, 3.7222598560724993`*^9}, {3.722260073205158*^9, 
   3.7222600805064898`*^9}, {3.722260626316647*^9, 3.722260733136669*^9}, 
   3.722260858469545*^9, {3.722261152826248*^9, 3.722261163707656*^9}, {
   3.722261357953105*^9, 3.722261360023819*^9}, {3.722684816053753*^9, 
   3.722684820439187*^9}},
 CellLabel->
  "In[940]:=",ExpressionUUID->"8688bf8f-addc-4ac5-bc72-aeaba74ab7e6"],

Cell["\<\
Redefinition of Set to allow to set values to quantities already set\
\>", "Text",
 CellChangeTimes->{{3.700374165218297*^9, 3.700374183556826*^9}, {
  3.700387548038706*^9, 3.700387548614403*^9}, {3.715938813206703*^9, 
  3.715938813487864*^9}, {3.715938848936346*^9, 
  3.7159388510189342`*^9}},ExpressionUUID->"87b0d044-a924-4e72-9672-\
98c133fad5a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MySet", "[", 
    RowBox[{
     RowBox[{"Hold", "[", "expr_", "]"}], ",", "value_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"expr", "=", "value"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MySetDelayed", "[", 
    RowBox[{
     RowBox[{"Hold", "[", "expr_", "]"}], ",", "value_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"expr", ":=", "value"}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.699866784313671*^9},
 CellLabel->
  "In[942]:=",ExpressionUUID->"92e94952-b75c-4eb4-aa46-51358194eea1"],

Cell["\<\
Personal simple integral with second order polynomial interpolation (Simpson \
method).\
\>", "Text",
 CellChangeTimes->{{3.7003741860117397`*^9, 3.700374199236223*^9}, {
   3.7003875547756987`*^9, 3.70038755576591*^9}, {3.703302304505962*^9, 
   3.703302307665119*^9}, 
   3.715938861198474*^9},ExpressionUUID->"0e07ff5c-8fe4-4dfe-be35-\
4ee80d83df38"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TableSimpsonC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Np", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"h", "=", 
          RowBox[{"1.", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"b", "-", "a"}], ")"}], "/", "Np"}]}]}], ",", 
         RowBox[{"n2", "=", 
          RowBox[{"Np", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h3", "=", 
           RowBox[{"h", "/", "3."}]}], "}"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"a", ",", "h3"}], "}"}], "}"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"a", "+", 
                RowBox[{"2.", " ", "j", " ", "h"}]}], ",", 
               RowBox[{"2", " ", "h3"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"n2", "-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"a", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2.", " ", "j"}], "-", "1"}], ")"}], " ", "h"}]}], 
               ",", 
               RowBox[{"4", " ", "h3"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "n2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"b", ",", "h3"}], "}"}], "}"}]}], "]"}]}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
     RowBox[{"\"\<RuntimeOptions\>\"", "\[Rule]", "\"\<Speed\>\""}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7002984957882137`*^9, 3.700298534768643*^9}, {
   3.700298622924418*^9, 3.700298635130396*^9}, {3.7003046234305696`*^9, 
   3.7003046513073997`*^9}, 3.7003051046884327`*^9, 3.7003105799582577`*^9, 
   3.7003875637078247`*^9},
 CellLabel->
  "In[944]:=",ExpressionUUID->"1c568d81-ef72-4f71-b794-3e26a66f5062"],

Cell["Generic compilation of a function and of its integration.", "Text",
 CellChangeTimes->{{3.700374208805346*^9, 3.700374215381876*^9}, {
  3.700387571808568*^9, 3.700387575182206*^9}, {3.715938874891779*^9, 
  3.715938875002921*^9}},ExpressionUUID->"9a1a1a2e-3889-4e0c-81cb-\
7511241d23fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyCompile", "[", 
   RowBox[{"LV_List", ",", "Body_"}], "]"}], ":=", 
  RowBox[{"Compile", "[", 
   RowBox[{"LV", ",", 
    RowBox[{"Evaluate", "[", "Body", "]"}], ",", 
    RowBox[{"\"\<RuntimeOptions\>\"", "\[Rule]", "\"\<Speed\>\""}], ",", 
    RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
    RowBox[{"CompilationOptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
      "}"}]}], ",", 
    RowBox[{"RuntimeAttributes", "\[Rule]", 
     RowBox[{"{", "Listable", "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7003044656489973`*^9, 3.700304525989698*^9}, {
  3.700311480658279*^9, 3.7003114917231007`*^9}, {3.700313835739531*^9, 
  3.700313839183239*^9}, {3.700387584355373*^9, 3.7003875909952927`*^9}, {
  3.718327644196311*^9, 3.718327677113274*^9}, {3.7183279877561073`*^9, 
  3.71832798852281*^9}},
 CellLabel->
  "In[945]:=",ExpressionUUID->"9f836f26-1f30-4091-ad69-dac7129d3e66"],

Cell["Compilation of a scalar product.", "Text",
 CellChangeTimes->{{3.715938895449288*^9, 
  3.7159389077282743`*^9}},ExpressionUUID->"57f1d73d-3da4-4f15-a67c-\
0592e439b0ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"V1dotV2", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"V1", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"V2", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"V1", ".", "V2"}], ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
     RowBox[{"\"\<RuntimeOptions\>\"", "\[Rule]", "\"\<Speed\>\""}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7002984957882137`*^9, 3.700298534768643*^9}, {
   3.700298622924418*^9, 3.700298635130396*^9}, {3.7003046234305696`*^9, 
   3.7003046513073997`*^9}, 3.7003051046884327`*^9, 3.7003105799582577`*^9, 
   3.7003875637078247`*^9, {3.722260494593948*^9, 3.722260496717609*^9}},
 CellLabel->
  "In[946]:=",ExpressionUUID->"315c3a09-3d94-4d79-8bcd-6f455bc40adc"],

Cell["Compiled version of the Simpson integral", "Text",
 CellChangeTimes->{{3.715938910577466*^9, 
  3.715938919129726*^9}},ExpressionUUID->"e41240f3-020b-498d-bd6a-\
3dd90f2d6853"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IntegrateFunction", "[", 
    RowBox[{"fun_", ",", "pemin_", ",", "pemax_", ",", "Np_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"interv", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pemax", "-", "pemin"}], ")"}], "/", 
         RowBox[{"(", "Np", ")"}]}]}], ",", 
       RowBox[{"tab", "=", 
        RowBox[{"TableSimpsonC", "[", 
         RowBox[{"pemin", ",", "pemax", ",", "Np"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"V1dotV2", "[", 
      RowBox[{
       RowBox[{"tab", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"MyChop", "[", 
        RowBox[{"fun", "[", 
         RowBox[{"tab", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.70031058709378*^9, 3.700310589083734*^9}, {
   3.700311596020309*^9, 3.700311602649352*^9}, {3.70031166249789*^9, 
   3.700311703000999*^9}, 3.722260745420182*^9, 3.722261163711102*^9},
 CellLabel->
  "In[947]:=",ExpressionUUID->"07163bc0-ebbb-4c25-9550-fb9171ffc5a7"],

Cell["\<\
A function to import an external file and which returns an error and quits if \
the file does not exist.\
\>", "Text",
 CellChangeTimes->{{3.700492711836652*^9, 3.700492725725021*^9}, {
  3.715938937959045*^9, 
  3.715938960321542*^9}},ExpressionUUID->"4fe8a34e-8430-4e55-a142-\
a1cff9b0d066"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SafeImport", "[", "args__", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "out", "}"}], ",", 
    RowBox[{
     RowBox[{"out", "=", 
      RowBox[{"Catch", "[", 
       RowBox[{"Check", "[", 
        RowBox[{
         RowBox[{"Import", "[", "args", "]"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<File \>\"", ",", 
            RowBox[{
             RowBox[{"{", "args", "}"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            "\"\< not found. Quiting Kernel.\>\""}], "]"}], ";", 
          RowBox[{"Throw", "[", "$Failed", "]"}], ";"}], ",", 
         RowBox[{"Import", "::", "nffil"}]}], "]"}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"out", "===", "$Failed"}], ",", 
       RowBox[{"Quit", "[", "]"}]}], "]"}], ";", "out"}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.700492703945938*^9, 3.7004927637934113`*^9}, {
  3.700492873781904*^9, 3.700492915864861*^9}, {3.700493202080701*^9, 
  3.700493208571322*^9}, {3.7004933081833363`*^9, 3.700493401818736*^9}, {
  3.700494543052726*^9, 3.700494610276518*^9}, {3.7004946656429462`*^9, 
  3.700494669822061*^9}, {3.7004947801175013`*^9, 3.700494810962249*^9}, {
  3.7004948422378674`*^9, 3.700494870101368*^9}, {3.700494904659279*^9, 
  3.700495004256784*^9}, {3.700495142529827*^9, 3.7004951460471783`*^9}},
 CellLabel->
  "In[948]:=",ExpressionUUID->"f0f6ed0d-64bf-487d-8041-77b718ca30e0"],

Cell["Tools for plots. Some useful grid of ticks ", "Text",
 CellChangeTimes->{{3.717470788202495*^9, 3.717470794239908*^9}, {
  3.722684877353567*^9, 
  3.72268488071688*^9}},ExpressionUUID->"d39bbd05-9675-4e55-a3fe-\
6e58b9ebc472"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MyFrameTicksLog", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"10", "^", "8"}], "]"}], ",", 
            "\"\<\!\(\*SuperscriptBox[\(10\), \(8\)]\)\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"10", "^", "8.5"}], "]"}], ",", 
            "\"\<\!\(\*SuperscriptBox[\(10\), \(8.5\)]\)\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"10", "^", "9"}], "]"}], ",", 
            "\"\<\!\(\*SuperscriptBox[\(10\), \(9\)]\)\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"10", "^", "9.5"}], "]"}], ",", 
            "\"\<\!\(\*SuperscriptBox[\(10\), \(9.5\)]\)\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"10", "^", "10"}], "]"}], ",", 
            "\"\<\!\(\*SuperscriptBox[\(10\), \(10\)]\)\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"10", "^", "10.5"}], "]"}], ",", 
            "\"\<\!\(\*SuperscriptBox[\(10\), \(10.5\)]\)\>\""}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"10", "^", "11"}], "]"}], ",", 
            "\"\<\!\(\*SuperscriptBox[\(10\), \(11\)]\)\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"10", "^", "11.5"}], "]"}], ",", 
            "\"\<\!\(\*SuperscriptBox[\(10\), \(11.5\)]\)\>\""}], "}"}]}], 
         "}"}], ",", "Automatic"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"MyFrameTicks", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"10", "^", "8"}], ",", 
           "\"\<\!\(\*SuperscriptBox[\(10\), \(8\)]\)\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"10", "^", "8.5"}], ",", 
           "\"\<\!\(\*SuperscriptBox[\(10\), \(8.5\)]\)\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"10", "^", "9"}], ",", 
           "\"\<\!\(\*SuperscriptBox[\(10\), \(9\)]\)\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"10", "^", "9.5"}], ",", 
           "\"\<\!\(\*SuperscriptBox[\(10\), \(9.5\)]\)\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"10", "^", "10"}], ",", 
           "\"\<\!\(\*SuperscriptBox[\(10\), \(10\)]\)\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"10", "^", "10.5"}], ",", 
           "\"\<\!\(\*SuperscriptBox[\(10\), \(10.5\)]\)\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"10", "^", "11"}], ",", 
           "\"\<\!\(\*SuperscriptBox[\(10\), \(11\)]\)\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"10", "^", "11.5"}], ",", 
           "\"\<\!\(\*SuperscriptBox[\(10\), \(11\)]\).5\>\""}], "}"}]}], 
        "}"}], ",", "Automatic"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717470798335593*^9, 3.717470819399013*^9}, {
  3.71747098370815*^9, 3.717471017635457*^9}, {3.718600938812766*^9, 
  3.718600970974428*^9}},
 CellLabel->
  "In[949]:=",ExpressionUUID->"3c9213de-d2a5-4d06-9d40-27ffb091165b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Thermodynamics of the plasma", "Chapter",
 InitializationCell->True,
 CellChangeTimes->{{3.694751201243245*^9, 3.694751205959159*^9}, {
  3.7159382465731487`*^9, 
  3.7159382513521013`*^9}},ExpressionUUID->"d839e9df-4a99-4a03-b8a1-\
fbc3486d8b53"],

Cell[CellGroupData[{

Cell["Thermodynamic integrals", "Section",
 CellChangeTimes->{{3.7187275365036783`*^9, 
  3.71872754641336*^9}},ExpressionUUID->"7a6467c2-3d75-4341-b5d8-\
b64e6338a85c"],

Cell["\<\
Defined in appendix A1 of companion paper. These are the integrals needed to \
obtain the thermodynamic quantities of FD or BE distributions and correspond \
to Eqs. A5 in companion paper.\
\>", "Text",ExpressionUUID->"d119a72c-02ce-430f-9740-0efde4c1e1ea"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "Imn", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Imn", "[", "sgn_", "]"}], "[", 
    RowBox[{"m_", ",", "n_"}], "]"}], "[", "x_", "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["pe", "2"], "+", 
         SuperscriptBox["x", "2"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "/", "2"}], ")"}]], 
      SuperscriptBox["pe", 
       RowBox[{"(", 
        RowBox[{"n", "+", "1"}], ")"}]]}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Exp", "[", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["pe", "2"], "+", 
          SuperscriptBox["x", "2"]}]], "]"}], "+", "sgn"}], ")"}]], ",", 
    RowBox[{"{", 
     RowBox[{"pe", ",", "0", ",", "Infinity"}], "}"}], ",", 
    RowBox[{"Method", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Automatic", ",", 
       RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ImnT", "[", "sgn_", "]"}], "[", 
     RowBox[{"m_", ",", "n_"}], "]"}], "[", "T_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Imn", "[", "sgn", "]"}], "[", 
     RowBox[{"m", ",", "n"}], "]"}], "[", 
    FractionBox["me", 
     RowBox[{"kB", " ", "T"}]], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Interpolations", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ImnI", "[", "sgn_", "]"}], "[", 
   RowBox[{"m_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ImnI", "[", "sgn", "]"}], "[", 
    RowBox[{"m", ",", "n"}], "]"}], "=", 
   RowBox[{"Interpolation", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox["me", 
         RowBox[{"kB", " ", "Tv"}]], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Imn", "[", "sgn", "]"}], "[", 
          RowBox[{"m", ",", "n"}], "]"}], "[", 
         FractionBox["me", 
          RowBox[{"kB", " ", "Tv"}]], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Tv", ",", "ListT"}], "}"}]}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ImnIT", "[", "sgn_", "]"}], "[", 
    RowBox[{"m_", ",", "n_"}], "]"}], "[", "T_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ImnI", "[", "sgn", "]"}], "[", 
    RowBox[{"m", ",", "n"}], "]"}], "[", 
   FractionBox["me", 
    RowBox[{"kB", " ", "T"}]], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.718727055090097*^9, 3.7187270717679358`*^9}, {
   3.718727147412487*^9, 3.718727231798152*^9}, 3.7187272812841682`*^9, {
   3.718727342178031*^9, 3.718727342801627*^9}, {3.718727419013768*^9, 
   3.718727443738109*^9}, 3.71872750941249*^9, 3.718727564443877*^9, {
   3.718727983619741*^9, 3.718728009658403*^9}, {3.71872815159907*^9, 
   3.718728190394402*^9}, {3.718766803122054*^9, 3.718766810440465*^9}, {
   3.718786373789917*^9, 3.718786423176157*^9}, {3.718786828825955*^9, 
   3.7187868371632442`*^9}, {3.7187875648617153`*^9, 3.718787603034956*^9}, {
   3.722691372610159*^9, 3.722691456012463*^9}},
 CellLabel->
  "In[951]:=",ExpressionUUID->"bb7424c0-69f0-455d-b535-657955539454"]
}, Open  ]],

Cell[CellGroupData[{

Cell["QED corrections to plasma thermodynamics", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.698027126012823*^9, 3.698027131098654*^9}, {
  3.7003878888481693`*^9, 
  3.7003878918932247`*^9}},ExpressionUUID->"c3adb8b0-676a-401a-998d-\
7d473d8a3e92"],

Cell[CellGroupData[{

Cell["QED mass corrections", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.698030903521216*^9, 3.698030907215632*^9}, 
   3.698068317688685*^9, 3.698381864455455*^9, {3.6983821853750353`*^9, 
   3.698382188482749*^9}, {3.71636914565541*^9, 
   3.716369149692544*^9}},ExpressionUUID->"bee20232-05e1-41cb-97c6-\
b28231f33478"],

Cell[TextData[{
 "From this, using Eq. 12 and 13 of [Mangano.et.al 2001] (or Eq .35 of [Lopez \
& Turner 1998] for the mass of the electron), we get the modification to the \
mass of the electron and of the photon. For this we ignore the last term in \
Eq. 12 of  [Mangano.et.al 2001] or Eq. 35 of [Lopez&Turner 1998]. \nSee also \
companion paper (Eqs. 44 and 46).\n\nThe mass shift is expressed in units of \
the electron mass so as to be dimensionless. So what we define as dme2 is \
really ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[Delta]", "(", 
      SubscriptBox["m", "e"], ")"}], "2"], "/", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox["m", "e"], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"d8c36a0a-6323-4b1e-bef9-6b8668eee7a1"],
 " and similarly for dm\[Gamma]2 it is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[Delta]", "(", 
      SubscriptBox["m", "\[Gamma]"], ")"}], "2"], "/", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox["m", "e"], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"daa4517e-1793-4ad6-8ab7-ea117c39d067"]
}], "Text",
 InitializationCell->
  True,ExpressionUUID->"57e12874-0277-4ab7-bcb1-4be49cf27069"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dme2", "[", "T_", "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{"kB", " ", "T"}], "me"], ")"}], "2"], 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"2", "\[Pi]", " ", "\[Alpha]FS"}], "3"], "+", " ", 
      RowBox[{
       FractionBox[
        RowBox[{"4", "\[Alpha]FS"}], "\[Pi]"], " ", 
       RowBox[{
        RowBox[{
         RowBox[{"ImnT", "[", "1", "]"}], "[", 
         RowBox[{"0", ",", "1"}], "]"}], "[", "T", "]"}]}]}], ")"}]}]}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Only", " ", "main", " ", "part", " ", "of", " ", "mass", " ", "shift"}], 
   " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"dm\[Gamma]2", "[", "T_", "]"}], ":=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"8", "\[Alpha]FS"}], "\[Pi]"], " ", 
   RowBox[{
    RowBox[{
     RowBox[{"ImnT", "[", "1", "]"}], "[", 
     RowBox[{"0", ",", "1"}], "]"}], "[", "T", "]"}], 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox[
      RowBox[{"kB", " ", "T"}], "me"], ")"}], "2"]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.718728033306072*^9, 3.7187280576932383`*^9}, {
  3.718786290821857*^9, 3.718786305541029*^9}, {3.718786544513063*^9, 
  3.7187865457613688`*^9}},
 CellLabel->
  "In[956]:=",ExpressionUUID->"cd3d174b-a9e5-4cf8-82ff-6d4883a24f39"],

Cell["\<\
We perform interpolations of these mass shifts over the relevant range of \
temperatures. We store it on disk in the files dme2.dat and dmg2.dat if they \
have never been computed.
If they have already been computed we just load the results (unless the \
Boolean option $RecomputePlasmaCorrections is set to True).\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698039661988426*^9, 3.698039672474134*^9}, {
   3.698382465578689*^9, 3.698382487219339*^9}, {3.698413998489436*^9, 
   3.698414001388505*^9}, {3.71593920572985*^9, 3.7159392712022047`*^9}, 
   3.715961557064969*^9, 
   3.716005404448545*^9},ExpressionUUID->"78aff461-97ee-410e-996a-\
561efe129cb1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dme2Tab", "=", 
    RowBox[{"Check", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"\"\<Interpolations/dme2.dat\>\"", ",", "\"\<TSV\>\""}], "]"}],
       ",", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Precomputed data not found. We recompute and store the \
data.\>\"", "]"}], ";", "$Failed"}], ",", 
      RowBox[{"Import", "::", "nffil"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dmg2Tab", "=", 
   RowBox[{"Check", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"\"\<Interpolations/dmg2.dat\>\"", ",", "\"\<TSV\>\""}], "]"}], 
     ",", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Precomputed data not found. We recompute and store the data.\>\"",
        "]"}], ";", "$Failed"}], ",", 
     RowBox[{"Import", "::", "nffil"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.694054178512896*^9, 3.6940542056232243`*^9}, {
   3.69405423698958*^9, 3.6940542954463*^9}, {3.6940543419859333`*^9, 
   3.694054348130924*^9}, {3.6942772337434187`*^9, 3.694277241261182*^9}, {
   3.694805077667665*^9, 3.69480511477722*^9}, {3.694805155264515*^9, 
   3.694805155368195*^9}, {3.694805248876021*^9, 3.694805288275734*^9}, {
   3.69480534589389*^9, 3.694805367562531*^9}, {3.694805821323741*^9, 
   3.694805842744095*^9}, {3.694806012312744*^9, 3.694806013849859*^9}, {
   3.694806238623993*^9, 3.6948062979530363`*^9}, {3.694807408341463*^9, 
   3.694807409525804*^9}, {3.6948108305946207`*^9, 3.694810949369995*^9}, {
   3.695017648744748*^9, 3.695017649412313*^9}, {3.6950646505296803`*^9, 
   3.695064684108411*^9}, {3.695105129791482*^9, 3.695105131289526*^9}, {
   3.6953533100802917`*^9, 3.695353311718564*^9}, {3.695408836498218*^9, 
   3.69540888734727*^9}, {3.698401794225937*^9, 3.6984018185685167`*^9}, {
   3.69841256759807*^9, 3.698412643829048*^9}, {3.6984139285924788`*^9, 
   3.698413961860961*^9}, 3.698414022408396*^9, {3.699340206908226*^9, 
   3.699340207613446*^9}, 3.700305395071438*^9, {3.7003060389611588`*^9, 
   3.700306070201675*^9}, {3.700306105032892*^9, 3.700306154518057*^9}, {
   3.700306333955687*^9, 3.7003063346933937`*^9}, {3.700792779589613*^9, 
   3.700792857104148*^9}, {3.700792922575306*^9, 3.700792944303265*^9}, {
   3.700793027030994*^9, 3.700793034592114*^9}, {3.7007933479412203`*^9, 
   3.700793413561536*^9}, {3.700793570709611*^9, 3.700793578829811*^9}, 
   3.700796005111611*^9, {3.715939215639868*^9, 3.715939229893943*^9}, 
   3.7159392743215437`*^9, 3.7159615614861097`*^9, 3.715961791524743*^9, {
   3.721967353455113*^9, 3.72196735547324*^9}},
 CellLabel->
  "In[958]:=",ExpressionUUID->"c99d09ff-69d5-42b7-b912-bf88d425dda6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dme2Tab", "\[Equal]", "$Failed"}], "||", 
      RowBox[{"dmg2Tab", "\[Equal]", "$Failed"}], "||", 
      "$RecomputePlasmaCorrections"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dme2Tab", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"T", ",", 
           RowBox[{"dme2", "[", "T", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"T", ",", "ListT"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dmg2Tab", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"T", ",", 
           RowBox[{"dm\[Gamma]2", "[", "T", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"T", ",", "ListT"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
       "\"\<Interpolations/dme2.dat\>\"", ",", "dme2Tab", ",", 
        "\"\<TSV\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
       "\"\<Interpolations/dmg2.dat\>\"", ",", "dmg2Tab", ",", 
        "\"\<TSV\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.694054178512896*^9, 3.6940542056232243`*^9}, {
   3.69405423698958*^9, 3.6940542954463*^9}, {3.6940543419859333`*^9, 
   3.694054348130924*^9}, {3.6942772337434187`*^9, 3.694277241261182*^9}, {
   3.694805077667665*^9, 3.69480511477722*^9}, {3.694805155264515*^9, 
   3.694805155368195*^9}, {3.694805248876021*^9, 3.694805288275734*^9}, {
   3.69480534589389*^9, 3.694805367562531*^9}, {3.694805821323741*^9, 
   3.694805842744095*^9}, {3.694806012312744*^9, 3.694806013849859*^9}, {
   3.694806238623993*^9, 3.6948062979530363`*^9}, {3.694807408341463*^9, 
   3.694807409525804*^9}, {3.6948108305946207`*^9, 3.694810949369995*^9}, {
   3.695017648744748*^9, 3.695017649412313*^9}, {3.6950646505296803`*^9, 
   3.695064684108411*^9}, {3.695105129791482*^9, 3.695105131289526*^9}, {
   3.6953533100802917`*^9, 3.695353311718564*^9}, {3.695408836498218*^9, 
   3.69540888734727*^9}, {3.698401794225937*^9, 3.6984018185685167`*^9}, {
   3.69841256759807*^9, 3.698412643829048*^9}, {3.6984139285924788`*^9, 
   3.698413961860961*^9}, 3.698414022408396*^9, {3.699340206908226*^9, 
   3.699340207613446*^9}, 3.700305395071438*^9, {3.7003060389611588`*^9, 
   3.700306070201675*^9}, {3.700306105032892*^9, 3.700306154518057*^9}, {
   3.700306333955687*^9, 3.7003063346933937`*^9}, {3.700792779589613*^9, 
   3.700792857104148*^9}, {3.700792922575306*^9, 3.700792944303265*^9}, {
   3.700793027030994*^9, 3.700793034592114*^9}, {3.7007933479412203`*^9, 
   3.700793413561536*^9}, {3.700793570709611*^9, 3.700793578829811*^9}, 
   3.700796005111611*^9, {3.715939215639868*^9, 3.715939229893943*^9}, 
   3.7159392743215437`*^9, 3.7159615614861097`*^9, 3.715961791524743*^9, 
   3.716005404194295*^9, {3.721967304525475*^9, 3.721967307783853*^9}, 
   3.7728750372020597`*^9},
 CellLabel->
  "In[960]:=",ExpressionUUID->"96d9beed-cec2-43f1-a84f-a1b61f4a83ce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.000011`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwdz1tIk3EABfBp6IZO8WHIMh0tC8pKmJmyGMY3Q2Oa6ATXZLYV5SyVxWja
skleWim5nIlaitQchXjJy3DkTK0gI7eJgSJOzcJkrU+hUDEJ9H96OPyeDpzD
v6KRXvNjMBhZJJKoN4U0l6bCvW+/ifbTVG7XDwErgqZmv2xz2MSdrPd3YWhe
2DvWAZp6/uGf5zRRydUFJRDTuzkn4DOLQQN5dkMVvOW6KBAS+67HaCGnx3Mf
tjlNc1Bf8mLfGaLb54iGBVNpQugaFRhg9eREvpxoM199BJtWxU74qW5wCUpS
+JkKorVuYQXOuE3bcEqt4+YRaa53Ukn0T1SuwNFVX7CKKLKJIuHn4riky0Tj
coEM/vojGocVgZ5pKLE+ifWLpKkWTaMYDoScnIfavs41uFAqZPoTh1+3HoLn
Huweh8Z65il4u38iCd7M1ifD9p9rqTBqU38BesfismEv78YlOHuPp4buwqMa
qJOcLYXOImkFrGc5amHE38HHcKOjo+l/T1bSBrdmjBbItHW9gvLmkW64XlY5
AMdtlQ6oOC93BmCnb+grrO2X7sKY1tCDgfjXbMmHVrG5DN5ZVzyFdrb9NwyY
/hjNJHamS9Pg/DG1CmpVYeUwKHe4AS5tmF5C9uHlERg/diQjh/h9cTEHprge
1sD4Xr5ZRtwDZIgetw==
  "],
 CellLabel->
  "Out[960]=",ExpressionUUID->"dfdbbecf-2434-4566-8284-de0c1e55a216"]
}, Open  ]],

Cell["\<\
Once having the table of values for the mass shift as a function of \
temperature, we perform an interpolation\
\>", "Text",
 CellChangeTimes->{{3.715939276081032*^9, 
  3.715939295740807*^9}},ExpressionUUID->"f6c21998-b3ad-4d6b-8f37-\
04a641717de9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dme2I", "=", 
   RowBox[{"MyInterpolation", "@", 
    RowBox[{"ToExpression", "@", "dme2Tab"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dm\[Gamma]2I", "=", 
   RowBox[{"MyInterpolation", "@", 
    RowBox[{"ToExpression", "@", "dmg2Tab"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.694054178512896*^9, 3.6940542056232243`*^9}, {
   3.69405423698958*^9, 3.6940542954463*^9}, {3.6940543419859333`*^9, 
   3.694054348130924*^9}, {3.6942772337434187`*^9, 3.694277241261182*^9}, {
   3.694805077667665*^9, 3.69480511477722*^9}, {3.694805155264515*^9, 
   3.694805155368195*^9}, {3.694805248876021*^9, 3.694805288275734*^9}, {
   3.69480534589389*^9, 3.694805367562531*^9}, {3.694805821323741*^9, 
   3.694805842744095*^9}, {3.694806012312744*^9, 3.694806013849859*^9}, {
   3.694806238623993*^9, 3.6948062979530363`*^9}, {3.694807408341463*^9, 
   3.694807409525804*^9}, {3.6948108305946207`*^9, 3.694810949369995*^9}, {
   3.695017648744748*^9, 3.695017649412313*^9}, {3.6950646505296803`*^9, 
   3.695064684108411*^9}, {3.695105129791482*^9, 3.695105131289526*^9}, {
   3.6953533100802917`*^9, 3.695353311718564*^9}, {3.695408836498218*^9, 
   3.69540888734727*^9}, {3.698401794225937*^9, 3.6984018185685167`*^9}, {
   3.69841256759807*^9, 3.698412643829048*^9}, {3.6984139285924788`*^9, 
   3.698413961860961*^9}, 3.698414022408396*^9, {3.699340206908226*^9, 
   3.699340207613446*^9}, 3.700305395071438*^9, {3.7003060389611588`*^9, 
   3.700306070201675*^9}, {3.700306105032892*^9, 3.700306154518057*^9}, {
   3.700306333955687*^9, 3.7003063346933937`*^9}, {3.700792779589613*^9, 
   3.700792857104148*^9}, {3.700792922575306*^9, 3.700792944303265*^9}, {
   3.700793027030994*^9, 3.700793034592114*^9}, {3.7007933479412203`*^9, 
   3.700793413561536*^9}, {3.700793570709611*^9, 3.700793578829811*^9}, 
   3.700796005111611*^9, {3.715939215639868*^9, 3.715939229893943*^9}, 
   3.7159392743215437`*^9},
 CellLabel->
  "In[961]:=",ExpressionUUID->"d84fb41b-ec77-4c0e-8c85-109a516cf3c4"],

Cell["\<\
We define a function which gives a value for all temperature and not just in \
the range of the interpolation so as to avoid any numerical problem. 
TODO eventually this is useless. Simplify as much as possible for readability.\
\>", "Text",
 CellChangeTimes->{{3.715939353381093*^9, 3.7159393904851*^9}, {
   3.718786892608349*^9, 3.718786902779023*^9}, 
   3.722684996896359*^9},ExpressionUUID->"9a66dfce-73aa-4730-9bf6-\
347397f47165"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dme2N", "[", 
    RowBox[{"T_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"T", "<", "Tf"}], ",", "0", ",", 
     RowBox[{"T", "\[LessEqual]", "Ti"}], " ", ",", 
     RowBox[{"dme2I", "[", "T", "]"}], ",", 
     RowBox[{"T", ">", "Ti"}], ",", 
     RowBox[{"dme2I", "[", "Ti", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dm\[Gamma]2N", "[", 
    RowBox[{"T_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"T", "<", "Tf"}], ",", "0", ",", 
     RowBox[{"T", "\[LessEqual]", "Ti"}], " ", ",", 
     RowBox[{"dm\[Gamma]2I", "[", "T", "]"}], ",", 
     RowBox[{"T", ">", "Ti"}], ",", 
     RowBox[{"dme2I", "[", "Ti", "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.698039640790813*^9, 3.698039730849325*^9}, 
   3.698382492859214*^9, {3.698413989160902*^9, 3.698413991448736*^9}, 
   3.698482568178767*^9, {3.7003061671776247`*^9, 3.700306173135247*^9}, {
   3.715939312457939*^9, 3.715939313130846*^9}},
 CellLabel->
  "In[963]:=",ExpressionUUID->"6873e003-1abe-4639-8706-97d4510779b7"],

Cell[TextData[{
 "We also define these interpolations in terms of the inverse temperature (in \
units of electron mass, that is the quantity ",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    RowBox[{"x", "=", " ", 
     RowBox[{
      SubscriptBox["m", "e"], "/", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["k", "B"], "T"}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"066ad5a7-0a47-46e7-a3bb-36fca62833da"],
 " )"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698382495679935*^9, 3.698382514794746*^9}, {
  3.715939398351025*^9, 
  3.715939430028088*^9}},ExpressionUUID->"0a055772-5326-4bc1-bedd-\
25ae76cbdbc7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dme2x", "[", "x_", "]"}], ":=", 
   RowBox[{"dme2N", "[", 
    RowBox[{"me", "/", 
     RowBox[{"(", 
      RowBox[{"kB", " ", "x"}], ")"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.698039640790813*^9, 3.698039730849325*^9}, 
   3.698382492859214*^9, 3.699772750790371*^9, 3.699772964832103*^9, {
   3.7226850078539762`*^9, 3.722685017742853*^9}},
 CellLabel->
  "In[965]:=",ExpressionUUID->"9443429f-7b5d-454c-98d8-760df365e0ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell["QED pressure corrections", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.698030909867625*^9, 3.698030914641966*^9}, {
  3.700387809785145*^9, 3.7003878109335203`*^9}, {3.716369136216511*^9, 
  3.716369156271598*^9}},ExpressionUUID->"7c51a17e-a9fc-43b6-b99d-\
7fbff3050bc4"],

Cell["\<\
Pressure corrections are obtained from Eq. 13 of [Heckler 1994] when \
including only electron mass shift, or Eq. 16 of [Mangano et al. 2001] for \
both electron mass and photon mass shifts. See also companion paper (around \
Eqs. 48 and 49) It is made of the dominant term dPa, and the subdominant \
terms dPb which are the two contributions of Eq. 48 in companion paper.\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"6ee91e1f-e727-412d-9fec-c12843528ec8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dPa", "[", "T_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dPa", "[", "T", "]"}], "=", 
    RowBox[{
     FractionBox["\[Alpha]FS", "\[Pi]"], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"kB", " ", "T"}], ")"}], "4"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["2", "3"]}], 
        RowBox[{
         RowBox[{
          RowBox[{"ImnT", "[", "1", "]"}], "[", 
          RowBox[{"0", ",", "1"}], "]"}], "[", "T", "]"}]}], "-", 
       RowBox[{
        FractionBox["2", 
         SuperscriptBox["\[Pi]", "2"]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ImnT", "[", "1", "]"}], "[", 
            RowBox[{"0", ",", "1"}], "]"}], "[", "T", "]"}], ")"}], "2"]}]}], 
      ")"}]}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7187282699420156`*^9, 3.718728318603319*^9}, {
   3.718728355516646*^9, 3.7187283583181467`*^9}, {3.718728429014056*^9, 
   3.718728429249858*^9}, {3.718786116517528*^9, 3.7187861257199287`*^9}, {
   3.7187864466005*^9, 3.718786450321663*^9}, {3.718787302865569*^9, 
   3.71878730462671*^9}, {3.7226911520894012`*^9, 3.7226911677988873`*^9}, 
   3.7711633886970177`*^9},
 CellLabel->
  "In[966]:=",ExpressionUUID->"d6b49c9c-e1b1-4fe9-9e25-63e6a3e52b47"],

Cell["\<\
For the subdominant contribution we use reduced variables. But contrary to \
the rest of the code where p stands for p/me here it stands for p/T.\
\>", "Text",
 CellChangeTimes->{{3.718787015177904*^9, 3.718787043899972*^9}, {
   3.718792883430151*^9, 3.718792891252516*^9}, 
   3.722685199963141*^9},ExpressionUUID->"b1bbd474-dcba-45a9-a2f3-\
807d22bd5afe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Fdp1dp2", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p2", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "_Real"}], "}"}]}], "}"}], ",", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"e1", "=", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["p1", "2"], "+", 
              SuperscriptBox["x", "2"]}]]}], ",", 
           RowBox[{"e2", "=", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["p2", "2"], "+", 
              SuperscriptBox["x", "2"]}]]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          FractionBox["\[Alpha]FS", 
           SuperscriptBox["\[Pi]", "3"]], 
          FractionBox[
           RowBox[{
            SuperscriptBox["x", "2"], " ", 
            SuperscriptBox["p1", "2"], 
            SuperscriptBox["p2", "2"]}], 
           RowBox[{"p1", " ", "p2", " ", "e1", " ", "e2"}]], " ", 
          RowBox[{"Log", "[", 
           RowBox[{"Abs", "[", 
            FractionBox[
             RowBox[{"(", 
              RowBox[{"p1", "+", "p2"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"p1", "-", "p2"}], ")"}]], "]"}], "]"}], 
          FractionBox["1", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Exp", "[", "e1", "]"}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Exp", "[", "e2", "]"}], "+", "1"}], ")"}]}]]}]}], 
        "\[IndentingNewLine]", "]"}], "]"}], ",", 
      RowBox[{"\"\<RuntimeOptions\>\"", "\[Rule]", "\"\<Speed\>\""}], ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Fdp1dp2N", "[", 
     RowBox[{
      RowBox[{"p1_", "?", "NumericQ"}], ",", 
      RowBox[{"p2_", "?", "NumericQ"}], ",", "x_"}], "]"}], ":=", 
    RowBox[{"Fdp1dp2", "[", 
     RowBox[{"p1", ",", "p2", ",", "x"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\n", 
 RowBox[{"Clear", "[", "dPb", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dPb", "[", "Tv_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dPb", "[", "Tv", "]"}], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"kB", " ", "Tv"}], ")"}], "4"], 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", "=", 
         RowBox[{"me", " ", "/", 
          RowBox[{"(", 
           RowBox[{"kB", " ", "Tv"}], ")"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"0.5", 
        RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Fdp1dp2N", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p1pp2", "+", "p1mp2"}], ")"}], "/", "2"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p1pp2", "-", "p1mp2"}], ")"}], "/", "2"}], ",", "x"}],
             "]"}], "\[IndentingNewLine]", "+", 
           RowBox[{"Fdp1dp2N", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p1pp2", "-", "p1mp2"}], ")"}], "/", "2"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p1pp2", "+", "p1mp2"}], ")"}], "/", "2"}], ",", "x"}],
             "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"p1mp2", ",", "0.0001", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"20", ",", 
              RowBox[{"20", "*", " ", "x"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p1pp2", ",", 
            RowBox[{"0.0001", "+", 
             RowBox[{"Abs", "[", "p1mp2", "]"}]}], ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"20", ",", 
               RowBox[{"20", "*", "x"}]}], "]"}], "+", 
             RowBox[{"Abs", "[", "p1mp2", "]"}]}]}], "}"}], ",", 
          RowBox[{"PrecisionGoal", "\[Rule]", "4"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.718729252176402*^9, 3.718729403092366*^9}, {
   3.718729456801025*^9, 3.718729506405163*^9}, {3.7187295740720863`*^9, 
   3.718729576256525*^9}, {3.7187297316487503`*^9, 3.718729732256057*^9}, {
   3.71872989683817*^9, 3.718729899892071*^9}, {3.7187663422782507`*^9, 
   3.718766370430222*^9}, {3.718766431161498*^9, 3.718766432132394*^9}, {
   3.7187664831401243`*^9, 3.7187665798057537`*^9}, {3.718766616386414*^9, 
   3.718766693081765*^9}, 3.718766746020379*^9, {3.7187668411779013`*^9, 
   3.718766848747561*^9}, {3.718767068264965*^9, 3.718767127465562*^9}, {
   3.718767249738348*^9, 3.718767255031466*^9}, {3.718767286822068*^9, 
   3.718767288927518*^9}, {3.718767350717122*^9, 3.718767354634308*^9}, {
   3.718768025616929*^9, 3.718768027940744*^9}, {3.718768069043666*^9, 
   3.718768082974321*^9}, {3.718768136083262*^9, 3.718768140225522*^9}, {
   3.7187681742497253`*^9, 3.7187681958806753`*^9}, {3.718768331647711*^9, 
   3.7187683332749968`*^9}, {3.718786133948534*^9, 3.7187861577599993`*^9}, {
   3.718786209217552*^9, 3.718786211942431*^9}, 3.718786637071437*^9, {
   3.71878699440968*^9, 3.718787001588904*^9}, {3.722691174346634*^9, 
   3.722691328924103*^9}},
 CellLabel->
  "In[967]:=",ExpressionUUID->"ddc0c52b-cc92-4501-a2e3-c3edc1b3b01c"],

Cell["\<\
\tThe pressure is then obtained (restoring the correct dimensions)\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6983826374048*^9, 3.698382653054709*^9}, {
   3.700306802663665*^9, 3.700306803208152*^9}, {3.7003075487543173`*^9, 
   3.7003075492291*^9}, 
   3.7187935099859457`*^9},ExpressionUUID->"94f3d2b8-94a4-419c-90d7-\
0e7decf33a4d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dP", "[", "T_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dP", "[", "T", "]"}], "=", " ", 
    RowBox[{
     RowBox[{"dPa", "[", "T", "]"}], "+", 
     RowBox[{"If", "[", 
      RowBox[{"$CompleteQEDPressure", ",", 
       RowBox[{"dPb", "[", "T", "]"}], ",", "0"}], "]"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"dPI", ":=", 
  RowBox[{"dPI", "=", 
   RowBox[{"Interpolation", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Tv", ",", 
        RowBox[{"dP", "[", "Tv", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Tv", ",", "ListT"}], "}"}]}], "]"}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6980285023258257`*^9, 3.69802852350524*^9}, {
   3.6980285829912987`*^9, 3.698028583371758*^9}, {3.698031580423685*^9, 
   3.6980315818028517`*^9}, 3.6997727591247473`*^9, 3.700307653060481*^9, 
   3.700309133640049*^9, 3.700309510881372*^9, {3.700335195233172*^9, 
   3.7003351956947937`*^9}, {3.7003854899446173`*^9, 3.700385491337368*^9}, {
   3.718770821831674*^9, 3.718770835479063*^9}, {3.7187711845111437`*^9, 
   3.718771188590905*^9}, {3.718774056586678*^9, 3.718774061343934*^9}, {
   3.71877933404496*^9, 3.718779346559517*^9}, {3.718786648002914*^9, 
   3.718786669544897*^9}, {3.718786733750786*^9, 3.718786762352331*^9}, 
   3.718787280766951*^9},
 CellLabel->
  "In[971]:=",ExpressionUUID->"6e2a7394-77d7-4404-b795-456292500ece"]
}, Open  ]],

Cell[CellGroupData[{

Cell["QED energy density corrections", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6980309187633867`*^9, 3.698030924774651*^9}, {
  3.700387812057107*^9, 3.700387813621138*^9}, {3.716369158294015*^9, 
  3.716369162440243*^9}},ExpressionUUID->"2ffba81a-b569-425e-8611-\
f6ca5e3ba17a"],

Cell["\<\
Energy density corrections are obtained from the thermodynamic identity \
\[Rho] = -P + T dP/dT. See Eq. 50 of companion paper.\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"7922e7be-6c36-43d3-9481-4631a9257e34"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "d\[Rho]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Rho]", "[", "T_", "]"}], ":=", 
  RowBox[{
   RowBox[{"d\[Rho]", "[", "T", "]"}], "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"dP", "[", "T", "]"}]}], "+", 
    RowBox[{"T", " ", 
     RowBox[{
      RowBox[{"dPI", "'"}], "[", "T", "]"}]}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.698029804472877*^9, 3.698029821993456*^9}, {
   3.698031588882679*^9, 3.6980315910897617`*^9}, {3.7187867757616796`*^9, 
   3.718786778750635*^9}, 3.7187871147319813`*^9, {3.718787256803596*^9, 
   3.7187872589939938`*^9}},
 CellLabel->
  "In[973]:=",ExpressionUUID->"e6b73ea9-62d8-4d7d-b9bc-13708891261a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["QED modified relativistic degrees of freedom ", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.698030933447967*^9, 3.69803094673423*^9}, {
  3.716005595697619*^9, 3.716005597079631*^9}, {3.716369140196299*^9, 
  3.716369165047804*^9}},ExpressionUUID->"cd97dcfb-3ccf-4347-a209-\
d34ada1ce1c8"],

Cell["\<\
The modified relativistic degrees of freedom (see [Lopez & Turner 1998] for \
definition) are [see also Eq. 52 of companion paper]\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"20fa28a6-ee89-42a6-976b-bbf75c659825"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dgP", "[", "T_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dP", "[", "T", "]"}], 
    FractionBox["90", 
     RowBox[{
      SuperscriptBox["\[Pi]", "2"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"kB", " ", "T"}], ")"}], "4"]}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dg\[Rho]", "[", "T_", "]"}], ":=", 
   RowBox[{
    RowBox[{"d\[Rho]", "[", "T", "]"}], 
    FractionBox["30", 
     RowBox[{
      SuperscriptBox["\[Pi]", "2"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"kB", " ", "T"}], ")"}], "4"]}]]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.698029934951969*^9, 3.698030001396061*^9}, {
  3.69803156084758*^9, 3.698031571579076*^9}, {3.69927497759256*^9, 
  3.6992750109353867`*^9}, {3.699772970021244*^9, 3.699772970680497*^9}},
 CellLabel->
  "In[975]:=",ExpressionUUID->"c453cf12-2ac2-4f7a-bc96-6e4ddf04cdd8"],

Cell["\<\
We interpolate these relativistic degrees of freedom and we store them in a \
file \[OpenCurlyQuote]dg.dat\[CloseCurlyQuote]. If this file is already \
present we do not recompute unless the option $RecomputePlasmaCorrections is \
set to True.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698032416132616*^9, 3.69803242561992*^9}, {
   3.715940597273616*^9, 3.715940624362913*^9}, 3.715961595396015*^9, 
   3.716005404229051*^9, {3.7160054825678463`*^9, 
   3.716005485074541*^9}},ExpressionUUID->"7f46b82a-383c-4fe1-b299-\
7b47c93b52bd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dg\[Rho]dgP", "=", 
    RowBox[{"Check", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"\"\<Interpolations/dg.dat\>\"", ",", "\"\<TSV\>\""}], "]"}], 
      ",", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Precomputed data not found. We recompute and store the \
data.\>\"", "]"}], ";", "$Failed"}], ",", 
      RowBox[{"Import", "::", "nffil"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dg\[Rho]dgP", "\[Equal]", "$Failed"}], "||", 
      "$RecomputePlasmaCorrections"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dg\[Rho]Tab", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"T", ",", 
           RowBox[{"dg\[Rho]", "[", "T", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"T", ",", "ListT"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dgPTab", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"T", ",", 
           RowBox[{"dgP", "[", "T", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"T", ",", "ListT"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dg\[Rho]dgP", "=", 
       RowBox[{"{", 
        RowBox[{"dg\[Rho]Tab", ",", "dgPTab"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
       "\"\<Interpolations/dg.dat\>\"", ",", "dg\[Rho]dgP", ",", 
        "\"\<TSV\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.694054178512896*^9, 3.6940542056232243`*^9}, {
   3.69405423698958*^9, 3.6940542954463*^9}, {3.6940543419859333`*^9, 
   3.694054348130924*^9}, {3.6942772337434187`*^9, 3.694277241261182*^9}, {
   3.694805077667665*^9, 3.69480511477722*^9}, {3.694805155264515*^9, 
   3.694805155368195*^9}, {3.694805248876021*^9, 3.694805288275734*^9}, {
   3.69480534589389*^9, 3.694805367562531*^9}, {3.694805821323741*^9, 
   3.694805842744095*^9}, {3.694806012312744*^9, 3.694806013849859*^9}, {
   3.694806238623993*^9, 3.6948062979530363`*^9}, {3.694807408341463*^9, 
   3.694807409525804*^9}, {3.6948108305946207`*^9, 3.694810949369995*^9}, {
   3.695017648744748*^9, 3.695017649412313*^9}, {3.6950646505296803`*^9, 
   3.695064684108411*^9}, {3.695105129791482*^9, 3.695105131289526*^9}, {
   3.6953533100802917`*^9, 3.695353311718564*^9}, {3.695408836498218*^9, 
   3.69540888734727*^9}, {3.698401794225937*^9, 3.6984018185685167`*^9}, {
   3.69841256759807*^9, 3.698412643829048*^9}, 3.6984140815259247`*^9, {
   3.6993402212301702`*^9, 3.699340221416052*^9}, 3.7003095932838793`*^9, {
   3.7007929763669033`*^9, 3.70079299095426*^9}, {3.7007930398709097`*^9, 
   3.7007930793883753`*^9}, {3.700793234714221*^9, 3.7007932436063747`*^9}, {
   3.700793422624715*^9, 3.700793449738325*^9}, {3.700793585228262*^9, 
   3.7007935854780912`*^9}, 3.700796010401369*^9, {3.715940626929057*^9, 
   3.715940636414083*^9}, 3.715961598378436*^9, 3.7160054042487288`*^9, {
   3.7219673856564207`*^9, 3.721967387990766*^9}},
 CellLabel->
  "In[977]:=",ExpressionUUID->"ad5fd616-48fe-442a-a323-0a4db5d68b66"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9.`*^-6", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwdzWtIU3EAhvHjpDQdSqS23AK30UyQXQyLVQzODIwumramC3Wb6dJMZlJp
bkWmFd6Qck0UMeYOBrGIjssCtSYkTrawQYnO7ow+ncEkiJDS/m8fHn4fH3G1
tbQ2jqKoEtJyJNTACTj6oi/07fAujt4mW1clZnI0y09J5xMddUt22BtvmU0U
cnSXbcfHfOJNsTNpP3E2pTAXehYcVjjp7++AezvbVGpivaioGdbOrd+GD+We
ZXhFMRl/kPjJ+14KdfoaNcz/e+I6dEyHLQai1DXSC9MadUGobJn7DFlh26kK
eDUaga+Uz3/DGHNXUEnMEwuCRmLVk6YI5Lv+JJuIXn6xCGolOo2Z2F5hL4NZ
E2d8sONBNARlQkYeJ+Loc8msFl5QHA3Dhj5fFJ5tPZbAI0pMExLolafmwmFt
5j7oHghrYHpqTwH8cXmzEKqcPSdh84eC0/BWt70Kdh5RnodvSg5ZYYaiuAUa
B6vb4e6VQDf8+ivQD5t2vnTCef+dEXggNjgGl4wzj+CGcNHz//tslIXlPMcU
NOxpDG4hugL+LzCntWYTPn6XnbWVOE69sMDtOsYGeeZLQzBv4+0aNJeuShOI
GrflOGTVNhNceS29Ae1ri/chM8yMw6fun9MwNpRTpCdWZnzXQ8rQ1wWvDcju
lRH/AdLxE24=
  "],
 CellLabel->
  "Out[978]=",ExpressionUUID->"55624e60-128f-4364-938d-986617fde8c6"]
}, Open  ]],

Cell["\<\
We perform an interpolation in time of the modified relativistic degrees of \
freedom\
\>", "Text",
 CellChangeTimes->{{3.715940638451605*^9, 
  3.715940658058362*^9}},ExpressionUUID->"1a8812af-8cbc-475d-9ac0-\
f9e8e24bf63d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dg\[Rho]I", "=", 
   RowBox[{"MyInterpolation", "@", 
    RowBox[{"ToExpression", "[", 
     RowBox[{"dg\[Rho]dgP", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dgPI", "=", 
   RowBox[{"MyInterpolation", "@", 
    RowBox[{"ToExpression", "[", 
     RowBox[{"dg\[Rho]dgP", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.694054178512896*^9, 3.6940542056232243`*^9}, {
   3.69405423698958*^9, 3.6940542954463*^9}, {3.6940543419859333`*^9, 
   3.694054348130924*^9}, {3.6942772337434187`*^9, 3.694277241261182*^9}, {
   3.694805077667665*^9, 3.69480511477722*^9}, {3.694805155264515*^9, 
   3.694805155368195*^9}, {3.694805248876021*^9, 3.694805288275734*^9}, {
   3.69480534589389*^9, 3.694805367562531*^9}, {3.694805821323741*^9, 
   3.694805842744095*^9}, {3.694806012312744*^9, 3.694806013849859*^9}, {
   3.694806238623993*^9, 3.6948062979530363`*^9}, {3.694807408341463*^9, 
   3.694807409525804*^9}, {3.6948108305946207`*^9, 3.694810949369995*^9}, {
   3.695017648744748*^9, 3.695017649412313*^9}, {3.6950646505296803`*^9, 
   3.695064684108411*^9}, {3.695105129791482*^9, 3.695105131289526*^9}, {
   3.6953533100802917`*^9, 3.695353311718564*^9}, {3.695408836498218*^9, 
   3.69540888734727*^9}, {3.698401794225937*^9, 3.6984018185685167`*^9}, {
   3.69841256759807*^9, 3.698412643829048*^9}, 3.6984140815259247`*^9, {
   3.6993402212301702`*^9, 3.699340221416052*^9}, 3.7003095932838793`*^9, {
   3.7007929763669033`*^9, 3.70079299095426*^9}, {3.7007930398709097`*^9, 
   3.7007930793883753`*^9}, {3.700793234714221*^9, 3.7007932436063747`*^9}, {
   3.700793422624715*^9, 3.700793449738325*^9}, {3.700793585228262*^9, 
   3.7007935854780912`*^9}, 3.700796010401369*^9, {3.715940626929057*^9, 
   3.715940636414083*^9}},
 CellLabel->
  "In[979]:=",ExpressionUUID->"9f598df5-aff7-4545-b550-9b163092e4fa"],

Cell[TextData[{
 "We also define functions which are valid everywhere so as to avoid \
numerical problems (indeed at very low and very large temperature ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Delta]g", "\[Rho]"], TraditionalForm]],ExpressionUUID->
  "0c4c3842-063e-47d7-86e4-08fb45b0820e"],
 "and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Delta]g", "P"], " ", "are", " ", "constants"}], 
   TraditionalForm]],ExpressionUUID->"a0981b15-609e-4dda-84fb-e94d1f6b4ebd"],
 ")."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698412718269717*^9, 3.6984127295690403`*^9}, {
  3.715940674988702*^9, 
  3.715940716623172*^9}},ExpressionUUID->"072f1082-a2fd-4e02-b621-\
32c42d161f8c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dg\[Rho]N", "[", 
    RowBox[{"T_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"T", "<", "Tf"}], ",", "0", ",", 
     RowBox[{"T", "\[LessEqual]", "Ti"}], " ", ",", 
     RowBox[{"dg\[Rho]I", "[", "T", "]"}], ",", 
     RowBox[{"T", ">", "Ti"}], ",", 
     RowBox[{"dg\[Rho]I", "[", "Ti", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dgPN", "[", 
    RowBox[{"T_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"T", "<", "Tf"}], ",", "0", ",", 
     RowBox[{"T", "\[LessEqual]", "Ti"}], " ", ",", 
     RowBox[{"dgPI", "[", "T", "]"}], ",", 
     RowBox[{"T", ">", "Ti"}], ",", 
     RowBox[{"dgPI", "[", "Ti", "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.698032456967169*^9, 3.698032536496331*^9}},
 CellLabel->
  "In[981]:=",ExpressionUUID->"c6a233f3-eeb6-4b82-b980-c393f54492f3"],

Cell[TextData[{
 "We define the relativistic degrees of freedom in function of inverse \
temperature (in units of electron mass), that is a functions of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    RowBox[{
     SubscriptBox["m", "e"], "/", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["k", "B"], "T"}], ")"}], "."}]}]}], TraditionalForm]],
  ExpressionUUID->"e5e14893-ddd9-4b27-be3e-ff69782abd19"]
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.69803231924218*^9, 3.698032338836384*^9}, 
   3.698384648960239*^9, {3.7159407226775913`*^9, 
   3.715940734312323*^9}},ExpressionUUID->"f2341878-092f-4f93-af0a-\
b3df14297804"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dg\[Rho]x", "[", "x_", "]"}], ":=", 
   RowBox[{"dg\[Rho]N", "[", 
    FractionBox["me", 
     RowBox[{"(", 
      RowBox[{"kB", " ", "x"}], ")"}]], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dgPx", "[", "x_", "]"}], ":=", 
   RowBox[{"dgPN", "[", 
    FractionBox["me", 
     RowBox[{"(", 
      RowBox[{"kB", " ", "x"}], ")"}]], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.698031849030167*^9, 3.698031873612311*^9}, 
   3.698032431950276*^9, {3.698032567001779*^9, 3.698032570182501*^9}, {
   3.699772764530953*^9, 3.69977276483302*^9}, {3.699772971448172*^9, 
   3.69977297173483*^9}, {3.722691764114728*^9, 3.7226917747516603`*^9}},
 CellLabel->
  "In[983]:=",ExpressionUUID->"8f46e5c2-03b1-4b22-9325-6f4a6e88441f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Entropy and energy density of the plasma", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.693922764557732*^9, 3.693922769892323*^9}, {
  3.693930518572475*^9, 3.693930519743701*^9}, {3.700387826558313*^9, 
  3.700387831607513*^9}, {3.7003878800156*^9, 
  3.7003878874133797`*^9}},ExpressionUUID->"66386419-2718-4bdc-a558-\
40fc16e1fe0b"],

Cell["\<\
We compute the thermodynamics using thermodynamical equilibrium. Indeed if we \
assume total neutrino decoupling then the collision rates inside the \
electrons/protons/photons plasma are so high that it is always both at \
thermal and chemical equilibrium. 

Furthermore there are so many more photons than baryons today that the \
chemical potential of electrons and positrons can be ignored. See companion \
paper for a discussion on the chemical potentials of electrons/psoitrons.
\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6983850952666197`*^9, 3.698385169323306*^9}, {
  3.6983852094991817`*^9, 3.698385224257792*^9}, {3.714196731185446*^9, 
  3.7141967323886538`*^9}, {3.715940892372868*^9, 
  3.715940937416699*^9}},ExpressionUUID->"216964d7-8021-4975-a016-\
9a323559dd8b"],

Cell["We have two functions to tabulate. ", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.693928557881199*^9, 3.6939285688686943`*^9}, {
  3.6939293174112463`*^9, 3.693929328442032*^9}, {3.694768428610293*^9, 
  3.6947684316968203`*^9}, {3.6983852376225986`*^9, 3.698385364738121*^9}, {
  3.7226853735056553`*^9, 3.72268540480135*^9}, {3.7226854473716497`*^9, 
  3.722685447846313*^9}},ExpressionUUID->"b9db7730-9905-457f-8e96-\
2cf7ba232f1a"],

Cell["\<\
The first function, gives the extra amount of entropy at high temperature due \
to electrons and positrons, in units of the entropy of photons. 
It is noted \[ScriptCapitalS] in the companion paper (Eq. 30b). We \
distinguish the case with and without QED plasma corrections (See Eq. 50 for \
QED plasma corrections).\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"855106c0-f02d-4090-89a4-abee156abc2e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DSTNoQED", "=", 
   RowBox[{"MyInterpolation", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", "=", 
            RowBox[{"me", "/", 
             RowBox[{"(", 
              RowBox[{"kB", " ", "T"}], ")"}]}]}], "}"}], ",", 
          RowBox[{"1", "+", 
           RowBox[{
            FractionBox["45", 
             RowBox[{"2", 
              SuperscriptBox["\[Pi]", "4"]}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["1", "3"], 
               RowBox[{
                RowBox[{
                 RowBox[{"Imn", "[", "1", "]"}], "[", 
                 RowBox[{"0", ",", "3"}], "]"}], "[", "x", "]"}]}], "+", 
              RowBox[{
               RowBox[{
                RowBox[{"Imn", "[", "1", "]"}], "[", 
                RowBox[{"2", ",", "1"}], "]"}], "[", "x", "]"}]}], 
             ")"}]}]}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"T", ",", "ListT"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DSTQED", "[", "Tv_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", 
         RowBox[{"dg\[Rho]N", "[", "Tv", "]"}]}], "+", 
        RowBox[{"dgPN", "[", "Tv", "]"}]}], ")"}], "/", "8"}], "+", 
     RowBox[{"DSTNoQED", "[", "Tv", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DST", "[", "Tv_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{"$QEDPlasmaCorrections", ",", 
    RowBox[{"DSTQED", "[", "Tv", "]"}], ",", 
    RowBox[{"DSTNoQED", "[", "Tv", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DSTN", "[", 
    RowBox[{"T_", "?", "NumericQ"}], "]"}], "=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"T", "<", "Tf"}], ",", "1", ",", 
     RowBox[{"T", "\[LessEqual]", "Ti"}], " ", ",", 
     RowBox[{"DST", "[", "T", "]"}], ",", 
     RowBox[{"T", ">", "Ti"}], ",", 
     RowBox[{"DST", "[", "Ti", "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6998131204724283`*^9, 3.6998131755066833`*^9}, {
   3.699813302254125*^9, 3.699813322974454*^9}, {3.699813375019024*^9, 
   3.6998133922027893`*^9}, {3.699813462086609*^9, 3.699813479969481*^9}, {
   3.699813604759953*^9, 3.699813623812809*^9}, {3.699889604517396*^9, 
   3.699889641919241*^9}, 3.699889765787114*^9, {3.7159410878970757`*^9, 
   3.715941100508533*^9}, {3.715941352113529*^9, 3.715941355151231*^9}, {
   3.7160173157611647`*^9, 3.71601735916241*^9}, {3.716095690469521*^9, 
   3.7160957148400917`*^9}, {3.717749724534618*^9, 3.717749738559895*^9}, {
   3.7177497890916433`*^9, 3.7177497902207117`*^9}, {3.718442615364994*^9, 
   3.718442630295938*^9}, {3.7184426642964687`*^9, 3.718442746365823*^9}, {
   3.718442830863585*^9, 3.7184428408872223`*^9}, {3.7185559683127327`*^9, 
   3.718556019961598*^9}, {3.718607588983234*^9, 3.718607607984687*^9}, {
   3.718607808368328*^9, 3.718607813325123*^9}, {3.718787494608883*^9, 
   3.718787502172883*^9}, {3.718788004087413*^9, 3.718788041718337*^9}, 
   3.718788107886853*^9, {3.722691793197187*^9, 3.722691795800935*^9}},
 CellLabel->
  "In[985]:=",ExpressionUUID->"0aba7972-9003-4c4c-abd1-59075c277b38"],

Cell["\<\
The second function, gives the extra amount of energy density at high \
temperature due to electrons and positrons, in units of the energy density of \
photons. 
It is noted \[ScriptCapitalE] in the companion paper in Eq. 41b. We \
distinguish the case with and without QED plasma corrections (see Eq. 58 QED \
plasma corrections).\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"84bff0a6-6a95-4a69-afed-7d38ac95801e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"D\[Rho]TNoQED", "=", 
   RowBox[{"MyInterpolation", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", "=", 
            RowBox[{"me", "/", 
             RowBox[{"(", 
              RowBox[{"kB", " ", "T"}], ")"}]}]}], "}"}], ",", 
          RowBox[{
           FractionBox["30", 
            SuperscriptBox["\[Pi]", "4"]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Imn", "[", "1", "]"}], "[", 
              RowBox[{"2", ",", "1"}], "]"}], "[", "x", "]"}], ")"}]}]}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"T", ",", "ListT"}], "}"}]}], "]"}]}]}], ";", 
  RowBox[{
   RowBox[{"D\[Rho]T", "[", "T_", "]"}], ":=", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{"$QEDPlasmaCorrections", ",", 
      FractionBox[
       RowBox[{"dg\[Rho]N", "[", "T", "]"}], "2"], ",", "0"}], "]"}], "+", 
    RowBox[{"D\[Rho]TNoQED", "[", "T", "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6998131204724283`*^9, 3.6998131755066833`*^9}, {
   3.699813302254125*^9, 3.699813322974454*^9}, {3.699813375019024*^9, 
   3.6998133922027893`*^9}, {3.699813462086609*^9, 3.699813479969481*^9}, {
   3.699813604759953*^9, 3.699813623812809*^9}, {3.699889604517396*^9, 
   3.699889641919241*^9}, 3.699889765787114*^9, {3.7159410878970757`*^9, 
   3.715941100508533*^9}, {3.715941352113529*^9, 3.715941355151231*^9}, {
   3.7160173157611647`*^9, 3.71601735916241*^9}, {3.716095690469521*^9, 
   3.7160957148400917`*^9}, {3.717749724534618*^9, 3.717749738559895*^9}, {
   3.7177497890916433`*^9, 3.7177497902207117`*^9}, {3.718442615364994*^9, 
   3.718442630295938*^9}, {3.7184426642964687`*^9, 3.718442746365823*^9}, {
   3.718442830863585*^9, 3.7184428408872223`*^9}, {3.7185559683127327`*^9, 
   3.718556019961598*^9}, {3.718607588983234*^9, 3.718607607984687*^9}, {
   3.718607808368328*^9, 3.718607813325123*^9}, {3.718787494608883*^9, 
   3.718787502172883*^9}, {3.718788004087413*^9, 3.7187880324459333`*^9}},
 CellLabel->
  "In[989]:=",ExpressionUUID->"49fd6727-f4bb-4a9a-861a-a1937dc552a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Incomplete Neutrino Decoupling and Scale Factor Determination\
\>", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.693922764557732*^9, 3.693922769892323*^9}, {
  3.693930518572475*^9, 3.693930519743701*^9}, {3.700387826558313*^9, 
  3.700387831607513*^9}, {3.7003878800156*^9, 3.7003878874133797`*^9}, {
  3.7722618333374863`*^9, 3.772261837899806*^9}, {3.772875107087057*^9, 
  3.772875124718308*^9}},ExpressionUUID->"1aa422d6-e018-46c7-ac33-\
447138896fcf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Print", "[", "\"\<[PrimiCosmo]: Integrating the Cosmology\>\"", "]"}], 
  "*)"}]], "Code",
 CellChangeTimes->{{3.772876678470298*^9, 3.772876697910817*^9}, 
   3.7731765608481493`*^9},ExpressionUUID->"1f406f72-10ea-4c3a-94b0-\
c0432c7cda42"],

Cell[BoxData["\<\"[PrimiCosmo]: Integrating the Cosmology\"\>"], "Print",
 CellChangeTimes->{3.772953203169263*^9, 3.7729532728822613`*^9, 
  3.772953678228195*^9, 3.7729557869684362`*^9},
 CellLabel->
  "During evaluation of \
In[990]:=",ExpressionUUID->"68761b1a-acb0-48fc-a053-adf3830b2501"]
}, Open  ]],

Cell[TextData[{
 "We now execute the relevant cosmological evolution depending on the flag ",
 StyleBox["$EvolutionType", "Input"],
 ". This leads to the execution of one of three different .m files located in \
the same directory."
}], "Text",
 CellChangeTimes->{{3.7723607700514936`*^9, 3.772360795577806*^9}, {
  3.772362083093342*^9, 3.772362102235302*^9}, {3.77287510356608*^9, 
  3.772875199538288*^9}},ExpressionUUID->"19d9d409-a983-4dcc-8085-\
638080b85ac0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"$EvolutionType", " ", "\[Equal]", " ", "\"\<SBBN\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SomeFunc", "[", "TmgStart", "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"$EvolutionType", " ", "\[Equal]", " ", "\"\<Neff\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SomeFunc", "[", 
     RowBox[{"TmgStart", ",", "\[CapitalDelta]Neffective"}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"$EvolutionType", " ", "\[Equal]", " ", "\"\<WIMP\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SomeFunc", "[", 
     RowBox[{
     "TmgStart", ",", "CASE", ",", "SPIN", ",", "gDM", ",", "MDM", ",", 
      "\[Sigma]v", ",", "BR"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Code",
 CellChangeTimes->{{3.772875309777561*^9, 3.772875368111314*^9}, {
   3.772876706929473*^9, 3.772876730973881*^9}, {3.772877017736635*^9, 
   3.772877019289784*^9}, {3.772953178773017*^9, 3.77295317999892*^9}, {
   3.7729571843652287`*^9, 3.772957187338192*^9}, {3.772957259893663*^9, 
   3.7729572602244368`*^9}, {3.773073147700469*^9, 3.773073169852208*^9}, {
   3.773081344867708*^9, 3.773081365517057*^9}, 3.773082093685523*^9, 
   3.7730838551170053`*^9, {3.773085201937951*^9, 3.7730852021551237`*^9}, {
   3.773389137403029*^9, 3.7733891381749897`*^9}, {3.77347045676306*^9, 
   3.773470467048814*^9}, {3.7734705093686533`*^9, 3.7734705115421343`*^9}, {
   3.773470556516708*^9, 3.773470556657151*^9}, 3.7734712049716043`*^9, {
   3.7735557263688374`*^9, 3.7735557636285477`*^9}, {3.773557361613934*^9, 
   3.773557362268656*^9}},ExpressionUUID->"35cbcbd0-80ef-4d24-8d61-\
459bd2269b53"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(N\\), \\(eff\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "4.674972019763186`"}],
  SequenceForm["\!\(\*SubscriptBox[\(N\), \(eff\)]\) = ", 4.674972019763186],
  Editable->False]], "Print",
 CellChangeTimes->{3.772953298630467*^9, 3.772953718648044*^9, 
  3.772955824760243*^9, 3.772956246508749*^9, 3.772956538150676*^9, 
  3.7729569859996223`*^9, 3.772957241948057*^9, 3.7729573633208847`*^9, 
  3.772957542541718*^9},
 CellLabel->
  "During evaluation of \
In[1170]:=",ExpressionUUID->"f90d509f-18fd-4c15-baa8-ea7a4d439a1d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"z\[Gamma] = \"\>", "\[InvisibleSpace]", "1.3978532645134438`"}],
  SequenceForm["z\[Gamma] = ", 1.3978532645134438`],
  Editable->False]], "Print",
 CellChangeTimes->{3.772953298630467*^9, 3.772953718648044*^9, 
  3.772955824760243*^9, 3.772956246508749*^9, 3.772956538150676*^9, 
  3.7729569859996223`*^9, 3.772957241948057*^9, 3.7729573633208847`*^9, 
  3.7729575425431213`*^9},
 CellLabel->
  "During evaluation of \
In[1170]:=",ExpressionUUID->"c3b7b15f-1015-421a-a3a9-27e3110e510a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"z\[Nu] = \"\>", "\[InvisibleSpace]", "1.1147604740922084`"}],
  SequenceForm["z\[Nu] = ", 1.1147604740922084`],
  Editable->False]], "Print",
 CellChangeTimes->{3.772953298630467*^9, 3.772953718648044*^9, 
  3.772955824760243*^9, 3.772956246508749*^9, 3.772956538150676*^9, 
  3.7729569859996223`*^9, 3.772957241948057*^9, 3.7729573633208847`*^9, 
  3.772957542544652*^9},
 CellLabel->
  "During evaluation of \
In[1170]:=",ExpressionUUID->"ae899c41-0065-4a2e-94da-358bcd92f4bc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"T\[Gamma]/T\[Nu] = \"\>", "\[InvisibleSpace]", 
   "1.253949433084958`"}],
  SequenceForm["T\[Gamma]/T\[Nu] = ", 1.253949433084958],
  Editable->False]], "Print",
 CellChangeTimes->{3.772953298630467*^9, 3.772953718648044*^9, 
  3.772955824760243*^9, 3.772956246508749*^9, 3.772956538150676*^9, 
  3.7729569859996223`*^9, 3.772957241948057*^9, 3.7729573633208847`*^9, 
  3.772957542545413*^9},
 CellLabel->
  "During evaluation of \
In[1170]:=",ExpressionUUID->"e6281c07-fc9d-4de2-a7cc-28763f1fa81e"]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "We generate the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "\[Nu]"], "/", "T"}], TraditionalForm]],ExpressionUUID->
  "f78e4a5f-e6db-4392-922e-3a3de636a8ff"],
 " table for interpolation of the weak rates."
}], "Text",
 CellChangeTimes->{{3.772875204521592*^9, 
  3.772875222918612*^9}},ExpressionUUID->"f2dedb06-e5d9-4a25-b2d2-\
b4a64ea32ada"],

Cell[BoxData[
 RowBox[{
  RowBox[{"T\[Nu]overTTable", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"T\[Nu]overT", "[", 
        RowBox[{"ListT", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", " ", 
       RowBox[{"ListT", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ListT", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.772360799935207*^9, 3.772360822683343*^9}, {
   3.7723608717669163`*^9, 3.77236088298453*^9}, {3.7723621082707167`*^9, 
   3.772362125266264*^9}, {3.7723709294250717`*^9, 3.772370932723908*^9}, {
   3.772788243120042*^9, 3.772788278640338*^9}, {3.772875073516903*^9, 
   3.77287510109689*^9}, 3.772956092450425*^9, 3.772956596515018*^9},
 CellLabel->
  "In[1173]:=",ExpressionUUID->"c10937ff-af93-4d69-8ced-28730c785571"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Weak reactions n+\[Nu] \[LeftRightArrow] p+e", "Chapter",
 InitializationCell->True,
 CellChangeTimes->{{3.694060206117031*^9, 3.694060210202235*^9}, {
   3.694808379659048*^9, 3.694808387691044*^9}, {3.694812468826827*^9, 
   3.694812469928029*^9}, {3.695016053516116*^9, 3.695016062220394*^9}, 
   3.696566172631031*^9, {3.700389903273973*^9, 3.700389947501128*^9}, 
   3.715943552318153*^9, {3.717740021457979*^9, 3.717740022868803*^9}, {
   3.722691004110499*^9, 3.722691005032468*^9}, 
   3.722767008268943*^9},ExpressionUUID->"d964d11c-5c10-482c-8d1a-\
914a04748af6"],

Cell[CellGroupData[{

Cell["Distribution functions derivatives", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.695399796918549*^9, 3.695399804547086*^9}, {
  3.6965665683483*^9, 3.696566568511149*^9}, {3.6980276769156933`*^9, 
  3.698027678104094*^9}},ExpressionUUID->"0f1bca87-7de7-421d-8d15-\
280d01a42377"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Print", "[", "\"\<[PrimiCosmo]: Computing Weak rates\>\"", "]"}], 
  "*)"}]], "Code",
 CellChangeTimes->{{3.7728767385713253`*^9, 3.772876750630808*^9}, 
   3.773176566784172*^9},ExpressionUUID->"bc00aee4-c0c5-44ea-bc02-\
a0a693e20274"],

Cell[BoxData["\<\"[PrimiCosmo]: Computing Weak rates\"\>"], "Print",
 CellChangeTimes->{3.772953299446477*^9, 3.772953719815667*^9, 
  3.7729558282331467`*^9, 3.772957575292742*^9},
 CellLabel->
  "During evaluation of \
In[1174]:=",ExpressionUUID->"c40e25fa-6e6e-4c24-9dd9-4d428a342c17"]
}, Open  ]],

Cell[TextData[{
 "These Fermi-Dirac function and its derivatives are needed further. en \
stands for energy. x for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["k", "B"], "T"}]}]}], TraditionalForm]],ExpressionUUID->
  "95e59d5b-2ff0-44fe-9fde-323ab4d31b67"],
 "). \n\nFDeipj means that it is the Fermi Dirac distribution multiplied by \
Energy^i and derived j times wrt to Energy. See Def B25 in companion paper."
}], "Text",
 InitializationCell->
  True,ExpressionUUID->"e328805b-93d5-4662-8d98-fa2f411f6f8c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FDe2p0", "[", 
    RowBox[{"en_", ",", "x_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"FD", "[", 
      RowBox[{"en", ",", "x"}], "]"}], 
     RowBox[{"en", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDe3p0", "[", 
    RowBox[{"en_", ",", "x_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"FD", "[", 
      RowBox[{"en", ",", "x"}], "]"}], 
     RowBox[{"en", "^", "3"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FDe2p2", "[", 
     RowBox[{"en_", ",", "x_"}], "]"}], "=", 
    RowBox[{"Simplify", "@", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FD", "[", 
           RowBox[{"en", ",", "x"}], "]"}], 
          RowBox[{"en", "^", "2"}]}], ",", "en"}], "]"}], ",", "en"}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDe3p2", "[", 
    RowBox[{"en_", ",", "x_"}], "]"}], "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FD", "[", 
          RowBox[{"en", ",", "x"}], "]"}], 
         RowBox[{"en", "^", "3"}]}], ",", "en"}], "]"}], ",", "en"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDe4p2", "[", 
    RowBox[{"en_", ",", "x_"}], "]"}], "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FD", "[", 
          RowBox[{"en", ",", "x"}], "]"}], 
         RowBox[{"en", "^", "4"}]}], ",", "en"}], "]"}], ",", "en"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDe2p1", "[", 
    RowBox[{"en_", ",", "x_"}], "]"}], "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FD", "[", 
        RowBox[{"en", ",", "x"}], "]"}], 
       RowBox[{"en", "^", "2"}]}], ",", "en"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDe3p1", "[", 
    RowBox[{"en_", ",", "x_"}], "]"}], "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FD", "[", 
        RowBox[{"en", ",", "x"}], "]"}], 
       RowBox[{"en", "^", "3"}]}], ",", "en"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDe4p1", "[", 
    RowBox[{"en_", ",", "x_"}], "]"}], "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FD", "[", 
        RowBox[{"en", ",", "x"}], "]"}], 
       RowBox[{"en", "^", "4"}]}], ",", "en"}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6962548077495203`*^9, 3.696254829946494*^9}, {
   3.696254930949256*^9, 3.696254940984586*^9}, {3.6962549727119102`*^9, 
   3.696255060402851*^9}, {3.6962560411769037`*^9, 3.696256044436181*^9}, {
   3.696256280782392*^9, 3.696256285660963*^9}, {3.69625651704494*^9, 
   3.696256535199955*^9}, {3.696259136503159*^9, 3.6962591441393757`*^9}, 
   3.6965782962743692`*^9, {3.7003135816154213`*^9, 3.700313598424588*^9}, {
   3.7003321163736687`*^9, 3.700332128139174*^9}},
 CellLabel->
  "In[1175]:=",ExpressionUUID->"48f58606-6dc9-4994-a945-898d6c09b46a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FD\[Nu]e2p0", "[", 
    RowBox[{"en_", ",", "\[Phi]_", ",", "x_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"FD\[Nu]", "[", 
      RowBox[{"en", ",", "\[Phi]", ",", "x"}], "]"}], 
     RowBox[{"en", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FD\[Nu]e3p0", "[", 
    RowBox[{"en_", ",", "\[Phi]_", ",", "x_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"FD\[Nu]", "[", 
      RowBox[{"en", ",", "\[Phi]", ",", "x"}], "]"}], 
     RowBox[{"en", "^", "3"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FD\[Nu]e2p2", "[", 
     RowBox[{"en_", ",", "\[Phi]_", ",", "x_"}], "]"}], "=", 
    RowBox[{"Simplify", "@", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FD\[Nu]", "[", 
           RowBox[{"en", ",", "\[Phi]", ",", "x"}], "]"}], 
          RowBox[{"en", "^", "2"}]}], ",", "en"}], "]"}], ",", "en"}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FD\[Nu]e3p2", "[", 
    RowBox[{"en_", ",", "\[Phi]_", ",", "x_"}], "]"}], "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FD\[Nu]", "[", 
          RowBox[{"en", ",", "\[Phi]", ",", "x"}], "]"}], 
         RowBox[{"en", "^", "3"}]}], ",", "en"}], "]"}], ",", "en"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FD\[Nu]e4p2", "[", 
    RowBox[{"en_", ",", "\[Phi]_", ",", "x_"}], "]"}], "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FD\[Nu]", "[", 
          RowBox[{"en", ",", "\[Phi]", ",", "x"}], "]"}], 
         RowBox[{"en", "^", "4"}]}], ",", "en"}], "]"}], ",", "en"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FD\[Nu]e2p1", "[", 
    RowBox[{"en_", ",", "\[Phi]_", ",", "x_"}], "]"}], "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FD\[Nu]", "[", 
        RowBox[{"en", ",", "\[Phi]", ",", "x"}], "]"}], 
       RowBox[{"en", "^", "2"}]}], ",", "en"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FD\[Nu]e3p1", "[", 
    RowBox[{"en_", ",", "\[Phi]_", ",", "x_"}], "]"}], "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FD\[Nu]", "[", 
        RowBox[{"en", ",", "\[Phi]", ",", "x"}], "]"}], 
       RowBox[{"en", "^", "3"}]}], ",", "en"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FD\[Nu]e4p1", "[", 
    RowBox[{"en_", ",", "\[Phi]_", ",", "x_"}], "]"}], "=", 
   RowBox[{"Simplify", "@", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FD\[Nu]", "[", 
        RowBox[{"en", ",", "\[Phi]", ",", "x"}], "]"}], 
       RowBox[{"en", "^", "4"}]}], ",", "en"}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6962548077495203`*^9, 3.696254829946494*^9}, {
   3.696254930949256*^9, 3.696254940984586*^9}, {3.6962549727119102`*^9, 
   3.696255060402851*^9}, {3.6962560411769037`*^9, 3.696256044436181*^9}, {
   3.696256280782392*^9, 3.696256285660963*^9}, {3.69625651704494*^9, 
   3.696256535199955*^9}, {3.696259136503159*^9, 3.6962591441393757`*^9}, 
   3.6965782962743692`*^9, {3.7003135816154213`*^9, 3.700313598424588*^9}, {
   3.7003321163736687`*^9, 3.700332128139174*^9}, {3.7198118623719883`*^9, 
   3.719811924944447*^9}},
 CellLabel->
  "In[1183]:=",ExpressionUUID->"acc173a4-c2b6-4300-bbc4-b76194bad307"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox["\[Lambda]", "0"]], "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.69481069087228*^9, 3.694810712927627*^9}, {
  3.696566292977865*^9, 
  3.696566296743393*^9}},ExpressionUUID->"7db62c4d-d0a1-406a-b642-\
972265f94513"],

Cell[CellGroupData[{

Cell[TextData[{
 "Born approximation ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "0"], TraditionalForm]],ExpressionUUID->
  "8feb8a36-0b2d-4e40-9dfa-22e8a1ebd799"]
}], "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.696566306494878*^9, 3.696566310596146*^9}, {
  3.700387972289407*^9, 
  3.70038797497539*^9}},ExpressionUUID->"0ebe464d-2abb-45dc-8c30-\
e20131b21959"],

Cell["\<\
See e.g. Eq. 13 of [Lopez & Turner 1998]. Or Eq. 92 of companion paper.\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"17edc3fc-3c31-42b0-be46-e15b33c894cf"],

Cell[TextData[{
 "The constant ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "0"], TraditionalForm]],ExpressionUUID->
  "3d41ed15-90e0-4369-8518-776d44b37d4a"],
 " is a proxy for ",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Tau]", "n"], 
      RowBox[{"-", "1"}]], "=", " ", 
     RowBox[{
      SubscriptBox["\[Lambda]", "0"], "*", " ", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["cos", "2"], "(", 
         SubscriptBox["\[Theta]", "c"], ")"}], 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           SubscriptBox["G", "F"], "2"], "(", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["C", "V"], "2"], "+", 
           RowBox[{"3", 
            SuperscriptBox[
             SubscriptBox["C", "A"], "2"]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           SuperscriptBox["\[Pi]", "3"]}], ")"}]}]}], " ", "]"}], " "}]}]}], 
   TraditionalForm]],ExpressionUUID->"efbf4172-1249-4838-ae01-70043695f278"]
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698387530007309*^9, 3.698387613701531*^9}, {
  3.6983876917675877`*^9, 3.6983877065592957`*^9}, {3.698398072422778*^9, 
  3.69839808763146*^9}, {3.722261259234441*^9, 3.722261259234477*^9}, {
  3.722691029497995*^9, 
  3.7226910459863253`*^9}},ExpressionUUID->"cd7902be-680e-4bfa-939a-\
2074fdbe3ec5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]BORN", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", "=", 
       RowBox[{"Q", "/", "me"}]}], "}"}], ",", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"en", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"en", "-", "q"}], ")"}], "2"], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["en", "2"], "-", "1"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"en", ",", "1", ",", "q"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.694006257659293*^9, 3.694006346204317*^9}, {
   3.6940064029664087`*^9, 3.6940064070694933`*^9}, {3.694006468173711*^9, 
   3.694006484210821*^9}, {3.694007003809126*^9, 3.694007029760737*^9}, {
   3.694007381028921*^9, 3.6940074098437347`*^9}, {3.694060222058585*^9, 
   3.694060246157043*^9}, 3.694060817391576*^9, {3.694278732807159*^9, 
   3.6942787473988733`*^9}, {3.694280123443388*^9, 3.694280130047604*^9}, 
   3.6942801631666203`*^9, {3.694325166069244*^9, 3.694325180413692*^9}, {
   3.694799704536366*^9, 3.69479976061983*^9}, {3.69480126227081*^9, 
   3.6948012624849157`*^9}, {3.694804871338216*^9, 3.694804892175321*^9}, 
   3.69480897884659*^9, {3.694810640364388*^9, 3.694810642362398*^9}, {
   3.694810676962716*^9, 3.694810735849601*^9}, {3.695016085599865*^9, 
   3.695016086345427*^9}, {3.695016309327468*^9, 3.695016312774036*^9}, {
   3.695070052272225*^9, 3.6950700535186663`*^9}, {3.698386531949038*^9, 
   3.698386532634213*^9}, {3.699586058148191*^9, 3.699586058427009*^9}, {
   3.699591119216988*^9, 3.699591121606031*^9}, 3.6997727820468283`*^9, {
   3.700309778320406*^9, 3.700309779544766*^9}, {3.700310836090979*^9, 
   3.700310840290208*^9}, 3.722258592810293*^9, {3.722691052789864*^9, 
   3.7226910762574253`*^9}, 3.7728755051414347`*^9},
 CellLabel->
  "In[1191]:=",ExpressionUUID->"a433a40c-204f-4fa2-bbcc-99b2a442479c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Corrections", " ", "to", " ", 
  SubscriptBox["\[Lambda]", "0"]}]], "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.696281894989002*^9, 3.6962819038309927`*^9}, {
   3.696282120666729*^9, 3.6962821228536158`*^9}, 3.696566180742605*^9, 
   3.696566314758239*^9, 3.696569002674088*^9},
 FontFamily->"Arial",ExpressionUUID->"fd382002-c6cb-449d-81c6-eeec94e88b58"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Radiative", " ", "corrections", " ", "to", "  ", 
  SubscriptBox["\[Lambda]", "0"], " "}]], "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.69481069087228*^9, 3.694810727641842*^9}, {
   3.696282140354711*^9, 3.696282142052696*^9}, {3.696283233589775*^9, 
   3.696283234469832*^9}, {3.6962832672231216`*^9, 3.6962832756173277`*^9}, {
   3.696283398283362*^9, 3.696283399322384*^9}, {3.6965663542022038`*^9, 
   3.696566354890465*^9}, 
   3.6965690095001993`*^9},ExpressionUUID->"2a02a048-297c-447d-9c4a-\
6347e976088a"],

Cell["\<\
1) If $ResummedLogsRadiativeCorrections=False, we use Eq. 7 of  [Czarnecki et \
al. 2004] which is B30 of companion paper.
 Combined with Eq 20b of [Sirlin 1967] for Sirlin\[CloseCurlyQuote]s \
universal function, that is Eq. B32 in companion paper.\
\>", "Text",ExpressionUUID->"484f13e7-decc-490f-83fe-33843daa8283"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AgCzarnecki", "=", 
   RowBox[{"-", "0.34"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CCzarnecki", "=", "0.891"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mA", "=", 
   RowBox[{"1.2", " ", "GeV"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConstantSirlin", " ", "=", 
   RowBox[{
    RowBox[{"4", 
     RowBox[{"Log", "[", 
      RowBox[{
       SubscriptBox["m", "Z"], "/", "mp"}], "]"}]}], "+", 
    RowBox[{"Log", "[", 
     RowBox[{"mp", "/", "mA"}], "]"}], "+", 
    RowBox[{"2", "CCzarnecki"}], "+", "AgCzarnecki"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7167234426189003`*^9, 3.7167234974353867`*^9}, {
   3.716723561910112*^9, 3.7167235872808847`*^9}, {3.716723680329027*^9, 
   3.716723700249174*^9}, 3.716738465316805*^9, {3.71749095427195*^9, 
   3.7174909566655607`*^9}, 3.717492414687127*^9, {3.717494903359128*^9, 
   3.717494904303647*^9}, {3.717495036742869*^9, 3.717495083853333*^9}, {
   3.717496372833338*^9, 3.71749637320177*^9}, {3.717581556116226*^9, 
   3.717581556693223*^9}, 3.722320070326476*^9, 3.7223202139255342`*^9},
 CellLabel->
  "In[1192]:=",ExpressionUUID->"14d4ed3b-fd1d-4560-b8e7-8f96eccafc18"],

Cell["\<\
For information, this quantity is evaluated to 40 in [Dicus et al.]\
\>", "Text",
 CellChangeTimes->{{3.7226923224029303`*^9, 
  3.722692348752975*^9}},ExpressionUUID->"46d13898-5611-4f0b-a417-\
f33f28c6d04b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Rd", "[", "x_", "]"}], ":=", 
   FractionBox[
    RowBox[{"ArcTanh", "[", "x", "]"}], "x"]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.69479775483272*^9, 3.694797841469452*^9}, {
  3.69479844499338*^9, 3.694798447609345*^9}, {3.694798970345092*^9, 
  3.694798972584804*^9}, {3.694799024460381*^9, 3.694799027000093*^9}, {
  3.6950685108769283`*^9, 3.695068532615596*^9}, {3.695070331038*^9, 
  3.695070333120483*^9}, {3.696568953509018*^9, 3.696568953790408*^9}, {
  3.698437536473714*^9, 3.69843753847952*^9}},
 CellLabel->
  "In[1196]:=",ExpressionUUID->"6b95bfb1-95bf-420b-a45a-ead321e0a570"],

Cell[TextData[{
 "NB : ArcTanh[x] = 1/2 Log[",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", "x"}], ")"}]], TraditionalForm]],ExpressionUUID->
  "03c75d77-0624-463c-b6ab-8d035ae3a6b8"],
 "]"
}], "Text",
 CellChangeTimes->{{3.716787218647456*^9, 3.7167872323756247`*^9}, {
  3.722692270687523*^9, 
  3.722692281118238*^9}},ExpressionUUID->"f2dbfe32-01da-4a32-9ed2-\
66e96b67fe5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Lfun", "[", "x_", "]"}], "=", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"Log", "[", 
        RowBox[{"1", "-", "t"}], "]"}], "t"], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "x"}], "}"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{
        RowBox[{"x", "<", "1"}], "&&", 
        RowBox[{"x", ">", "0"}]}]}]}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Lfun", " ", "is", " ", "called", " ", "the", " ", "Spence", " ", 
    "function"}], " ", "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.695019761668738*^9, 3.6950197955077753`*^9}, {
   3.6950198274183407`*^9, 3.695019862880128*^9}, {3.6984375434246693`*^9, 
   3.698437545274137*^9}, {3.717494383285563*^9, 3.717494400034925*^9}, 
   3.772875524391036*^9},
 CellLabel->
  "In[1197]:=",ExpressionUUID->"edd9685e-2725-43b3-a630-675f420d3a64"],

Cell["\<\
It can be computed from a Taylor expansion (this used to be done in the \
past), but a direct evaluation by Mathematica is much better\
\>", "Text",ExpressionUUID->"2b221114-07ae-42e6-b131-6acff2fb0a60"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LfunSeries", "[", "b_", "]"}], "=", 
   RowBox[{"Normal", "@", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "4"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "b"}], ")"}], "^", "6"}], "*", 
       FractionBox["4", "b"], " ", 
       RowBox[{"Lfun", "[", 
        FractionBox[
         RowBox[{"2", "b"}], 
         RowBox[{"1", "+", "b"}]], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "0", ",", "12"}], 
       RowBox[{"(*", "22", "*)"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.772875531884385*^9},
 CellLabel->
  "In[1198]:=",ExpressionUUID->"770fd7f2-9a31-45f4-96ff-c6278de245c4"],

Cell["\<\
Sirlin universal function (Eq 20b of [Sirlin 1967]) on which we add the \
constants of Eq. 7 of  [Czarnecki et al. 2004]) is obtained as (this is B32 \
of companion paper)\
\>", "Text",ExpressionUUID->"48738604-58d5-459f-bea1-50442890abdf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$SeriesSpenceFunction", "=", "False"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SirlinGFunction", "[", 
    RowBox[{"b_", ",", "y_", ",", "en_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"3", 
      RowBox[{"Log", "[", 
       RowBox[{"mp", "/", 
        RowBox[{"(", "me", ")"}]}], "]"}]}], "-", 
     RowBox[{"3", "/", "4"}], "+", 
     RowBox[{"4", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Rd", "[", "b", "]"}], "-", "1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        FractionBox["y", 
         RowBox[{"3", " ", "en"}]], "-", 
        RowBox[{"3", "/", "2"}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"2", "y"}], "]"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Rd", "[", "b", "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["b", "2"]}], ")"}]}], "+", 
        FractionBox[
         SuperscriptBox["y", "2"], 
         RowBox[{"6", " ", 
          SuperscriptBox["en", "2"]}]], "-", 
        RowBox[{"4", " ", "b", " ", 
         RowBox[{"Rd", "[", "b", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"If", "[", 
      RowBox[{"$SeriesSpenceFunction", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "b"}], ")"}], "^", "6"}]}], "*", 
        RowBox[{"LfunSeries", "[", "b", "]"}]}], ",", 
       RowBox[{
        FractionBox["4", "b"], " ", 
        RowBox[{"Lfun", "[", 
         FractionBox[
          RowBox[{"2", "b"}], 
          RowBox[{"1", "+", "b"}]], "]"}]}]}], "]"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Cd", "[", 
    RowBox[{"b_", ",", "y_", ",", "en_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"ConstantSirlin", "+", 
     RowBox[{"SirlinGFunction", "[", 
      RowBox[{"b", ",", "y", ",", "en"}], "]"}]}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[1199]:=",ExpressionUUID->"541923f4-e244-404d-96e9-35560d4f1877"],

Cell[TextData[{
 "NB : In [Dicus et al. 1982] Eq 2.14 (or in [Lopez&Turner 1998] Eq. 17) they \
use the approximation  ",
 Cell[BoxData[
  RowBox[{
   FractionBox["4", "b"], " ", 
   RowBox[{"Lfun", "[", 
    FractionBox[
     RowBox[{"2", "b"}], 
     RowBox[{"1", "+", "b"}]], "]"}]}]],
  InitializationCell->True,
  CellChangeTimes->{{3.694797688904614*^9, 3.6947977428579283`*^9}, {
    3.694797847566765*^9, 3.6947979507384853`*^9}, {3.694798050103331*^9, 
    3.6947980509997787`*^9}, {3.694798150722013*^9, 3.694798151665238*^9}, {
    3.694798207915731*^9, 3.694798209411783*^9}, {3.694808708291202*^9, 
    3.694808709498891*^9}, {3.695016324015396*^9, 3.695016423222722*^9}, 
    3.695019283611595*^9, {3.695019330321011*^9, 3.695019370419022*^9}, {
    3.695019903530594*^9, 3.695020012756899*^9}, {3.695033149942461*^9, 
    3.6950331525354843`*^9}, {3.695033598333864*^9, 3.6950336002817698`*^9}, {
    3.695400974490758*^9, 3.695401009995254*^9}, {3.695401064749748*^9, 
    3.69540106507521*^9}, {3.698387169868085*^9, 3.69838718544575*^9}, {
    3.698437488152482*^9, 3.69843751006903*^9}, 3.715934618053207*^9, {
    3.7167059008173227`*^9, 3.716705920972702*^9}, {3.716710529799835*^9, 
    3.716710530162551*^9}, {3.716711003108491*^9, 3.7167110469764757`*^9}, {
    3.7167235999866047`*^9, 3.716723626225528*^9}, {3.716723664168767*^9, 
    3.716723665024164*^9}, {3.716785058669737*^9, 3.716785059982909*^9}, {
    3.7167894310819683`*^9, 3.716789435725108*^9}, {3.716794348366415*^9, 
    3.716794350433975*^9}, {3.717490950893651*^9, 3.71749095125704*^9}, {
    3.717491810935252*^9, 3.717491815135673*^9}, {3.7174921021724577`*^9, 
    3.7174921130284023`*^9}, {3.717492201548502*^9, 3.7174922213439283`*^9}, 
    3.717492313604851*^9, {3.717492427556674*^9, 3.7174924294908953`*^9}, {
    3.717492485391667*^9, 3.7174925112440357`*^9}, 3.717492603407527*^9, {
    3.717492647674275*^9, 3.7174926554128647`*^9}, {3.717492697183716*^9, 
    3.717492726253154*^9}, {3.717492763669854*^9, 3.717492795771493*^9}, {
    3.717492947664547*^9, 3.717492949824585*^9}},ExpressionUUID->
  "99a8d6a2-0e0c-478e-9d16-6602f3878952"],
 "= ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"-", "4"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{"11", "b"}], "+", 
      RowBox[{
       FractionBox["224", "9"], 
       SuperscriptBox["b", "2"]}], "+", 
      RowBox[{
       FractionBox["89", "3"], 
       SuperscriptBox["b", "3"]}], "+", 
      RowBox[{
       FractionBox["1496", "75"], 
       SuperscriptBox["b", "4"]}], "+", 
      RowBox[{
       FractionBox["596", "75"], 
       SuperscriptBox["b", "5"]}], "+", 
      RowBox[{
       FractionBox["128", "49"], " ", 
       SuperscriptBox["b", "6"]}]}], ")"}], "/", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "b"}], ")"}], "6"]}]}]],
  InitializationCell->True,
  CellChangeTimes->{{3.694797688904614*^9, 3.6947977428579283`*^9}, {
    3.694797847566765*^9, 3.6947979507384853`*^9}, {3.694798050103331*^9, 
    3.6947980509997787`*^9}, {3.694798150722013*^9, 3.694798151665238*^9}, {
    3.694798207915731*^9, 3.694798209411783*^9}, {3.694808708291202*^9, 
    3.694808709498891*^9}, {3.695016324015396*^9, 3.695016423222722*^9}, 
    3.695019283611595*^9, {3.695019330321011*^9, 3.695019370419022*^9}, {
    3.695019903530594*^9, 3.695020012756899*^9}, {3.695033149942461*^9, 
    3.6950331525354843`*^9}, {3.695033598333864*^9, 3.6950336002817698`*^9}, {
    3.695400974490758*^9, 3.695401009995254*^9}, {3.695401064749748*^9, 
    3.69540106507521*^9}, {3.698387169868085*^9, 3.69838718544575*^9}, {
    3.698437488152482*^9, 3.69843751006903*^9}, 3.715934618053207*^9, {
    3.7167059008173227`*^9, 3.716705920972702*^9}, {3.716710529799835*^9, 
    3.716710530162551*^9}, {3.716711003108491*^9, 3.7167110469764757`*^9}, {
    3.7167235999866047`*^9, 3.716723626225528*^9}, {3.716723664168767*^9, 
    3.716723665024164*^9}, {3.716785058669737*^9, 3.716785059982909*^9}, {
    3.7167894310819683`*^9, 3.716789435725108*^9}, {3.716794348366415*^9, 
    3.716794350433975*^9}, {3.717490950893651*^9, 3.71749095125704*^9}, {
    3.717491810935252*^9, 3.717491815135673*^9}, {3.7174921021724577`*^9, 
    3.7174921130284023`*^9}, {3.717492201548502*^9, 3.7174922213439283`*^9}, 
    3.717492313604851*^9, {3.717492427556674*^9, 3.7174924294908953`*^9}, {
    3.717492485391667*^9, 3.7174925112440357`*^9}, 3.717492603407527*^9, {
    3.717492647674275*^9, 3.7174926554128647`*^9}, {3.717492697183716*^9, 
    3.717492726253154*^9}, {3.717492763669854*^9, 3.717492795771493*^9}, {
    3.717492947664547*^9, 3.717492949824585*^9}},ExpressionUUID->
  "6c567ce6-dccf-4009-8c08-d5e4be86d0e2"],
 "  \nHowever there is a typo and some incorrect coefficients. In [Kernan] \
there are approximate coefficients which are nearly correct."
}], "Text",
 CellChangeTimes->{{3.717493972257091*^9, 3.717494010053439*^9}, {
  3.717494046122768*^9, 3.717494086328473*^9}, {3.717494645499318*^9, 
  3.717494673757392*^9}, {3.717496398795295*^9, 
  3.717496452840333*^9}},ExpressionUUID->"640c4b1d-e6c6-4305-a51f-\
280e1eed14d2"],

Cell[TextData[{
 "2) if $ResummedLogsRadiativeCorrections = True, we use a resummed version \
of all the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Log", "[", 
    RowBox[{
     SubscriptBox["m", "Z"], "/", 
     SubscriptBox["m", "P"]}]}], TraditionalForm]],ExpressionUUID->
  "4180fccd-adf5-4465-a34c-524ad5ce0a69"],
 "]. It consists in using Eq. 15 of [Czarnecki 2004] or B35 in companion \
paper.\nSee also [Esposito et al. 1998])"
}], "Text",ExpressionUUID->"c4b19e9d-7f39-42b7-aa9d-08508f97ae9e"],

Cell["\<\
We build the multiplicative factor for inner radiative corrections (Eq. 15 of \
[Czarnecki et al. 2004]), that is B35 of companion paper.\
\>", "Text",ExpressionUUID->"280c9538-823b-4440-ba5b-f50561cef8dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LFactor", "=", "1.02094"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SFactor", "=", "1.02248"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]factor", "=", 
   RowBox[{
    RowBox[{"-", "0.00043"}], "*", "2", 
    RowBox[{"Pi", "/", "\[Alpha]FS"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NLL", "=", 
   RowBox[{"-", "0.0001"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717494758628602*^9, 3.7174947935372477`*^9}, {
  3.717494848079295*^9, 3.717494871331615*^9}, {3.717495231343647*^9, 
  3.7174952315089912`*^9}, {3.7174955880586653`*^9, 3.717495606988083*^9}},
 CellLabel->
  "In[1202]:=",ExpressionUUID->"858e3208-d718-44da-8650-f4bb7bbf4106"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RadiativeCorrectionsResummed", "[", 
    RowBox[{"b_", ",", "y_", ",", "en_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       FractionBox["\[Alpha]FS", 
        RowBox[{"2", "\[Pi]"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SirlinGFunction", "[", 
          RowBox[{"b", ",", "y", ",", "en"}], "]"}], "-", 
         RowBox[{"3", 
          RowBox[{"Log", "[", 
           FractionBox["mp", 
            RowBox[{"2", "Q"}]], "]"}]}]}], ")"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{"LFactor", "+", 
      RowBox[{
       FractionBox["\[Alpha]FS", "\[Pi]"], "CCzarnecki"}], "+", 
      RowBox[{
       FractionBox["\[Alpha]FS", 
        RowBox[{"2", "\[Pi]"}]], "\[Delta]factor"}]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"SFactor", "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"134", "*", "2", "*", "Pi"}]], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Log", "[", 
          FractionBox["mp", "mA"], "]"}], "+", "AgCzarnecki"}], ")"}]}], "+", 
      "NLL"}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717496507561201*^9, 3.7174965147158813`*^9}, {
  3.717581558375576*^9, 3.717581559242181*^9}, {3.722692448155993*^9, 
  3.722692470220851*^9}},
 CellLabel->
  "In[1206]:=",ExpressionUUID->"fae90968-7930-4bf9-a4d4-ed02ad78e3d7"],

Cell["\<\
Finally we define a function which selects either choice depending on option\
\>", "Text",
 CellChangeTimes->{{3.717496595427477*^9, 
  3.71749661017124*^9}},ExpressionUUID->"17c4cb30-65d9-453c-a763-\
1ab80fad5e38"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RadiativeCorrections", "[", 
    RowBox[{"b_", ",", "y_", ",", "en_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{"$ResummedLogsRadiativeCorrections", ",", 
     RowBox[{"RadiativeCorrectionsResummed", "[", 
      RowBox[{"b", ",", "y", ",", "en"}], "]"}], ",", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["\[Alpha]FS", 
         RowBox[{"2", "\[Pi]"}]], 
        RowBox[{"Cd", "[", 
         RowBox[{"b", ",", "y", ",", "en"}], "]"}]}]}], ")"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717490543398891*^9, 3.71749055476276*^9}, {
   3.717491818626848*^9, 3.717491819335279*^9}, {3.717492924141775*^9, 
   3.717492954593093*^9}, {3.717493255485257*^9, 3.717493255912325*^9}, {
   3.717494329938711*^9, 3.717494330486829*^9}, {3.71749498268344*^9, 
   3.717495027175693*^9}, {3.7174950951276608`*^9, 3.717495225841158*^9}, 
   3.7174953705337877`*^9, {3.717495603906966*^9, 3.717495604998067*^9}, {
   3.7174956456236143`*^9, 3.7174956512484703`*^9}, {3.717495690059033*^9, 
   3.71749570694768*^9}, {3.7174958441051397`*^9, 3.717496002707138*^9}, {
   3.7174965524514923`*^9, 3.717496558793282*^9}, {3.7226924803141613`*^9, 
   3.7226924892559*^9}, {3.7255947292661047`*^9, 3.72559475458504*^9}, 
   3.772875546269367*^9},
 CellLabel->
  "In[1207]:=",ExpressionUUID->"4b7162cd-f884-4a49-9c9b-9c4cca28b552"],

Cell["\<\
Fermi function for Coulomb interactions of electron and proton (if on the \
same side of the interaction).
Either the relativistic or the non-relativistic depending on option \
$RelativisticFermiFunction. That is either Eq. 99 or Eq. 100 of companion \
paper depending on option chosen.\
\>", "Text",
 CellDingbat->
  "\[FilledSquare]",ExpressionUUID->"1adeb5d9-aa6b-4044-85a7-c7adb7011d1f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FermiRelat", "[", "b_", "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Gamma]", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "-", 
            SuperscriptBox["\[Alpha]FS", "2"]}], "]"}], "-", "1"}]}], ",", 
        RowBox[{"\[Lambda]Compton", "=", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"me", "/", 
            RowBox[{"(", 
             RowBox[{"hbar", " ", "clight"}], ")"}]}], ")"}]}]}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"\[Gamma]", "/", "2"}]}], ")"}], "*", "4", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"2", "radiusproton", " ", "b"}], "\[Lambda]Compton"], ")"}], 
        RowBox[{"2", "\[Gamma]"}]], "*", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"Gamma", "[", 
          RowBox[{"3", "+", 
           RowBox[{"2", "\[Gamma]"}]}], "]"}], "2"]], 
       RowBox[{"Exp", "[", 
        FractionBox[
         RowBox[{"\[Pi]", " ", "\[Alpha]FS"}], "b"], "]"}], "*", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["b", "2"]}], ")"}], "\[Gamma]"]], 
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", "\[Gamma]", "+", 
           RowBox[{"I", " ", 
            FractionBox["\[Alpha]FS", "b"]}]}], "]"}], "]"}], "2"]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FermiNonRelat", "[", "b_", "]"}], ":=", 
   FractionBox[
    RowBox[{"2", "\[Pi]", " ", 
     RowBox[{"\[Alpha]FS", "/", "b"}]}], 
    RowBox[{"1", "-", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "2"}], "\[Pi]", " ", 
       RowBox[{"\[Alpha]FS", "/", "b"}]}], "]"}]}]]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.718527685902134*^9, 3.7185277081922283`*^9}},
 CellLabel->
  "In[1208]:=",ExpressionUUID->"7539fed7-0b24-494a-91f1-40c1ff5330f2"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
  "$RelativisticFermiFunction", ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Fermi", "[", "b_", "]"}], ":=", 
     RowBox[{"FermiRelat", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bFermi", "[", "b_", "]"}], ":=", 
     RowBox[{"b", " ", 
      RowBox[{"Fermi", "[", "b", "]"}]}]}], ";"}], ",", "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Fermi", "[", "b_", "]"}], ":=", 
     RowBox[{"FermiNonRelat", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bFermi", "[", "b_", "]"}], ":=", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "\[Alpha]FS"}], 
      RowBox[{"1", "-", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "2"}], "\[Pi]", " ", 
         RowBox[{"\[Alpha]FS", "/", "b"}]}], "]"}]}]]}], ";"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717867396974017*^9, 3.717867442971924*^9}, {
  3.7178676664298763`*^9, 3.717867732366181*^9}, {3.717867829555373*^9, 
  3.717867831656934*^9}, {3.7178678627324944`*^9, 3.717867896069261*^9}, {
  3.717868002279361*^9, 3.71786817214734*^9}, {3.7178682362189093`*^9, 
  3.717868239738433*^9}, {3.717868315388064*^9, 3.717868316041935*^9}, {
  3.717868386657423*^9, 3.717868414836771*^9}, {3.718527678003798*^9, 
  3.718527723454259*^9}},
 CellLabel->
  "In[1210]:=",ExpressionUUID->"3761d1a8-a3d7-4ea2-be59-841aede4e1ae"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Lambda]", "0"], " ", "when", " ", "taking", " ", "only", 
  " ", "Fermi", " ", "function", " ", "and", " ", "not", " ", "radiative", 
  " ", "corrections"}]], "Text",
 CellChangeTimes->{{3.722692648708393*^9, 
  3.7226926604621*^9}},ExpressionUUID->"48f32096-f2f2-433f-8507-6411e9bd7c3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]FermiOnly", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", "=", 
        RowBox[{"Q", "/", "me"}]}], " ", ",", 
       RowBox[{"b", "=", 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox["en", "2"], "-", "1"}]], "/", "en"}]}], ",", 
       RowBox[{"y", "=", 
        RowBox[{
         RowBox[{"Q", "/", "me"}], " ", "-", "en"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"en", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"en", "-", "q"}], ")"}], "2"], "en", "*", 
        RowBox[{"bFermi", "[", "b", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"en", ",", "1.0000001", ",", "q"}], "}"}]}], "]"}]}], "]"}]}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717493532945475*^9, 3.717493549311998*^9}, {
   3.717867455052084*^9, 3.717867458985319*^9}, {3.722692666976872*^9, 
   3.722692667378965*^9}, 3.772875557310583*^9},
 CellLabel->
  "In[1211]:=",ExpressionUUID->"12df7d1d-571f-497f-8260-aedbf607efb5"],

Cell["This already a 3.44 % correction", "Text",
 CellChangeTimes->{{3.717494537829948*^9, 3.717494548263729*^9}, 
   3.722692687470048*^9},ExpressionUUID->"9c134fa9-4cb8-4bc9-884b-\
bf5f36ac617f"],

Cell["\<\
Adding the inner radiative corrections, the constant involved in the decay of \
the neutron is\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6983874906879396`*^9, 3.698387519392737*^9}, {
   3.717494483699922*^9, 3.717494494988906*^9}, 
   3.717496627969266*^9},ExpressionUUID->"8146f173-3453-4b54-8b04-\
30abdccc3c59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]Rad", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", "=", 
        RowBox[{"Q", "/", "me"}]}], " ", ",", 
       RowBox[{"b", "=", 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox["en", "2"], "-", "1"}]], "/", "en"}]}], ",", 
       RowBox[{"y", "=", 
        RowBox[{
         RowBox[{"Q", "/", "me"}], " ", "-", "en"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"en", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"en", "-", "q"}], ")"}], "2"], "en", 
        RowBox[{"(", 
         RowBox[{"RadiativeCorrections", "[", 
          RowBox[{"b", ",", "y", ",", "en"}], "]"}], ")"}], "*", 
        RowBox[{"bFermi", "[", "b", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"en", ",", "1.0000001", ",", "q"}], "}"}]}], "]"}]}], "]"}]}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.696566408217867*^9, 3.696566414066465*^9}, {
   3.698437550596876*^9, 3.6984375516938143`*^9}, {3.6995860755176907`*^9, 
   3.699586075774625*^9}, {3.699591135944072*^9, 3.69959113822723*^9}, {
   3.699772811437447*^9, 3.6997728123483677`*^9}, {3.7000190267461853`*^9, 
   3.700019026757886*^9}, {3.71627268710553*^9, 3.716272699926407*^9}, {
   3.716710419652059*^9, 3.71671042411692*^9}, {3.716710497439042*^9, 
   3.716710499578012*^9}, {3.716711535599497*^9, 3.71671154673493*^9}, {
   3.717484773632263*^9, 3.7174847859739447`*^9}, 3.717490565560268*^9, {
   3.717491836267934*^9, 3.717491865540491*^9}, {3.717491994431302*^9, 
   3.717492014984913*^9}, 3.717495370973399*^9, {3.717867469195101*^9, 
   3.7178674735889273`*^9}, 3.722258583835072*^9, 3.7226926996495543`*^9, 
   3.772875570086128*^9},
 CellLabel->
  "In[1212]:=",ExpressionUUID->"f1d9d7dc-e85f-4f2d-8bef-2f0b54e565f8"],

Cell["\<\
Note that in companion paper, Eq. 106, the value 1.75767 is quoted when it \
should be the value found here 1.758373.\
\>", "Text",ExpressionUUID->"6590673c-cb4a-4b75-ac66-416e49793062"],

Cell["\<\
This adds another 3.90 % correction as found in Eq 16 of [Czarnecki et al. \
2004].\
\>", "Text",
 CellChangeTimes->{{3.7174945504686747`*^9, 3.7174945598317013`*^9}, {
  3.71749602740368*^9, 
  3.717496046907444*^9}},ExpressionUUID->"e8668922-d12a-4828-9a05-\
1706cbffbf57"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Finite mass corrections ",
 Cell[BoxData[
  RowBox[{"to", "  ", 
   SubscriptBox["\[Lambda]", "0"], " "}]],
  CellChangeTimes->{{3.69481069087228*^9, 3.694810727641842*^9}, {
   3.696282140354711*^9, 3.696282142052696*^9}, {3.696283233589775*^9, 
   3.696283234469832*^9}, {3.6962832672231216`*^9, 3.6962832756173277`*^9}, {
   3.696283398283362*^9, 3.696283399322384*^9}, {3.6965663542022038`*^9, 
   3.696566354890465*^9}},ExpressionUUID->
  "b2088342-7b6a-495d-a502-da668f577f65"]
}], "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.696282125231341*^9, 3.696282132199046*^9}, {
   3.6965663605964813`*^9, 3.696566370318268*^9}, 
   3.7003879480893717`*^9},ExpressionUUID->"1ad40d36-696f-4c46-83b7-\
84b9d21b0704"],

Cell["\<\
See companion papers for expression of finite nucleon mass corrections. 
We take the general form of finite mass correction and remove all terms which \
involve temperature. So we consider Eq. 118 of companion paper.\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"b5a9e717-6055-4e37-a1f4-44cf853fbc60"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IntegrateCorrectionNeutronDecay", "[", "fun_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"fun", "[", "pe", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"pe", ",", "0.0000001", ",", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Q", "/", "me"}], ")"}], "2"], "-", "1"}]]}], "}"}], ",", 
     RowBox[{"WorkingPrecision", "\[Rule]", "MachinePrecision"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.696280383208378*^9, 3.696280421359488*^9}, {
   3.69628046883635*^9, 3.696280512247633*^9}, {3.6962813215653048`*^9, 
   3.6962813228234673`*^9}, {3.696283231230423*^9, 3.696283271866757*^9}, {
   3.6963118789716597`*^9, 3.696311917401819*^9}, {3.696685474541614*^9, 
   3.696685478767659*^9}, 3.696685561906383*^9, {3.696686220210387*^9, 
   3.696686269214223*^9}, {3.696686467434844*^9, 3.6966864873331833`*^9}, {
   3.696687017792264*^9, 3.6966871586484013`*^9}, {3.6977717338937483`*^9, 
   3.6977717530226517`*^9}, {3.699586062889357*^9, 3.699586063079455*^9}, {
   3.699593005661579*^9, 3.699593007993538*^9}, 3.699772782921423*^9, {
   3.716350024419242*^9, 3.716350030714056*^9}, {3.722692897911614*^9, 
   3.722692908345976*^9}},
 CellLabel->
  "In[1213]:=",ExpressionUUID->"4f887b57-b76f-47f3-994d-f25a39726ac5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]FMNeutronDecay", "[", 
    RowBox[{"en_", ",", "pe_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "=", 
        RowBox[{"mp", "/", "me"}]}], ",", 
       RowBox[{"enu", "=", 
        RowBox[{"en", "-", 
         RowBox[{"Q", "/", "me"}]}]}], ",", 
       RowBox[{"f1", "=", 
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "gA"}], ")"}], "2"], "+", 
          RowBox[{"4", " ", "fWM", " ", "gA"}]}], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"3", 
            SuperscriptBox["gA", "2"]}]}], ")"}]]}], ",", 
       RowBox[{"f2", "=", 
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "gA"}], ")"}], "2"], "-", 
          RowBox[{"4", "fWM", " ", "gA"}]}], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"3", 
            SuperscriptBox["gA", "2"]}]}], ")"}]]}], ",", 
       RowBox[{"f3", "=", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["gA", "2"], "-", "1"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"3", 
            SuperscriptBox["gA", "2"]}]}], ")"}]]}]}], "}"}], ",", 
     "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"f1", "*", 
       SuperscriptBox["enu", "2"], 
       RowBox[{"(", 
        FractionBox[
         SuperscriptBox["pe", "2"], 
         RowBox[{"M", "*", "en"}]], ")"}]}], "\[IndentingNewLine]", "+", 
      RowBox[{"f2", "*", 
       RowBox[{"enu", "^", "3"}], 
       RowBox[{"(", 
        RowBox[{"-", 
         FractionBox["1", "M"]}], ")"}]}], "\[IndentingNewLine]", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2", "+", "f3"}], ")"}], 
       FractionBox["1", 
        RowBox[{"2", "M"}]], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", 
          SuperscriptBox["enu", "3"]}], "+", 
         RowBox[{"2", "enu", " ", 
          SuperscriptBox["pe", "2"]}]}], ")"}]}], "\[IndentingNewLine]", "+", 
      
      RowBox[{"f3", "*", 
       FractionBox["1", 
        RowBox[{"3", "M"}]], "3", 
       SuperscriptBox["enu", "2"], 
       FractionBox[
        RowBox[{" ", 
         SuperscriptBox["pe", "2"]}], 
        RowBox[{"(", "en", ")"}]]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.696280918613558*^9, 3.696281000016506*^9}, {
   3.696281088506213*^9, 3.696281175022999*^9}, {3.696281813147451*^9, 
   3.6962818176774473`*^9}, {3.696282160186653*^9, 3.696282184614553*^9}, {
   3.69628319318085*^9, 3.6962831954522343`*^9}, {3.6962832829128113`*^9, 
   3.6962832848002577`*^9}, {3.6962834069913387`*^9, 
   3.6962834143314533`*^9}, {3.696311849556038*^9, 3.696311871288797*^9}, {
   3.696332115760496*^9, 3.6963321170929003`*^9}, {3.696566329130681*^9, 
   3.6965663412379007`*^9}, {3.6965838629582243`*^9, 
   3.6965838803955183`*^9}, {3.696584106151621*^9, 3.6965841087280407`*^9}, {
   3.69668509758673*^9, 3.696685099672738*^9}, {3.6966862257246933`*^9, 
   3.696686228174343*^9}, {3.6967571073289223`*^9, 3.696757141675568*^9}, {
   3.696757859257997*^9, 3.6967578595979233`*^9}, {3.6967599495498238`*^9, 
   3.6967599519761868`*^9}, 3.696847484745764*^9, {3.696847613055067*^9, 
   3.69684771393638*^9}, {3.6968477445261517`*^9, 3.6968478189770947`*^9}, {
   3.696847910746896*^9, 3.696847913226605*^9}, {3.696847974444202*^9, 
   3.696848031843027*^9}, {3.6968480916101503`*^9, 3.696848105892889*^9}, {
   3.6968481629012957`*^9, 3.696848168128106*^9}, {3.696850581557541*^9, 
   3.696850590783044*^9}, {3.6969346945037327`*^9, 3.6969347071231203`*^9}, {
   3.6977715993725233`*^9, 3.697771610179696*^9}, {3.697771674467738*^9, 
   3.697771679427724*^9}, {3.697771971778405*^9, 3.6977720182865543`*^9}, {
   3.697772050666408*^9, 3.69777206692671*^9}, {3.697772124597191*^9, 
   3.6977721250165*^9}, 3.6977721736924763`*^9, {3.697772206767871*^9, 
   3.6977722082740107`*^9}, {3.697772474486924*^9, 3.697772530241128*^9}, {
   3.697772804731844*^9, 3.697772877091577*^9}, {3.6977729186612377`*^9, 
   3.697772967615233*^9}, {3.69777320487284*^9, 3.6977732720546513`*^9}, {
   3.6977733331145287`*^9, 3.6977733401445227`*^9}, {3.697773789183201*^9, 
   3.6977737986586657`*^9}, {3.6977743689933653`*^9, 3.697774372857629*^9}, {
   3.697774805923669*^9, 3.6977748192192793`*^9}, {3.697775462417663*^9, 
   3.6977754647005577`*^9}, {3.699772784160898*^9, 3.699772785080847*^9}, {
   3.7162206078965597`*^9, 3.716220656763513*^9}, {3.7162220922288027`*^9, 
   3.716222106959347*^9}, {3.716310910386093*^9, 3.716310919884355*^9}, {
   3.7163663447341843`*^9, 3.716366373864189*^9}, {3.71636657614649*^9, 
   3.7163665860113173`*^9}, {3.71636664437823*^9, 3.716366650477675*^9}, {
   3.716366798523903*^9, 3.716366798858921*^9}, {3.716367500280875*^9, 
   3.716367501852865*^9}, {3.71731477725559*^9, 3.71731479594245*^9}, {
   3.71731528645854*^9, 3.717315296057448*^9}, 3.717581560376215*^9, {
   3.7178779951207848`*^9, 3.717878012166428*^9}, {3.717878075921851*^9, 
   3.717878077803425*^9}, {3.717880631438624*^9, 3.717880633696928*^9}, {
   3.718561808301819*^9, 3.718561811000634*^9}, {3.7201963165455112`*^9, 
   3.7201963205505657`*^9}, {3.720267841784697*^9, 3.720267863437367*^9}, {
   3.720269284334457*^9, 3.7202693075520077`*^9}, {3.7222611250668163`*^9, 
   3.722261142044557*^9}, {3.722261223095188*^9, 3.7222612273412*^9}, {
   3.7226928626222467`*^9, 3.72269288786169*^9}, {3.72269292039366*^9, 
   3.722692957293491*^9}, {3.722847535247198*^9, 3.722847537024199*^9}},
 CellLabel->
  "In[1214]:=",ExpressionUUID->"f11feccd-a477-43ed-94f5-f12492b012c1"],

Cell["\<\
However we couple to radiative corrections if $CoupledFMandRC = True\
\>", "Text",
 CellChangeTimes->{{3.72269301572363*^9, 
  3.7226930319651423`*^9}},ExpressionUUID->"2b17b514-92b7-4d37-af3a-\
857ce508c118"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"I\[Lambda]FM", "[", "pe_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"en", "=", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["pe", "2"], "+", "1"}]]}], "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b", "=", 
         RowBox[{"pe", "/", "en"}]}], "}"}], ",", 
       RowBox[{
        SuperscriptBox["pe", "2"], "*", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Chi]FMNeutronDecay", "[", 
           RowBox[{"en", ",", "pe"}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"$RadiativeCorrections", "&&", "$CoupledFMandRC"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"RadiativeCorrections", "[", 
               RowBox[{"b", ",", 
                RowBox[{"Abs", "[", 
                 RowBox[{"en", "-", " ", 
                  RowBox[{"Q", "/", "me"}]}], " ", "]"}], ",", "en"}], "]"}], 
              ")"}], 
             RowBox[{"Fermi", "[", "b", "]"}]}], ",", "1"}], "]"}]}], 
         ")"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.696255711940116*^9, 3.696255722470284*^9}, 
   3.696255774164277*^9, {3.69626444438336*^9, 3.696264453493224*^9}, {
   3.6962793206955757`*^9, 3.696279329324561*^9}, {3.6962794572771378`*^9, 
   3.696279462405015*^9}, {3.6962796196324987`*^9, 3.6962796413602552`*^9}, {
   3.696280076216354*^9, 3.696280076747569*^9}, {3.696281195892473*^9, 
   3.696281206840848*^9}, {3.696281278237392*^9, 3.696281293528943*^9}, {
   3.6962833859805307`*^9, 3.696283395666664*^9}, {3.716310921954412*^9, 
   3.716310923798676*^9}, {3.7163677577336493`*^9, 3.716367793975379*^9}, {
   3.71636784150838*^9, 3.716367872284363*^9}, {3.716796464675939*^9, 
   3.716796467323011*^9}, 3.717490576422934*^9, {3.717493455509912*^9, 
   3.717493509205779*^9}, {3.717494576954554*^9, 3.717494579416072*^9}, 
   3.717495371870822*^9, {3.717867480844473*^9, 3.717867483448963*^9}, {
   3.717877862907452*^9, 3.71787787230369*^9}, 3.718443055056527*^9, 
   3.718534492228304*^9, {3.718562019088574*^9, 3.7185620315285997`*^9}, {
   3.7202677895254*^9, 3.720267799719927*^9}, {3.720269263336925*^9, 
   3.720269296717362*^9}, {3.722693037074102*^9, 3.7226930430530243`*^9}, {
   3.722693096491198*^9, 3.722693097199271*^9}},
 CellLabel->
  "In[1215]:=",ExpressionUUID->"9fd08656-b663-47d6-b159-c99d6cee8f40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]FM", "=", 
   RowBox[{"If", "[", 
    RowBox[{"$FiniteNucleonMass", ",", 
     RowBox[{"IntegrateCorrectionNeutronDecay", "[", "I\[Lambda]FM", "]"}], 
     ",", "0"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.696566436663267*^9, 3.696566477446142*^9}, 
   3.69667860801122*^9, {3.697773791730625*^9, 3.697773792408358*^9}, 
   3.698386634796516*^9, 3.6983984623956757`*^9, 3.7222586005807657`*^9, 
   3.722693099815543*^9, 3.77287562079356*^9},
 CellLabel->
  "In[1216]:=",ExpressionUUID->"1ae279eb-9f78-4d87-9c75-cfbb6470faff"],

Cell["\<\
When taking only into account Fermi function and finite mass effect on should \
get 1.6887. See Eq. 6 of [Czarnecki et al. 2004]\
\>", "Text",
 CellChangeTimes->{{3.717493624241503*^9, 3.7174936468820267`*^9}, {
  3.7174945912608433`*^9, 
  3.717494598596105*^9}},ExpressionUUID->"88014744-5fc4-4ca1-9e32-\
0dfb0690d2e2"],

Cell["\<\
If Coulomb and Radiative corrections are set to False (0) this is exactly \
(-0.00206) what is found by [Lopez & Turner 1997] (see three lines after Eq. \
23, in the text). 
See also the value -0.00201 found in Eq. 20 of [Seckel 1993].\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698386648005134*^9, 3.698386655370556*^9}, {
   3.698386752884844*^9, 3.6983868217456007`*^9}, {3.7162849987772713`*^9, 
   3.716284999046254*^9}, {3.716368576965269*^9, 3.716368595676948*^9}, 
   3.7174967586151743`*^9},ExpressionUUID->"bc978538-4767-49c6-8a59-\
75dad9de87d8"],

Cell["\<\
We also reproduce for comparison the exact finite mass correction to the \
neutron decay rate as computed by Eq. 19 of [Lopez & Turner 1998], which uses \
two-dimensional integrals. Again we find the -0.00206 correction so our \
finite mass method based one-dimensional integrals is reliable.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6983868305206413`*^9, 3.698386971370988*^9}, 
   3.717496764892456*^9},ExpressionUUID->"51d22cb0-9136-408d-99a0-\
931c2e2f8233"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]exact", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pe", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox["en", "2"], "-", "1"}], "]"}]}], "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"enu", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"mn", " "}], "2"], "-", 
               SuperscriptBox["mp", "2"]}], ")"}], "/", 
             SuperscriptBox["me", "2"]}], "+", "1", "-", 
            RowBox[{"2", 
             RowBox[{"mn", "/", "me"}], " ", "en"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"mn", "/", "me"}], "-", "en", "+", 
              RowBox[{"pe", " ", "Cnu"}]}], ")"}]}], ")"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ep", "=", 
            RowBox[{
             RowBox[{"mn", "/", "me"}], "-", "enu", "-", "en"}]}], ",", 
           RowBox[{"f1", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", "gA"}], ")"}], "2"], "+", 
               RowBox[{"4", "fWM", " ", "gA"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"3", 
                SuperscriptBox["gA", "2"]}]}], ")"}]}]}], ",", 
           RowBox[{"f2", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "-", "gA"}], ")"}], "2"], "-", 
               RowBox[{"4", "fWM", " ", "gA"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"3", 
                SuperscriptBox["gA", "2"]}]}], ")"}]}]}], ",", 
           RowBox[{"f3", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["gA", "2"], "-", "1"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"3", 
                SuperscriptBox["gA", "2"]}]}], ")"}]}]}]}], "}"}], ",", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"J", "=", 
              RowBox[{"1", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"enu", "+", " ", 
                  RowBox[{"pe", " ", "Cnu"}]}], ")"}], "/", 
                RowBox[{"(", "Ep", ")"}]}]}]}], ",", 
             RowBox[{"M2", "=", 
              RowBox[{
               RowBox[{"f1", " ", 
                RowBox[{"mn", "/", "me"}], " ", "enu", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ep", " ", "en"}], "-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"pe", "^", "2"}]}], "-", 
                    RowBox[{"pe", " ", "enu", " ", "Cnu"}]}], ")"}]}], 
                 ")"}]}], "+", 
               RowBox[{"f2", " ", 
                RowBox[{"mn", "/", "me"}], " ", "en", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ep", " ", "enu"}], "-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "pe"}], " ", "enu", " ", "Cnu"}], "-", 
                    RowBox[{"enu", "^", "2"}]}], ")"}]}], ")"}]}], "+", 
               RowBox[{"f3", " ", 
                RowBox[{"mn", "/", "me"}], "  ", "Ep", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"enu", " ", "en"}], "-", 
                  RowBox[{"Cnu", " ", "enu", " ", "pe"}]}], ")"}]}]}]}]}], 
            " ", "}"}], ",", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", "2"}], "*", "M2", " ", "pe", " ", 
              RowBox[{"enu", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"mn", "/", "me"}], "  ", "Ep", " ", "J"}], ")"}]}]}],
              ",", 
             RowBox[{"{", 
              RowBox[{"en", ",", "1", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Q", "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["Q", "2"], "-", 
                    SuperscriptBox[
                    RowBox[{"me", " "}], "2"]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"2", "mn"}], ")"}]}]}], ")"}], "/", "me"}]}], " ",
               "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Cnu", ",", 
               RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
             RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], 
            RowBox[{"(*", 
             RowBox[{",", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", 
                 RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0"}]}], 
                "}"}]}]}], "*)"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6969335156731033`*^9, 3.696933525293495*^9}, {
   3.696933559928018*^9, 3.696934049773225*^9}, {3.696934300465496*^9, 
   3.696934302129384*^9}, {3.696934360411626*^9, 3.696934380627284*^9}, {
   3.696934480699889*^9, 3.696934494813819*^9}, 3.6969345811957703`*^9, {
   3.696934718348485*^9, 3.6969347231811533`*^9}, {3.6969350384906693`*^9, 
   3.696935044527837*^9}, {3.69693524835297*^9, 3.696935278627832*^9}, {
   3.696935330349955*^9, 3.696935352314769*^9}, {3.696935423503272*^9, 
   3.6969354907108517`*^9}, {3.69693554088876*^9, 3.696935549312306*^9}, {
   3.697004895642859*^9, 3.6970049082953672`*^9}, {3.6970050395982018`*^9, 
   3.697005066817657*^9}, {3.697005113893834*^9, 3.697005144219008*^9}, {
   3.6970427730999813`*^9, 3.697042856557427*^9}, {3.697042930783476*^9, 
   3.697042956602249*^9}, {3.697043009655321*^9, 3.697043049940214*^9}, {
   3.697043088377961*^9, 3.697043162847924*^9}, {3.697043244852785*^9, 
   3.697043253138624*^9}, {3.6977679711495743`*^9, 3.697767972613717*^9}, {
   3.6977681054960527`*^9, 3.697768134838916*^9}, {3.697772822773965*^9, 
   3.697772833689546*^9}, {3.697772883788727*^9, 3.697772906712528*^9}, {
   3.697773321194357*^9, 3.697773325555442*^9}, {3.697774834507674*^9, 
   3.697774847852893*^9}, 3.698386882193338*^9, {3.699586069819315*^9, 
   3.699586070181356*^9}, {3.699591127845908*^9, 3.6995911309735117`*^9}, {
   3.699772787012878*^9, 3.69977280930028*^9}, {3.699775582045128*^9, 
   3.699775615943122*^9}, {3.6998099612835083`*^9, 3.699810014376048*^9}, {
   3.716222134511217*^9, 3.716222158283926*^9}, 3.717581561959633*^9, {
   3.7201966118301353`*^9, 3.72019661502563*^9}, {3.7222611284605017`*^9, 
   3.72226114207928*^9}, {3.7226931446099167`*^9, 3.7226931691331263`*^9}},
 CellLabel->
  "In[1217]:=",ExpressionUUID->"21b33116-9ed8-4552-a416-07584d23f2b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Total correction", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.696566495137484*^9, 
  3.696566499144381*^9}},ExpressionUUID->"6293fb0d-db54-45ac-9684-\
a07657448b5f"],

Cell[TextData[{
 "The total correction for the neutron decay constant ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "0"], TraditionalForm]],ExpressionUUID->
  "a5350bac-ddc5-4ab9-86e1-1337931505e8"],
 " is the sum of the Radiative corrected one plus the finite mass effects"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6983984876599207`*^9, 3.6983985078787413`*^9}, {
  3.7226931937980623`*^9, 
  3.722693193940441*^9}},ExpressionUUID->"235d0a71-0758-4774-8749-\
eb35d48ed486"],

Cell["\<\
We recall the result from radiative corrections (again we stress that Eq. 106 \
in companion paper should report that value).\
\>", "Text",ExpressionUUID->"948fd360-1619-4e24-9dbc-8cc1c87256d3"],

Cell[BoxData[
 RowBox[{"\[Lambda]Rad", ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.722258583859749*^9, 3.77287564879012*^9},
 CellLabel->
  "In[1218]:=",ExpressionUUID->"3d3791dd-4e6f-4194-b971-46c9bc51699b"],

Cell["\<\
The result from mass corrections (see text before  Eq. 120 in companion \
paper.)\
\>", "Text",ExpressionUUID->"f96f74ff-d110-467f-bfcc-8a1cbefb02d3"],

Cell[BoxData[
 RowBox[{"\[Lambda]FM", ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.7222586005194883`*^9, 3.7728756500000277`*^9},
 CellLabel->
  "In[1219]:=",ExpressionUUID->"9f277fe9-2156-40b5-9da4-db0dc0af2833"],

Cell["And we sum them to get Eq. 120 of companion paper.", "Text",ExpressionUUID->"ac4307d0-ec91-4cfb-bab7-634618ebb7f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]RadandFM", "=", 
   RowBox[{"\[Lambda]Rad", "+", "\[Lambda]FM"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.694006257659293*^9, 3.694006346204317*^9}, {
   3.6940064029664087`*^9, 3.6940064070694933`*^9}, {3.694006468173711*^9, 
   3.694006484210821*^9}, {3.694007003809126*^9, 3.694007029760737*^9}, {
   3.694007381028921*^9, 3.6940074098437347`*^9}, {3.694060222058585*^9, 
   3.694060246157043*^9}, 3.694060817391576*^9, {3.694278732807159*^9, 
   3.6942787473988733`*^9}, {3.694280123443388*^9, 3.694280130047604*^9}, 
   3.6942801631666203`*^9, {3.694325166069244*^9, 3.694325180413692*^9}, {
   3.694799704536366*^9, 3.69479976061983*^9}, {3.69480126227081*^9, 
   3.6948012624849157`*^9}, {3.694804871338216*^9, 3.694804892175321*^9}, 
   3.69480897884659*^9, {3.694810640364388*^9, 3.694810642362398*^9}, {
   3.694810676962716*^9, 3.6948107177942123`*^9}, {3.6948125869116287`*^9, 
   3.694812588317581*^9}, {3.694812624668747*^9, 3.6948126248677893`*^9}, {
   3.695015217454533*^9, 3.695015258485525*^9}, {3.695015289271777*^9, 
   3.695015289552836*^9}, {3.695016082354909*^9, 3.6950160831681423`*^9}, {
   3.695016281652854*^9, 3.695016294416226*^9}, {3.696281954888732*^9, 
   3.696281991296273*^9}, {3.6963111558829937`*^9, 3.696311169831056*^9}, {
   3.696566422389407*^9, 3.6965664236645403`*^9}, {3.696566483334778*^9, 
   3.6965665027118998`*^9}, {3.716284430228827*^9, 3.716284430665271*^9}, {
   3.7163105022449636`*^9, 3.71631050278566*^9}, {3.716695691549118*^9, 
   3.716695700873228*^9}, 3.722258430805071*^9, {3.7222585838708963`*^9, 
   3.722258600529099*^9}, 3.772875651295081*^9},
 CellLabel->
  "In[1220]:=",ExpressionUUID->"2a6485ed-a426-4f1f-9172-262c09c4eb2b"],

Cell["This gives a total correction which is", "Text",
 CellChangeTimes->{{3.717496811300147*^9, 
  3.7174968191653433`*^9}},ExpressionUUID->"47c18dab-d45e-4247-b719-\
05ee993ef630"],

Cell["\<\
If we compare with [Cooper et al 2010] (Phys. Rev. C 81, 035503 (2010)). They \
find that this parameter should be\
\>", "Text",
 CellChangeTimes->{{3.716703610828849*^9, 3.716703627822978*^9}, 
   3.7174968548491087`*^9, {3.720156086933015*^9, 3.720156101039722*^9}, 
   3.72026692473514*^9, {3.722693201520742*^9, 
   3.722693201701188*^9}},ExpressionUUID->"761966d3-a4fc-4097-884a-\
9075bc91606f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]Cooper", "=", 
   RowBox[{"1.03887", "*", "1.6887"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]Czarnecki", "=", 
    RowBox[{"1.0390", "*", "1.6887"}]}], " ", ";"}], 
  RowBox[{"(*", 
   RowBox[{" ", 
    RowBox[{"=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "RC"}], ")"}], "*", "f", " ", "with", " ", "f"}], 
      "=", 
      RowBox[{
       RowBox[{"1.6887", " ", "and", " ", "RC"}], " ", "=", " ", 
       RowBox[{"0.0390", 
        RowBox[{
         RowBox[{"(", "8", ")"}], " ", "[", 
         RowBox[{"Czarnecki", " ", "et", " ", 
          RowBox[{"al", ".", " ", "2004"}]}], "]"}]}]}]}]}], "]"}], " ", 
   "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.716703578630773*^9, 3.716703591407671*^9}, {
  3.717878415001774*^9, 3.7178784213367558`*^9}, {3.720267267881145*^9, 
  3.720267338586104*^9}, {3.720267469372755*^9, 3.72026751743943*^9}, {
  3.725594819986598*^9, 3.725594840224292*^9}, {3.772875671740892*^9, 
  3.77287567312409*^9}},
 CellLabel->
  "In[1221]:=",ExpressionUUID->"eea34792-2b5b-439c-aff8-9494c2d29b1c"],

Cell["\<\
We check that it is in agreement with the theoretical formula. This \
expression below should reproduce the neutron decay time. It is amazingly \
close ! \
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.695397605565617*^9, 3.695397616379963*^9}, {
  3.696566507009534*^9, 3.69656654022038*^9}, {3.717329600841188*^9, 
  3.717329607950241*^9}},ExpressionUUID->"1ec4e9da-f343-448e-ac04-\
588d86376e41"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MixingCosAngle", "=", "0.97420"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"+", 
      RowBox[{"-", "16"}]}], ")"}], " ", "Value", " ", "taken", " ", "from", 
    " ", "CKM", " ", "particle", " ", "data", " ", "group", " ", "2017.", " ",
     "More", " ", "precisely", " ", "from", " ", "the", " ", "review", " ", 
    "on", " ", "Vud", " ", "Vus", " ", "of", " ", "the", " ", "PDG", " ", 
    "2017."}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyK", "=", 
   RowBox[{
    SuperscriptBox["MixingCosAngle", "2"], 
    SuperscriptBox[
     RowBox[{"(", "GF", ")"}], "2"], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"3", 
        SuperscriptBox[
         RowBox[{"(", "gA", ")"}], "2"]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", 
       SuperscriptBox["\[Pi]", "3"]}], ")"}]}], "*", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", "me", " ", ")"}], "5"], " ", "/", "hbar"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"1", "/", "MyK"}], "/", "\[Lambda]RadandFM"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"1", "/", "MyK"}], "/", "\[Lambda]Czarnecki"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"1", "/", "MyK"}], "/", "\[Lambda]Cooper"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6954728372074413`*^9, 3.695472873548102*^9}, {
   3.696332190795472*^9, 3.696332196932748*^9}, {3.6965665156250563`*^9, 
   3.696566519715047*^9}, {3.6966872674714003`*^9, 3.696687267996235*^9}, {
   3.6967567399777718`*^9, 3.696756751804484*^9}, {3.716368156434329*^9, 
   3.7163681786508636`*^9}, 3.71670254032414*^9, {3.71670262608785*^9, 
   3.716702626258074*^9}, {3.7167033667094717`*^9, 3.7167033818989773`*^9}, {
   3.716703479414465*^9, 3.716703495581979*^9}, {3.71731445867717*^9, 
   3.717314468261957*^9}, {3.7173153437356567`*^9, 3.717315348761525*^9}, {
   3.717316924832449*^9, 3.717316930254469*^9}, {3.717331339213676*^9, 
   3.717331372332912*^9}, {3.71733144723606*^9, 3.717331448469735*^9}, {
   3.717482423606597*^9, 3.717482440139965*^9}, {3.717482602830689*^9, 
   3.717482602983588*^9}, {3.7174861447841253`*^9, 3.717486145173411*^9}, {
   3.717486186252449*^9, 3.717486207948655*^9}, {3.7174933135751963`*^9, 
   3.71749336502811*^9}, {3.717496895832592*^9, 3.717496933598672*^9}, {
   3.717878562036563*^9, 3.717878581377301*^9}, {3.717881310022751*^9, 
   3.717881327154688*^9}, {3.718561918084066*^9, 3.718561921933179*^9}, {
   3.720248827590795*^9, 3.720248852843026*^9}, {3.720267480121189*^9, 
   3.720267508441978*^9}, {3.7202691181793423`*^9, 3.720269124609645*^9}, {
   3.720546435403885*^9, 3.720546439667178*^9}, 3.7222584308498487`*^9, 
   3.72226114208603*^9, 3.7222612592408447`*^9, 3.724734992203364*^9, 
   3.724736971910231*^9, {3.7247371475345707`*^9, 3.724737168339645*^9}, {
   3.724757553023135*^9, 3.7247575644084*^9}, {3.772875679646613*^9, 
   3.772875683767376*^9}},
 CellLabel->
  "In[1223]:=",ExpressionUUID->"29abbc03-dd41-43da-9ab4-2900c984b26c"],

Cell[TextData[{
 "We see that we are extremely close but still not quite satisfactory. \n\
Actually this would work much better if we used the post-2000 average for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "A"], TraditionalForm]],ExpressionUUID->
  "d01962b5-d75c-4d2d-b9c0-4109b3af64e7"],
 " which is 1.2755(11) (Marciano, private communication)."
}], "Text",
 CellChangeTimes->{{3.717496959705554*^9, 3.717496971198353*^9}, 
   3.7174971067120647`*^9, {3.722693260943823*^9, 3.722693271811672*^9}, {
   3.7226933204232473`*^9, 3.722693327387087*^9}, {3.725596742309067*^9, 
   3.725596787382249*^9}, {3.725596819086301*^9, 
   3.72559682694838*^9}},ExpressionUUID->"5b723d5f-d14d-420d-b7cd-\
414f35586187"],

Cell["\<\
Let us also compare with Eq. 17 of [Czarnecki et al. 2004] to check how close \
we are in including all corrections. See text after Eq. 120 in companion \
paper as well.\
\>", "Text",ExpressionUUID->"120f3cfa-4a48-495c-99aa-20c8b0dd1994"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Born rates", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.694810739745351*^9, 
  3.69481074289781*^9}},ExpressionUUID->"0a946751-a117-4719-8b42-\
08f5a5e4af45"],

Cell["\<\
We compute in this section the Born rates for n -> p and p -> n.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6983987832133303`*^9, 
  3.698398802315034*^9}},ExpressionUUID->"27e1a108-f5d4-4444-884a-\
118fe5792c6a"],

Cell["Tools to perform integration on electron momentum", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698398608294354*^9, 
  3.698398618526195*^9}},ExpressionUUID->"bdf9d26c-ac89-497c-81d3-\
1eaf143a16eb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pemin", "=", "0.00001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pemiddle", "[", "x_", "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Max", "[", 
     RowBox[{
      SuperscriptBox["pemin", "2"], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Q", "/", "me"}], " ", ")"}], "2"], "-", "1", " ", "-", 
       RowBox[{"If", "[", 
        RowBox[{"$QEDMassShift", ",", 
         RowBox[{"dme2x", "[", "x", "]"}], ",", "0"}], "]"}]}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pemaxC", "[", "x_", "]"}], ":=", 
   RowBox[{"Max", "[", 
    RowBox[{"7", ",", 
     RowBox[{"30", "/", "x"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pemax", "[", "x_", "]"}], ":=", 
   RowBox[{"Max", "[", 
    RowBox[{"7", ",", 
     RowBox[{"30", "/", "x"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.698041030980616*^9, 3.698041036216537*^9}, {
   3.698041376634704*^9, 3.698041413522688*^9}, 3.698044437531192*^9, 
   3.6980661889741364`*^9, {3.69806661635434*^9, 3.698066618724098*^9}, {
   3.698066761486964*^9, 3.698066763579155*^9}, 3.698067315161236*^9, 
   3.699772820771337*^9, {3.700314501722332*^9, 3.700314608544704*^9}, {
   3.700314642084844*^9, 3.7003146494058533`*^9}, {3.70031468456069*^9, 
   3.700314721393519*^9}, {3.700314924896723*^9, 3.700314961989861*^9}, {
   3.700315002498143*^9, 3.700315050137404*^9}, {3.700315091905972*^9, 
   3.7003150935970182`*^9}, {3.7003151950091047`*^9, 3.700315198861936*^9}, {
   3.700315305454712*^9, 3.7003153098658037`*^9}, {3.700315415308563*^9, 
   3.700315417191904*^9}, {3.700315464027751*^9, 3.700315471257821*^9}, {
   3.70031552446618*^9, 3.700315527468088*^9}, {3.700315722520177*^9, 
   3.700315784252084*^9}, {3.700315865176819*^9, 3.700315865338437*^9}, {
   3.700315915709475*^9, 3.7003159581644087`*^9}, {3.7003311702786303`*^9, 
   3.700331170797035*^9}, 3.7163671659338827`*^9, 3.716367394491531*^9, 
   3.717504630730665*^9, {3.71856104164403*^9, 3.7185610479393587`*^9}, {
   3.718561097016491*^9, 3.7185610999181213`*^9}, {3.718622230267576*^9, 
   3.7186222590156193`*^9}, {3.722694457122851*^9, 3.72269446209513*^9}, {
   3.7227619875014677`*^9, 3.722761999621501*^9}, {3.722762103264455*^9, 
   3.722762104823028*^9}, {3.722762591049333*^9, 3.722762605300393*^9}},
 CellLabel->
  "In[1228]:=",ExpressionUUID->"2a3b0471-b7fc-4dc6-91dd-e138e1b2a054"],

Cell["\<\
$TnuEqualT is some cheat to check detailed balance. Should be False. When it \
is True neutrinos have always the plasma temperature.\
\>", "Text",ExpressionUUID->"b8231bf5-ae3b-42fd-8c90-f542b2983c72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TnuEqualT", "=", "False"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717409005755875*^9, 3.717409016275062*^9}, {
  3.717409955929406*^9, 3.7174099572314463`*^9}, {3.717416386748369*^9, 
  3.717416394619011*^9}, {3.717419226281184*^9, 3.71741923444694*^9}, {
  3.718453617782436*^9, 3.718453653728888*^9}, {3.722690982872013*^9, 
  3.722690995955434*^9}},
 CellLabel->
  "In[1232]:=",ExpressionUUID->"61d479f9-1ee9-4be7-a0f6-d05f50ed9201"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"IntegratedpNpoints", "[", 
    RowBox[{"fun_", ",", "sgnq_", ",", "Tv_", ",", "Npoints_"}], "]"}], ":=", 
   
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "=", 
        FractionBox["me", 
         RowBox[{"(", 
          RowBox[{"kB", " ", "Tv"}], ")"}]]}], " ", ",", 
       RowBox[{"znu", "=", 
        FractionBox["me", 
         RowBox[{"(", 
          RowBox[{"kB", " ", "Tv", " ", 
           RowBox[{"T\[Nu]overT", "[", "Tv", "]"}]}], ")"}]]}]}], " ", "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"$FastPENRatesIntegrals", ",", "\[IndentingNewLine]", 
       RowBox[{"IntegrateFunction", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"fun", "[", 
           RowBox[{"#", ",", "x", ",", 
            RowBox[{"If", "[", 
             RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", 
            "sgnq"}], "]"}], "&"}], ",", "pemin", ",", 
         RowBox[{"pemaxC", "[", "x", "]"}], ",", "Npoints"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{"fun", "[", 
          RowBox[{"pe", ",", "x", ",", 
           RowBox[{"If", "[", 
            RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", 
           "sgnq"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"pe", ",", "pemin", ",", 
           RowBox[{"pemiddle", "[", "x", "]"}], ",", 
           RowBox[{"pemax", "[", "x", "]"}]}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntegrateRatedp", "[", 
    RowBox[{"fun_", ",", "sgnq_", ",", "Tv_"}], "]"}], ":=", 
   RowBox[{"IntegratedpNpoints", "[", 
    RowBox[{"fun", ",", "sgnq", ",", "Tv", ",", "$PENRatesIntegralsPoints"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.695398343771329*^9, 3.695398362885261*^9}, {
   3.695399485280239*^9, 3.695399521369014*^9}, {3.695399686643532*^9, 
   3.69539968924185*^9}, {3.695399764136836*^9, 3.695399779219783*^9}, {
   3.695400814121414*^9, 3.695400846693153*^9}, {3.695400911765231*^9, 
   3.695400912076379*^9}, {3.695401097556179*^9, 3.695401181636235*^9}, {
   3.695401289156761*^9, 3.695401294499518*^9}, {3.695467287005559*^9, 
   3.6954672890931873`*^9}, {3.6954674896426153`*^9, 3.695467493767289*^9}, {
   3.695467755516612*^9, 3.695467757211896*^9}, {3.696678706577623*^9, 
   3.6966787314586782`*^9}, {3.696678813740855*^9, 3.696678816508926*^9}, {
   3.696685295789706*^9, 3.69668529703365*^9}, {3.696685423523271*^9, 
   3.6966854295024433`*^9}, {3.6966865741864433`*^9, 3.696686597132689*^9}, {
   3.696686672441389*^9, 3.6966866744208183`*^9}, {3.696757491999383*^9, 
   3.696757493875616*^9}, {3.696757532917583*^9, 3.696757534625513*^9}, {
   3.696758939702629*^9, 3.696758941689246*^9}, 3.696759404366641*^9, {
   3.6967603043206463`*^9, 3.696760336595397*^9}, {3.6967604236670322`*^9, 
   3.696760437846682*^9}, {3.698039833281588*^9, 3.698039835981708*^9}, {
   3.69804076268283*^9, 3.6980407680354643`*^9}, {3.6980409896632223`*^9, 
   3.698041044642728*^9}, {3.698041113903118*^9, 3.6980411344527617`*^9}, {
   3.69804134931771*^9, 3.698041419440324*^9}, {3.6984133845143423`*^9, 
   3.698413403781623*^9}, {3.698415279380056*^9, 3.698415281974998*^9}, {
   3.6984153472510777`*^9, 3.698415371987096*^9}, {3.698415435501484*^9, 
   3.698415441188363*^9}, {3.698415517006961*^9, 3.69841551714813*^9}, {
   3.699585678166391*^9, 3.699585678547162*^9}, {3.699585743649434*^9, 
   3.699585745987908*^9}, {3.699585790008101*^9, 3.6995857920794*^9}, {
   3.699591143594582*^9, 3.699591146900576*^9}, {3.699772821569105*^9, 
   3.699772822300264*^9}, {3.699773002844351*^9, 3.699773003362422*^9}, {
   3.700310116873488*^9, 3.7003101426120872`*^9}, {3.700310252280188*^9, 
   3.700310253132824*^9}, {3.7003107845793247`*^9, 3.70031078478358*^9}, {
   3.700314651990224*^9, 3.7003146522656717`*^9}, {3.7003150330579987`*^9, 
   3.700315033258484*^9}, 3.700315066963863*^9, {3.700315102826486*^9, 
   3.700315176912191*^9}, {3.700315236156074*^9, 3.7003153118780107`*^9}, {
   3.7003156464244328`*^9, 3.700315646504738*^9}, 3.70031575064185*^9, {
   3.7003157990589123`*^9, 3.700315812149708*^9}, {3.700315842940363*^9, 
   3.700315843197967*^9}, {3.7003161431706247`*^9, 3.700316143457432*^9}, {
   3.700316229704074*^9, 3.700316229982604*^9}, {3.70031631359198*^9, 
   3.700316313749628*^9}, {3.700330033619102*^9, 3.700330033946941*^9}, {
   3.7003747293534813`*^9, 3.700374750766024*^9}, {3.700383760866272*^9, 
   3.7003837672854567`*^9}, {3.7006505815569153`*^9, 
   3.7006505820573874`*^9}, {3.7006508688436832`*^9, 3.700650869701921*^9}, 
   3.700790015116714*^9, {3.7008018023318043`*^9, 3.70080188210575*^9}, {
   3.713687656852253*^9, 3.7136876890557737`*^9}, {3.71636691233786*^9, 
   3.716366936958026*^9}, {3.7163670159878902`*^9, 3.7163670473051367`*^9}, {
   3.716367479609576*^9, 3.716367481647344*^9}, 3.71655243501036*^9, {
   3.7174092289088993`*^9, 3.717409243100081*^9}, {3.718513681111961*^9, 
   3.7185137801188803`*^9}, {3.7185139593186398`*^9, 3.71851397952157*^9}, {
   3.722693380480543*^9, 3.722693392278079*^9}, 3.722763012826923*^9},
 CellLabel->
  "In[1233]:=",ExpressionUUID->"9520c07e-d39a-478c-853d-92a23dc5364f"],

Cell["\<\
Energy as a function of momentum, taking into account QED mass shifts. 
This is only used if the option is set to True but it is useless because it \
is taken into account in finite temperature corrections\
\>", "Text",
 CellChangeTimes->{{3.716277803457621*^9, 3.7162778165624123`*^9}, {
  3.7226944859220057`*^9, 
  3.7226945141239567`*^9}},ExpressionUUID->"7ee89c75-22e3-4107-8865-\
d5a8c4899e1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"enOFpe", "[", 
    RowBox[{"pe_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     SuperscriptBox["pe", "2"], "+", "1", " ", "+", 
     RowBox[{"If", "[", 
      RowBox[{"$QEDMassShift", ",", 
       RowBox[{"dme2x", "[", "x", "]"}], ",", "0"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.716277746112768*^9, 3.716277761669401*^9}, 
   3.7175046388158627`*^9, {3.718622234595702*^9, 3.71862225902516*^9}},
 CellLabel->
  "In[1235]:=",ExpressionUUID->"d0d51a82-3164-4008-89cb-dff494f0dc02"],

Cell["\<\
Functions to build integrands in electron momentum. Without and with CCR \
corrections. This is then passed to the integrating routine IntegrateRatedp.\
\>", "Text",
 CellChangeTimes->{{3.716277822270835*^9, 3.716277882852229*^9}, {
   3.716277981636797*^9, 3.7162779881413116`*^9}, 
   3.722763013541635*^9},ExpressionUUID->"7eef18f2-c24d-4bb2-91ca-\
d84f48196186"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IPENdpFrom\[Chi]NoCCR", "[", 
    RowBox[{
    "en_", ",", "pe_", ",", "x_", ",", "znu_", ",", "sgnq_", ",", 
     "\[Chi]function_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", "=", 
       RowBox[{"Q", "/", "me"}]}], " ", "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b", "=", 
         RowBox[{"pe", "/", "en"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        SuperscriptBox["pe", "2"], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Chi]function", "[", 
           RowBox[{"en", ",", "pe", ",", "x", ",", "znu", ",", "sgnq"}], 
           "]"}], "+", 
          RowBox[{"\[Chi]function", "[", 
           RowBox[{
            RowBox[{"-", "en"}], ",", "pe", ",", "x", ",", "znu", ",", 
            "sgnq"}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.716276413806179*^9, 3.716276443844481*^9}, 
   3.7162764884947443`*^9, {3.716277161842799*^9, 3.716277165318138*^9}, {
   3.716277243256913*^9, 3.7162772620880947`*^9}, {3.716277364498893*^9, 
   3.716277364551629*^9}, {3.716277532308092*^9, 3.7162775938905973`*^9}, {
   3.7162776243118*^9, 3.716277632556304*^9}, 3.71636645439953*^9, 
   3.7163670791114407`*^9, 3.717328441628826*^9, {3.717328604575164*^9, 
   3.71732860792118*^9}},
 CellLabel->
  "In[1236]:=",ExpressionUUID->"3c6d5dad-bd6b-4e20-ba27-18f4fc926d17"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Fermi", "[", 
    RowBox[{"sgnq_", ",", "signE_", ",", 
     RowBox[{"b_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sgnq", " ", "signE"}], " ", ">", "0"}], ",", 
     RowBox[{"Fermi", "[", "b", "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"Fermi", ",", "Listable"}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717328447208086*^9, 3.717328451643001*^9}, {
  3.7173284840637293`*^9, 3.7173285026750307`*^9}, {3.7173285452326517`*^9, 
  3.7173285676468067`*^9}, {3.717328931210657*^9, 3.7173289393680058`*^9}, {
  3.717329068199037*^9, 3.717329069150463*^9}, {3.71732911541639*^9, 
  3.717329131868677*^9}, {3.71786751636167*^9, 3.717867517915451*^9}},
 CellLabel->
  "In[1237]:=",ExpressionUUID->"9313ce37-ccbf-4037-9576-03838c5b14f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IPENdpFrom\[Chi]CCR", "[", 
    RowBox[{
    "en_", ",", "pe_", ",", "x_", ",", "znu_", ",", "sgnq_", ",", 
     "\[Chi]function_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", "=", 
        RowBox[{"Q", "/", "me"}]}], " ", ",", 
       RowBox[{"b", "=", 
        RowBox[{"pe", "/", "en"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox["pe", "2"], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]function", "[", 
          RowBox[{"en", ",", "pe", ",", "x", ",", "znu", ",", "sgnq"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"RadiativeCorrections", "[", 
           RowBox[{"b", ",", 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"sgnq", " ", 
               RowBox[{"Q", "/", "me"}]}], "-", "en"}], "]"}], ",", "en"}], 
           "]"}], ")"}], 
         RowBox[{"Fermi", "[", 
          RowBox[{"sgnq", ",", "1", ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[Chi]function", "[", 
          RowBox[{
           RowBox[{"-", "en"}], ",", "pe", ",", "x", ",", "znu", ",", 
           "sgnq"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"RadiativeCorrections", "[", 
           RowBox[{"b", ",", " ", 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"sgnq", " ", 
               RowBox[{"Q", "/", "me"}]}], "+", "en"}], "]"}], ",", "en"}], 
           "]"}], ")"}], 
         RowBox[{"Fermi", "[", 
          RowBox[{"sgnq", ",", 
           RowBox[{"-", "1"}], ",", "b"}], "]"}]}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.716276413806179*^9, 3.716276443844481*^9}, 
   3.7162764884947443`*^9, {3.716277161842799*^9, 3.716277165318138*^9}, {
   3.716277243256913*^9, 3.7162772620880947`*^9}, {3.716277364498893*^9, 
   3.716277364551629*^9}, {3.716277532308092*^9, 3.7162775938905973`*^9}, {
   3.7162776243118*^9, 3.716277632556304*^9}, 3.71636645439953*^9, 
   3.7163670791114407`*^9, {3.717328441628826*^9, 3.717328443337071*^9}, {
   3.7173285216955*^9, 3.717328535633091*^9}, {3.717328580021858*^9, 
   3.7173285950300903`*^9}, {3.717329142162608*^9, 3.717329143923966*^9}, {
   3.717388761555011*^9, 3.7173888093714437`*^9}, {3.717389741200857*^9, 
   3.717389752968251*^9}, 3.717395040641227*^9, {3.717490589597951*^9, 
   3.717490592273706*^9}, {3.7174953726134567`*^9, 3.717495372984668*^9}, {
   3.717823814210011*^9, 3.7178238157455397`*^9}},
 CellLabel->
  "In[1239]:=",ExpressionUUID->"eb23cbbb-e0b6-4770-8138-b524ca706f39"],

Cell["\<\
Eq 2.29 in [Brown & Sawyer] for the Born approximation. It is Eq. 79 of \
companion paper\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"8ff8497e-b299-4e92-8a52-4deaee79775b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]", "[", 
    RowBox[{"en_", ",", "pe_", ",", "x_", ",", "znu_", ",", "sgnq_"}], "]"}], 
   ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", "=", 
       RowBox[{"Q", "/", "me"}]}], " ", "}"}], ",", 
     RowBox[{
      RowBox[{"FD\[Nu]", "[", 
       RowBox[{
        RowBox[{"en", "-", 
         RowBox[{"sgnq", " ", "q"}]}], ",", 
        RowBox[{"sgnq", " ", "\[Xi]\[Nu]"}], ",", "znu"}], "]"}], 
      RowBox[{"FD", "[", 
       RowBox[{
        RowBox[{"-", "en"}], ",", "x"}], "]"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"en", "-", 
         RowBox[{"sgnq", " ", "q"}]}], ")"}], "2"]}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.695398950630999*^9, 3.695398976056396*^9}, {
   3.69539970672593*^9, 3.695399732972118*^9}, {3.695410614720375*^9, 
   3.695410647763555*^9}, {3.6965667042117*^9, 3.696566704907988*^9}, {
   3.6984150971841593`*^9, 3.6984151233485403`*^9}, {3.698415183573344*^9, 
   3.6984152200994368`*^9}, {3.698415352277474*^9, 3.698415354414299*^9}, {
   3.698415499664236*^9, 3.6984155026450787`*^9}, 3.699772823138732*^9, {
   3.7162771988663597`*^9, 3.716277199438176*^9}, {3.719811562033264*^9, 
   3.719811576251759*^9}, {3.722694556045295*^9, 3.722694556863142*^9}, 
   3.722694635415139*^9},
 CellLabel->
  "In[1240]:=",ExpressionUUID->"f22f2b69-0352-4639-89d8-b6ffe299b722"],

Cell["\<\
Eq 2.30 in [Brown & Sawyer], that is the integration of Eq. 78 in companion \
paper\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"b353db33-8d6c-4550-b782-1ece7208537d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IPENdp", "[", 
   RowBox[{"pe_", ",", "x_", ",", "znu_", ",", "sgnq_"}], "]"}], ":=", 
  RowBox[{"IPENdpFrom\[Chi]NoCCR", "[", 
   RowBox[{
    RowBox[{"enOFpe", "[", 
     RowBox[{"pe", ",", "x"}], "]"}], ",", "pe", ",", "x", ",", 
    RowBox[{"If", "[", 
     RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", "sgnq", ",", 
    "\[Chi]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.695398458129932*^9, 3.695398458544178*^9}, {
   3.695398569314012*^9, 3.6953985698181467`*^9}, {3.695398603354608*^9, 
   3.695398604153324*^9}, {3.695398779374422*^9, 3.6953988952701473`*^9}, {
   3.6953989303928556`*^9, 3.695398934757702*^9}, {3.695398994343876*^9, 
   3.695399005306608*^9}, {3.695399742307755*^9, 3.695399747889206*^9}, 
   3.696255769870289*^9, {3.696567680463458*^9, 3.696567699565014*^9}, {
   3.698039767647717*^9, 3.69803978205873*^9}, 3.698044446449127*^9, {
   3.698065500738366*^9, 3.6980655016353827`*^9}, 3.698398640112933*^9, {
   3.69841450361823*^9, 3.698414522583375*^9}, {3.698415023866214*^9, 
   3.698415026417942*^9}, {3.698415103177809*^9, 3.698415105663721*^9}, {
   3.6984375702760563`*^9, 3.698437571339991*^9}, {3.7162772070220413`*^9, 
   3.716277210373063*^9}, {3.7162773700326357`*^9, 3.716277390188222*^9}, {
   3.716277657342065*^9, 3.71627770805374*^9}, {3.716277769209497*^9, 
   3.7162777763108892`*^9}, 3.7174092869694433`*^9},
 CellLabel->
  "In[1241]:=",ExpressionUUID->"77221fcc-4bbc-44cd-ba5c-3493d0e574ce"],

Cell["\<\
We also define a function which is incorrect in which we force the neutrinos \
to have the temperature of photons. This is to check detailed balance. \
Indeed, detailed balance is satisfied only if all species have the same \
temperature.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698398641160706*^9, 
  3.698398677133802*^9}},ExpressionUUID->"2be3d427-7cab-4516-a8a2-\
6f6ab9910885"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IPENdpCheatNeutrinoTemperature", "[", 
   RowBox[{"pe_", ",", "x_", ",", "znu_", ",", "sgnq_"}], "]"}], ":=", 
  RowBox[{"IPENdpFrom\[Chi]NoCCR", "[", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{
      SuperscriptBox["pe", "2"], "+", "1"}], "]"}], ",", "pe", ",", "x", ",", 
    "x", ",", "sgnq", ",", "\[Chi]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.695398458129932*^9, 3.695398458544178*^9}, {
   3.695398569314012*^9, 3.6953985698181467`*^9}, {3.695398603354608*^9, 
   3.695398604153324*^9}, {3.695398779374422*^9, 3.6953988952701473`*^9}, {
   3.6953989303928556`*^9, 3.695398934757702*^9}, {3.695398994343876*^9, 
   3.695399005306608*^9}, {3.695399742307755*^9, 3.695399747889206*^9}, 
   3.696255769870289*^9, {3.696567680463458*^9, 3.696567699565014*^9}, {
   3.698039767647717*^9, 3.69803978205873*^9}, 3.698044446449127*^9, {
   3.698065500738366*^9, 3.6980655016353827`*^9}, 3.698398640112933*^9, {
   3.716277897226012*^9, 3.716277913004292*^9}},
 CellLabel->
  "In[1242]:=",ExpressionUUID->"77b77f46-53d5-4ec2-827a-9855477a83ad"],

Cell[BoxData[
 RowBox[{"Born", " ", "rates", " ", "are", " ", "given", " ", "by", " ", Cell[
  "Eq 2.30 in [Brown & Sawyer].", "Text",
   CellChangeTimes->{{3.6983985961507998`*^9, 3.698398603574793*^9}, {
    3.698398634620982*^9, 3.698398635092081*^9}},ExpressionUUID->
   "9345206c-7346-47da-a910-1ff94cdbe409"]}]], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698398723172669*^9, 
  3.698398748507123*^9}},ExpressionUUID->"a7d465fd-73c3-46d6-8f2c-\
cc0a1bb23b93"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]nTOpBORN", "[", "Tv_", "]"}], ":=", 
   RowBox[{"IntegrateRatedp", "[", 
    RowBox[{"IPENdp", ",", "1", ",", "Tv"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]pTOnBORN", "[", "Tv_", "]"}], ":=", 
   RowBox[{"IntegrateRatedp", "[", 
    RowBox[{"IPENdp", ",", 
     RowBox[{"-", "1"}], ",", "Tv"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.695399410917375*^9, 3.695399430490005*^9}, 
   3.6953994836958942`*^9, {3.695399514744933*^9, 3.695399525106229*^9}, 
   3.695399695534388*^9, {3.6953997693746367`*^9, 3.695399773379814*^9}, {
   3.695399815986622*^9, 3.695399823611052*^9}, {3.695399890177977*^9, 
   3.695399891302362*^9}, {3.695401296177224*^9, 3.69540129748139*^9}, {
   3.696557812420842*^9, 3.696557822627001*^9}, {3.698053488688244*^9, 
   3.698053496023278*^9}, {3.698398769486915*^9, 3.6983987745712643`*^9}, {
   3.6984133697115993`*^9, 3.6984133782242947`*^9}, {3.6984135050385313`*^9, 
   3.69841351319158*^9}, {3.7003102998326187`*^9, 3.700310301398274*^9}, {
   3.7003302812824306`*^9, 3.7003302815242968`*^9}, {3.7003308983349447`*^9, 
   3.7003308985755672`*^9}, {3.700332084842532*^9, 3.700332085245425*^9}, {
   3.700335166122553*^9, 3.7003351664473133`*^9}, {3.700790260978003*^9, 
   3.700790263521652*^9}, {3.70080188894102*^9, 3.700801889379731*^9}, {
   3.716695325524024*^9, 3.716695327665951*^9}, {3.722763014476021*^9, 
   3.72276301469876*^9}},
 CellLabel->
  "In[1243]:=",ExpressionUUID->"8c85cc93-0c99-4882-8964-ddc3233147e2"],

Cell["\<\
Born rates where the neutrino temperature is cheated to be equal to photons \
temperature are then given by\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.696567893641364*^9, 3.696567906065072*^9}, {
  3.696757553903764*^9, 3.6967575556976748`*^9}, {3.698040772277629*^9, 
  3.6980407728933487`*^9}, {3.698398761027384*^9, 
  3.6983987629383497`*^9}},ExpressionUUID->"21beab32-10b2-4584-8505-\
97af38a9c27a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]nTOpBORNCheatNeutrino", "[", "Tv_", "]"}], ":=", 
   RowBox[{"IntegrateRatedp", "[", 
    RowBox[{"IPENdpCheatNeutrinoTemperature", ",", "1", ",", "Tv"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]pTOnBORNCheatNeutrino", "[", "Tv_", "]"}], ":=", 
   RowBox[{"IntegrateRatedp", "[", 
    RowBox[{"IPENdpCheatNeutrinoTemperature", ",", 
     RowBox[{"-", "1"}], ",", "Tv"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6965677194344473`*^9, 3.696567742325178*^9}, {
  3.696686753153763*^9, 3.696686753726232*^9}, {3.69841341858247*^9, 
  3.698413440032023*^9}, {3.700310304049241*^9, 3.700310307002756*^9}, {
  3.7003302831790533`*^9, 3.700330283395055*^9}, {3.700330899125334*^9, 
  3.700330899309231*^9}, {3.7003320857619057`*^9, 3.700332086043117*^9}, {
  3.700335166653821*^9, 3.700335167015553*^9}, {3.7007902669571238`*^9, 
  3.700790270165579*^9}, {3.7008018899059353`*^9, 3.700801890322377*^9}, {
  3.716695329996834*^9, 3.716695337527234*^9}, {3.722763015446022*^9, 
  3.7227630159213123`*^9}},
 CellLabel->
  "In[1245]:=",ExpressionUUID->"b0aa3f34-af67-4556-9008-87f240fa0f8a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finite mass effects", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.696254794317053*^9, 3.6962548038270597`*^9}, {
  3.7003898819126663`*^9, 
  3.700389884401021*^9}},ExpressionUUID->"723317c7-2342-4aca-a638-\
46f8f874aa9e"],

Cell["\<\
For finite mass effects, we use a (Fokker-Planck) expansion which leads to \
one-dimensional integrals.
We include also the weak-magnetism which is important indeed. This is B23 of \
companion paper.\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"e41e1e3e-e45f-42c1-8e51-903cf72712ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]FM", "[", 
    RowBox[{"en_", ",", "pe_", ",", "x_", ",", "znu_", ",", "sgnq_"}], "]"}], 
   ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Phi]", "=", 
        RowBox[{"sgnq", " ", "\[Xi]\[Nu]"}]}], ",", 
       RowBox[{"q", "=", 
        RowBox[{"Q", "/", "me"}]}], " ", ",", 
       RowBox[{"M", "=", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{"mp", "+", "mn", " ", "-", 
           RowBox[{"sgnq", " ", "Q"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"2", "me"}], " ", ")"}]]}], ",", 
       RowBox[{"Mp", "=", 
        RowBox[{"mp", "/", "me"}]}], " ", ",", 
       RowBox[{"Mn", "=", 
        RowBox[{"mn", " ", "/", "me"}]}], " ", ",", 
       RowBox[{"enu", "=", 
        RowBox[{"en", "-", 
         RowBox[{"sgnq", " ", 
          RowBox[{"Q", "/", "me"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"f1", "=", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"sgnq", " ", "gA"}]}], ")"}], "2"], "+", 
           RowBox[{"4", "fWM", " ", "sgnq", " ", "gA"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"3", 
            SuperscriptBox["gA", "2"]}]}], ")"}]]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"f2", "=", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"sgnq", " ", "gA"}]}], ")"}], "2"], "-", 
           RowBox[{"4", "fWM", " ", "sgnq", " ", "gA"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"3", 
            SuperscriptBox["gA", "2"]}]}], ")"}]]}], ",", 
       RowBox[{"f3", "=", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["gA", "2"], "-", "1"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"3", 
            SuperscriptBox["gA", "2"]}]}], ")"}]]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f1", "*", 
       RowBox[{"FD\[Nu]e2p0", "[", 
        RowBox[{"enu", ",", "\[Phi]", ",", "znu"}], "]"}], 
       RowBox[{"FD", "[", 
        RowBox[{
         RowBox[{"-", "en"}], ",", "x"}], "]"}], 
       RowBox[{"(", 
        FractionBox[
         SuperscriptBox["pe", "2"], 
         RowBox[{"M", "*", "en"}]], ")"}]}], "\[IndentingNewLine]", "+", 
      RowBox[{"f2", "*", 
       RowBox[{"FD\[Nu]e3p0", "[", 
        RowBox[{"enu", ",", "\[Phi]", ",", "znu"}], "]"}], 
       RowBox[{"FD", "[", 
        RowBox[{
         RowBox[{"-", "en"}], ",", "x"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"-", 
         FractionBox["1", "M"]}], ")"}]}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2", "+", "f3"}], ")"}], 
       FractionBox["1", 
        RowBox[{"2", "x", " ", "M"}]], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"FD\[Nu]e4p2", "[", 
           RowBox[{"enu", ",", "\[Phi]", ",", "znu"}], "]"}], 
          RowBox[{"FD", "[", 
           RowBox[{
            RowBox[{"-", "en"}], ",", "x"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"FD\[Nu]e2p2", "[", 
           RowBox[{"enu", ",", "\[Phi]", ",", "znu"}], "]"}], 
          RowBox[{"FD", "[", 
           RowBox[{
            RowBox[{"-", "en"}], ",", "x"}], "]"}], 
          SuperscriptBox["pe", "2"]}]}], ")"}]}], "\[IndentingNewLine]", "+", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2", "+", "f3"}], ")"}], 
       FractionBox["1", 
        RowBox[{"2", "M"}]], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"FD\[Nu]e4p1", "[", 
           RowBox[{"enu", ",", "\[Phi]", ",", "znu"}], "]"}], 
          RowBox[{"FD", "[", 
           RowBox[{
            RowBox[{"-", "en"}], ",", "x"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"FD\[Nu]e2p1", "[", 
           RowBox[{"enu", ",", "\[Phi]", ",", "znu"}], "]"}], 
          RowBox[{"FD", "[", 
           RowBox[{
            RowBox[{"-", "en"}], ",", "x"}], "]"}], 
          SuperscriptBox["pe", "2"]}]}], ")"}]}], "\[IndentingNewLine]", "-", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], 
       FractionBox["1", 
        RowBox[{"x", " ", "M"}]], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"FD\[Nu]e3p1", "[", 
           RowBox[{"enu", ",", "\[Phi]", ",", "znu"}], "]"}], 
          RowBox[{"FD", "[", 
           RowBox[{
            RowBox[{"-", "en"}], ",", "x"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"FD\[Nu]e2p1", "[", 
           RowBox[{"enu", ",", "\[Phi]", ",", "znu"}], "]"}], 
          RowBox[{"FD", "[", 
           RowBox[{
            RowBox[{"-", "en"}], ",", "x"}], "]"}], 
          RowBox[{
           SuperscriptBox["pe", "2"], "/", 
           RowBox[{"(", 
            RowBox[{"-", "en"}], ")"}]}]}]}], ")"}]}], "\[IndentingNewLine]", 
      "-", 
      RowBox[{"f3", "*", 
       FractionBox["3", 
        RowBox[{"x", " ", "M"}]], 
       RowBox[{"FD\[Nu]e2p0", "[", 
        RowBox[{"enu", ",", "\[Phi]", ",", "znu"}], "]"}], 
       RowBox[{"FD", "[", 
        RowBox[{
         RowBox[{"-", "en"}], ",", "x"}], "]"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "This", " ", "term", " ", "seems", " ", "to", " ", "give", " ", "very",
         " ", "small", " ", "corrections"}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{"f3", "*", 
       FractionBox["1", 
        RowBox[{"3", "M"}]], 
       RowBox[{"FD\[Nu]e3p1", "[", 
        RowBox[{"enu", ",", "\[Phi]", ",", "znu"}], "]"}], 
       RowBox[{"FD", "[", 
        RowBox[{
         RowBox[{"-", "en"}], ",", "x"}], "]"}], 
       FractionBox[
        SuperscriptBox["pe", "2"], 
        RowBox[{"(", "en", ")"}]]}], "\[IndentingNewLine]", "+", 
      RowBox[{"f3", "*", 
       FractionBox["2", 
        RowBox[{"2", " ", "x", "*", "3", "M"}]], 
       RowBox[{"FD\[Nu]e3p2", "[", 
        RowBox[{"enu", ",", "\[Phi]", ",", "znu"}], "]"}], 
       RowBox[{"FD", "[", 
        RowBox[{
         RowBox[{"-", "en"}], ",", "x"}], "]"}], 
       FractionBox[
        SuperscriptBox["pe", "2"], 
        RowBox[{"(", "en", ")"}]]}], "\[IndentingNewLine]", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2", "+", "f3"}], ")"}], "*", 
       FractionBox["3", 
        RowBox[{"2", "x"}]], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["Mn", "Mp"], ")"}], "sgnq"]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FD\[Nu]e2p1", "[", 
          RowBox[{"enu", ",", "\[Phi]", ",", "znu"}], "]"}], 
         RowBox[{"FD", "[", 
          RowBox[{
           RowBox[{"-", "en"}], ",", "x"}], "]"}]}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6962550840745077`*^9, 3.696255136252389*^9}, 
   3.696255172348279*^9, {3.696255228571126*^9, 3.69625550845991*^9}, {
   3.696255550696525*^9, 3.69625568294969*^9}, {3.69625591588383*^9, 
   3.696256232156506*^9}, 3.696256273049724*^9, {3.696256470190399*^9, 
   3.696256495163294*^9}, {3.696256873878521*^9, 3.6962568762595453`*^9}, {
   3.696259037344081*^9, 3.6962591253393593`*^9}, {3.696259250344853*^9, 
   3.6962592690508432`*^9}, {3.696259358040101*^9, 3.69625936112039*^9}, {
   3.6962594908482847`*^9, 3.696259517889698*^9}, {3.696264837991539*^9, 
   3.69626485240034*^9}, {3.696265027780849*^9, 3.696265040513764*^9}, {
   3.696279289063198*^9, 3.696279292978982*^9}, {3.6962793383583307`*^9, 
   3.696279397657769*^9}, {3.696279563048222*^9, 3.696279582091693*^9}, {
   3.696279768022735*^9, 3.696279860739958*^9}, {3.6962799901931753`*^9, 
   3.6962800010009003`*^9}, {3.696280560275667*^9, 3.6962805919750557`*^9}, {
   3.696280627353465*^9, 3.696280659073699*^9}, {3.696280744132368*^9, 
   3.696280746437504*^9}, {3.6962831748788223`*^9, 3.6962831794365377`*^9}, {
   3.696283293773486*^9, 3.6962832969197903`*^9}, {3.696283442760933*^9, 
   3.696283447622984*^9}, {3.696309801948155*^9, 3.6963098129719057`*^9}, {
   3.696325830973343*^9, 3.696325840767068*^9}, {3.696332097883363*^9, 
   3.696332100498987*^9}, {3.696524568776569*^9, 3.69652457648875*^9}, {
   3.696524609663616*^9, 3.696524611486115*^9}, {3.6965569464975243`*^9, 
   3.696556979450777*^9}, {3.696557018681233*^9, 3.696557026595565*^9}, {
   3.696557478549993*^9, 3.69655747943801*^9}, {3.696557532090814*^9, 
   3.696557532286015*^9}, {3.6965577038785067`*^9, 3.696557759254285*^9}, {
   3.6965586952695513`*^9, 3.696558782365836*^9}, {3.6965667722441797`*^9, 
   3.696566786948678*^9}, {3.696573120096664*^9, 3.696573197821598*^9}, {
   3.696582832777964*^9, 3.696582873254637*^9}, {3.6965830702104177`*^9, 
   3.696583072009185*^9}, {3.696583190271514*^9, 3.696583192627347*^9}, {
   3.6965836291844473`*^9, 3.696583651467708*^9}, {3.696583815128384*^9, 
   3.696583856725883*^9}, {3.696583899828402*^9, 3.696583976250347*^9}, 
   3.69658404150368*^9, {3.696584094048078*^9, 3.6965840994807653`*^9}, {
   3.6965842954250402`*^9, 3.6965842975503483`*^9}, {3.6965870929411297`*^9, 
   3.696587098710443*^9}, {3.696587266877104*^9, 3.6965872772494*^9}, {
   3.696587323555852*^9, 3.6965873236671333`*^9}, {3.6965873690956907`*^9, 
   3.696587375822775*^9}, {3.6965875687853394`*^9, 3.6965875838702517`*^9}, {
   3.6965876321031237`*^9, 3.69658763437122*^9}, {3.6965877172100763`*^9, 
   3.696587752520364*^9}, {3.6965883358075438`*^9, 3.696588368400316*^9}, {
   3.696588538185418*^9, 3.696588542930674*^9}, {3.696588845053216*^9, 
   3.6965888526658573`*^9}, {3.696588904543652*^9, 3.696588941406596*^9}, {
   3.696589023477706*^9, 3.696589024860847*^9}, {3.696589071696686*^9, 
   3.696589096568924*^9}, {3.696589274005783*^9, 3.696589276638145*^9}, {
   3.696589510809121*^9, 3.696589516051777*^9}, {3.696590137898149*^9, 
   3.696590146007287*^9}, {3.696590197467402*^9, 3.696590219400796*^9}, {
   3.6966849480703077`*^9, 3.6966849499379663`*^9}, {3.6966849905981913`*^9, 
   3.6966849994175*^9}, {3.6966851131363783`*^9, 3.6966851154909773`*^9}, {
   3.696685161717496*^9, 3.696685179207692*^9}, {3.696685253809986*^9, 
   3.6966852612602987`*^9}, {3.6966854994024487`*^9, 
   3.6966855206271563`*^9}, {3.696686053374311*^9, 3.6966860669317427`*^9}, {
   3.696686881897767*^9, 3.6966868923301907`*^9}, {3.696686937536787*^9, 
   3.696686946609812*^9}, {3.6967573623514977`*^9, 3.6967574356521606`*^9}, {
   3.696757471023973*^9, 3.696757473526969*^9}, {3.6967575051203537`*^9, 
   3.6967575074898157`*^9}, {3.696757578599225*^9, 3.696757659030326*^9}, {
   3.69675770787633*^9, 3.6967577129372597`*^9}, {3.696757753881567*^9, 
   3.696757785204947*^9}, {3.6967578224665213`*^9, 3.696757822667534*^9}, {
   3.6967578763529377`*^9, 3.6967578797022142`*^9}, {3.696760382823092*^9, 
   3.696760417555352*^9}, {3.696847426350315*^9, 3.696847470029755*^9}, {
   3.696847627203082*^9, 3.696847630792349*^9}, {3.69684792253981*^9, 
   3.696847925579247*^9}, {3.696928282875856*^9, 3.6969282860071993`*^9}, {
   3.697774398035717*^9, 3.69777439863405*^9}, {3.6977745036714497`*^9, 
   3.697774504307344*^9}, {3.697774743949761*^9, 3.6977747539196367`*^9}, {
   3.697775188091187*^9, 3.697775201868847*^9}, {3.697775283726116*^9, 
   3.6977752866033688`*^9}, {3.69777545533112*^9, 3.697775458076325*^9}, {
   3.697778342670827*^9, 3.697778368240925*^9}, {3.698398935969163*^9, 
   3.698398941560717*^9}, {3.699772824369452*^9, 3.699772827225759*^9}, {
   3.699775617892784*^9, 3.699775618908867*^9}, {3.7003119734493217`*^9, 
   3.700312261798493*^9}, {3.700312344600951*^9, 3.700312366759309*^9}, {
   3.700312409687209*^9, 3.7003124162119207`*^9}, {3.700313041279674*^9, 
   3.7003130440658693`*^9}, {3.700313079858214*^9, 3.700313125768229*^9}, {
   3.700313157625367*^9, 3.700313203507472*^9}, {3.700313377468502*^9, 
   3.700313496160695*^9}, {3.7003135414612627`*^9, 3.700313560109771*^9}, {
   3.700313638816244*^9, 3.700313671732316*^9}, {3.7003139105330753`*^9, 
   3.7003139181275587`*^9}, 3.700314018318172*^9, {3.700315358987657*^9, 
   3.700315366777594*^9}, {3.7003837838119698`*^9, 3.700383804163061*^9}, 
   3.716183954427652*^9, {3.716277084524795*^9, 3.716277105929679*^9}, {
   3.716277169797616*^9, 3.716277190572456*^9}, {3.7162906890643253`*^9, 
   3.7162907355289497`*^9}, {3.716291292564125*^9, 3.716291292702733*^9}, {
   3.716293435061982*^9, 3.716293494449728*^9}, {3.716366324343609*^9, 
   3.7163663285043373`*^9}, {3.716366360460844*^9, 3.71636636217318*^9}, {
   3.716366592480673*^9, 3.716366628098757*^9}, {3.716366740510944*^9, 
   3.716366751450691*^9}, {3.716366838280121*^9, 3.7163668412718687`*^9}, {
   3.716367468196246*^9, 3.716367470757457*^9}, {3.717581563114965*^9, 
   3.7175815636636133`*^9}, 3.717823821691613*^9, 3.71856125535143*^9, {
   3.718561340160096*^9, 3.71856141808107*^9}, {3.718561458023629*^9, 
   3.718561489296421*^9}, {3.718561520955574*^9, 3.718561552961865*^9}, {
   3.7185615861799183`*^9, 3.718561670357869*^9}, {3.718561717979561*^9, 
   3.718561718318781*^9}, {3.718561826254435*^9, 3.718561826550129*^9}, {
   3.71981196147549*^9, 3.7198120350614853`*^9}, {3.719812271865513*^9, 
   3.719812272574637*^9}, {3.719812445175852*^9, 3.719812445513715*^9}, {
   3.7222611300959053`*^9, 3.7222611419980593`*^9}, {3.72226118761819*^9, 
   3.722261189229352*^9}, 3.722694634967507*^9, {3.7226947255194263`*^9, 
   3.722694793866506*^9}, {3.7228474739745483`*^9, 3.722847524634362*^9}},
 CellLabel->
  "In[1247]:=",ExpressionUUID->"1516f96e-e5cb-41ce-b912-d8b5552f8330"],

Cell["\<\
Integrand for finite mass corrections. We couple it to radiative corrections.\
\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.69841026301672*^9, 3.698410272033594*^9}, {
  3.7162783986329193`*^9, 3.716278414732267*^9}, {3.7226946864414997`*^9, 
  3.722694692224091*^9}},ExpressionUUID->"91afd98c-f111-4b8b-b346-\
37170a827618"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"IPENdpFMNoCCR", "[", 
   RowBox[{"pe_", ",", "x_", ",", "znu_", ",", "sgnq_"}], "]"}], ":=", 
  RowBox[{"IPENdpFrom\[Chi]NoCCR", "[", 
   RowBox[{
    RowBox[{"enOFpe", "[", 
     RowBox[{"pe", ",", "x"}], "]"}], ",", "pe", ",", "x", ",", 
    RowBox[{"If", "[", 
     RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", "sgnq", ",", 
    "\[Chi]FM"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IPENdpFMCCR", "[", 
   RowBox[{"pe_", ",", "x_", ",", "znu_", ",", "sgnq_"}], "]"}], ":=", 
  RowBox[{"IPENdpFrom\[Chi]CCR", "[", 
   RowBox[{
    RowBox[{"enOFpe", "[", 
     RowBox[{"pe", ",", "x"}], "]"}], ",", "pe", ",", "x", ",", 
    RowBox[{"If", "[", 
     RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", "sgnq", ",", 
    "\[Chi]FM"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6954005016870937`*^9, 3.695400509874568*^9}, {
   3.695400547578013*^9, 3.6954005486200647`*^9}, {3.695400601792128*^9, 
   3.69540066893943*^9}, {3.695400795345083*^9, 3.695400804727413*^9}, {
   3.695400854881651*^9, 3.6954008688732853`*^9}, {3.695400928388785*^9, 
   3.695400934643552*^9}, {3.695401083128057*^9, 3.695401084754547*^9}, {
   3.695468370559737*^9, 3.6954683986967278`*^9}, {3.695468579124412*^9, 
   3.6954685820561647`*^9}, {3.6954686765024643`*^9, 3.695468678555917*^9}, {
   3.695468739398067*^9, 3.695468779033938*^9}, {3.695468847389958*^9, 
   3.695468849504677*^9}, {3.6980402158118143`*^9, 3.698040252316915*^9}, 
   3.698044407796039*^9, {3.6980598894731216`*^9, 3.6980599137392673`*^9}, {
   3.698437689707921*^9, 3.698437693378146*^9}, {3.699772828782111*^9, 
   3.699772830585927*^9}, {3.700019026784215*^9, 3.700019026798375*^9}, {
   3.716276448167439*^9, 3.716276468470104*^9}, 3.7162765743333483`*^9, {
   3.7162769365115747`*^9, 3.716276937258869*^9}, {3.716278024818199*^9, 
   3.716278041791514*^9}, {3.716278244052134*^9, 3.71627825004071*^9}, {
   3.7162783813091173`*^9, 3.716278437704521*^9}, {3.716278612882493*^9, 
   3.716278616024766*^9}, {3.716278854309566*^9, 3.716278862552463*^9}, {
   3.716349519519966*^9, 3.716349527550557*^9}, {3.7174093017490597`*^9, 
   3.717409305310698*^9}},
 CellLabel->
  "In[1248]:=",ExpressionUUID->"f5376b45-03ed-4ff4-b908-c2af6bdb6410"],

Cell["\<\
Integrand for finite mass corrections when neutrinos are forced to have the \
same temperature as photons.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.69841026301672*^9, 3.6984102872510567`*^9}, 
   3.716276596785042*^9},ExpressionUUID->"8e460082-b944-44d5-889c-\
5a36d170242b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IPENdpFMCheatNeutrinoTemperature", "[", 
   RowBox[{"pe_", ",", "x_", ",", "znu_", ",", "sgnq_"}], "]"}], ":=", 
  RowBox[{"IPENdpFrom\[Chi]NoCCR", "[", 
   RowBox[{
    RowBox[{"enOFpe", "[", 
     RowBox[{"pe", ",", "x"}], "]"}], ",", "pe", ",", "x", ",", "x", ",", 
    "sgnq", ",", "\[Chi]FM"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.698437594971993*^9, 3.698437596011796*^9}, {
  3.716278051793119*^9, 3.716278071128601*^9}, {3.716278253730515*^9, 
  3.716278257241229*^9}, {3.716279033267205*^9, 3.7162790335710983`*^9}, {
  3.716349555677299*^9, 3.716349559474678*^9}, {3.717823829495678*^9, 
  3.71782383090963*^9}},
 CellLabel->
  "In[1250]:=",ExpressionUUID->"c7314dda-41f7-4916-b5a9-60589e3197e1"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "\[Lambda]nTOpFMCCR", ",", "\[Lambda]pTOnFMCCR", ",", 
   "\[Lambda]nTOpFMNoCCR", ",", "\[Lambda]pTOnFMNoCCR", ",", 
   "\[Lambda]nTOpCheatNeutrinoFM", ",", "\[Lambda]pTOnCheatNeutrinoFM"}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.696256323113212*^9, 3.696256332353565*^9}, {
   3.6962568883754263`*^9, 3.696256896269373*^9}, {3.6962655747821903`*^9, 
   3.6962655841034613`*^9}, {3.69626563951473*^9, 3.6962656428867683`*^9}, {
   3.696265745093422*^9, 3.696265757703487*^9}, {3.696266300106792*^9, 
   3.6962663022176447`*^9}, {3.696280105405973*^9, 3.696280132482732*^9}, {
   3.696281672602948*^9, 3.696281674126233*^9}, {3.696557850874742*^9, 
   3.696557871199915*^9}, {3.696557903268799*^9, 3.696557913746582*^9}, 
   3.696567340391617*^9, 3.696567825286929*^9, {3.6965829121805468`*^9, 
   3.69658291655449*^9}, {3.696757621383925*^9, 3.696757621975607*^9}, {
   3.7162789216191797`*^9, 3.7162789365977488`*^9}, 3.716279898000435*^9},
 CellLabel->
  "In[1251]:=",ExpressionUUID->"72f6988d-8a30-499f-a89e-ddb72068fe9e"],

Cell[BoxData[
 RowBox[{"Finite", " ", "mass", " ", "corrections", " ", "using", " ", "the", 
  " ", 
  SubscriptBox["\[Lambda]", "0"], "which", " ", "is", " ", "corrected", " ", 
  "with", " ", "radiative", " ", 
  RowBox[{"corrections", ".", " ", "The"}], " ", "computation", " ", "below", 
  " ", "implements", " ", 
  RowBox[{"Eqs", ".", " ", "114"}], " ", "of", " ", "companion", " ", 
  RowBox[{"paper", "."}]}]], "Text",
 InitializationCell->True,
 CellChangeTimes->{
  3.772875743658222*^9},ExpressionUUID->"b3e10e1f-5256-4b59-ae82-\
0ed3df1885e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]nTOpFMCCR", "[", "Tv_", "]"}], ":=", 
   RowBox[{"IntegrateRatedp", "[", 
    RowBox[{"IPENdpFMCCR", ",", "1", ",", "Tv"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]pTOnFMCCR", "[", "Tv_", "]"}], ":=", 
   RowBox[{"IntegrateRatedp", "[", 
    RowBox[{"IPENdpFMCCR", ",", 
     RowBox[{"-", "1"}], ",", "Tv"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.696256323113212*^9, 3.696256332353565*^9}, {
   3.6962568883754263`*^9, 3.696256896269373*^9}, {3.6962655747821903`*^9, 
   3.6962655841034613`*^9}, {3.69626563951473*^9, 3.6962656428867683`*^9}, {
   3.696265745093422*^9, 3.696265757703487*^9}, {3.696266300106792*^9, 
   3.6962663022176447`*^9}, {3.696280105405973*^9, 3.696280132482732*^9}, {
   3.696281672602948*^9, 3.696281674126233*^9}, {3.696557850874742*^9, 
   3.696557871199915*^9}, {3.696557903268799*^9, 3.696557913746582*^9}, 
   3.696567340391617*^9, 3.696567825286929*^9, {3.69841352264535*^9, 
   3.698413530955118*^9}, {3.700310362698221*^9, 3.700310367626308*^9}, {
   3.7003109981133966`*^9, 3.700310999764279*^9}, {3.700315664001711*^9, 
   3.70031566482213*^9}, {3.700330287233273*^9, 3.700330290093197*^9}, {
   3.700330902687174*^9, 3.700330903269773*^9}, {3.700332089723002*^9, 
   3.700332089917096*^9}, {3.7003351695475492`*^9, 3.7003351698853607`*^9}, {
   3.700790503009207*^9, 3.700790505268724*^9}, {3.700801891008852*^9, 
   3.700801891256075*^9}, {3.716278873871594*^9, 3.716278916944399*^9}, {
   3.7162789798419647`*^9, 3.7162789940446463`*^9}, {3.716695341160205*^9, 
   3.7166953463346577`*^9}, {3.722763016772457*^9, 3.722763017334733*^9}},
 CellLabel->
  "In[1252]:=",ExpressionUUID->"de64227a-0bdf-476f-9ec7-b09a9bb3466d"],

Cell[BoxData[
 RowBox[{"Finite", " ", "mass", " ", "corrections", " ", "using", " ", "the", 
  " ", 
  SubscriptBox["\[Lambda]", "0"], " ", "which", " ", "is", " ", "computed", 
  " ", "with", " ", "the", " ", "Born", " ", "infinite", " ", "mass", " ", 
  "expression", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
    "we", " ", "do", " ", "not", " ", "advise", " ", "to", " ", "use", " ", 
     "it"}], ")"}], "."}]}]], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.696567829680573*^9, 3.696567863251584*^9}, {
  3.698399521768798*^9, 
  3.698399547443973*^9}},ExpressionUUID->"4620b4f0-f41a-4238-b109-\
d19fd4ef8c9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]nTOpFMNoCCR", "[", "Tv_", "]"}], ":=", 
   RowBox[{"IntegrateRatedp", "[", 
    RowBox[{"IPENdpFMNoCCR", ",", "1", ",", "Tv"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]pTOnFMNoCCR", "[", "Tv_", "]"}], ":=", 
   RowBox[{"IntegrateRatedp", "[", 
    RowBox[{"IPENdpFMNoCCR", ",", 
     RowBox[{"-", "1"}], ",", "Tv"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.696256323113212*^9, 3.696256332353565*^9}, {
   3.6962568883754263`*^9, 3.696256896269373*^9}, {3.6962655747821903`*^9, 
   3.6962655841034613`*^9}, {3.69626563951473*^9, 3.6962656428867683`*^9}, {
   3.696265745093422*^9, 3.696265757703487*^9}, {3.696266300106792*^9, 
   3.6962663022176447`*^9}, {3.696280105405973*^9, 3.696280132482732*^9}, {
   3.696281672602948*^9, 3.696281674126233*^9}, {3.696557850874742*^9, 
   3.696557871199915*^9}, {3.696557903268799*^9, 3.696557913746582*^9}, 
   3.696567340391617*^9, 3.696567825286929*^9, {3.69841352264535*^9, 
   3.698413530955118*^9}, {3.700310362698221*^9, 3.700310367626308*^9}, {
   3.7003109981133966`*^9, 3.700310999764279*^9}, {3.700315664001711*^9, 
   3.70031566482213*^9}, {3.700330287233273*^9, 3.700330290093197*^9}, {
   3.700330902687174*^9, 3.700330903269773*^9}, {3.700332089723002*^9, 
   3.700332089917096*^9}, {3.7003351695475492`*^9, 3.7003351698853607`*^9}, {
   3.700790503009207*^9, 3.700790505268724*^9}, {3.700801891008852*^9, 
   3.700801891256075*^9}, {3.716278873871594*^9, 3.716278916944399*^9}, {
   3.7162789798419647`*^9, 3.716278996771866*^9}, {3.71669534797469*^9, 
   3.716695353421742*^9}, {3.722763017766406*^9, 3.722763018255619*^9}},
 CellLabel->
  "In[1254]:=",ExpressionUUID->"f4451e6b-512f-4bd5-bf60-ebdb677ae141"],

Cell[BoxData[
 RowBox[{"Finite", " ", "mass", " ", "corrections", " ", "cheating", " ", 
  "with", " ", "the", " ", "neutrino", " ", "temperature", " ", "and", " ", 
  "setting", " ", "it", " ", "equal", " ", "to", " ", "photons", " ", 
  "temperature"}]], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.696567829680573*^9, 3.696567886999069*^9}, {
  3.698399514851718*^9, 3.6983995156261177`*^9}},
 FontFamily->"Arial",ExpressionUUID->"7ac05251-7bf5-414e-b711-d86eb916b762"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]nTOpCheatNeutrinoFM", "[", "Tv_", "]"}], ":=", 
   RowBox[{"IntegrateRatedp", "[", 
    RowBox[{"IPENdpFMCheatNeutrinoTemperature", ",", "1", ",", "Tv"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]pTOnCheatNeutrinoFM", "[", "Tv_", "]"}], ":=", 
   RowBox[{"IntegrateRatedp", "[", 
    RowBox[{"IPENdpFMCheatNeutrinoTemperature", ",", 
     RowBox[{"-", "1"}], ",", "Tv"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQnT8/eQVP12vHjIDulSC6jpnnPYjeMo/jA5hmv6kj
CKT7/Jn1QPTqig8mIDojIcYURAf8VXIC0d+btjmD6OtZze0g+tO3Y2B6918d
Vwkg3VXU7wGio7yFOSWBtBSXC5h+/Df68XyQPanPnoJohlkvXoLpJ+avQbRC
R0/rEiDdu+1NJ4iWelV2HET/OnINTEfIu//V7HvteGee6z8QnfXjqs6Jia8d
QyukdUH0S7PaZxeBtFb4ZjDd91HB+BKQXpihAaZvzYk/DqKfqWaD6SNnmjyu
AOk4o8lg+tnZGTo7Jr12LF6zBExbnDZYwbER6A5/tpUg2mHfrkPTtwDNfyBx
GETX2kYnzt7z2nGVbQKYBgDeQbmu
  "],
 CellLabel->
  "In[1256]:=",ExpressionUUID->"452c3adf-f12e-4f28-ba5d-79826ad3d4f9"],

Cell["\<\
Examples of neutron decay corrections for some low temperatures:\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.696678333604801*^9, 3.6966783390512943`*^9}, {
  3.698399562000465*^9, 
  3.6983995737215757`*^9}},ExpressionUUID->"d04e64ca-ed76-4a1a-b413-\
00e0f92cd5eb"],

Cell[CellGroupData[{

Cell["Checking detailed balance", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.696567923324329*^9, 
  3.6965679285243692`*^9}},ExpressionUUID->"a88ca11e-4e40-4fa3-ad61-\
fc276dc6bbd5"],

Cell["Born approximation detailed balance ", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698399743038397*^9, 
  3.698399750173317*^9}},ExpressionUUID->"84a84357-ca12-4db7-8029-\
23b9ed4450f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DetailedBalanceRatio0", "[", "T_", "]"}], ":=", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["Q", 
       RowBox[{"(", 
        RowBox[{"kB", " ", "T"}], ")"}]]}], "-", "\[Xi]\[Nu]"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.696317568944995*^9, 3.696317623350902*^9}, {
   3.696317689006975*^9, 3.696317698962822*^9}, {3.696320248910652*^9, 
   3.696320250505892*^9}, {3.6963205287774*^9, 3.696320531330695*^9}, 
   3.69632066286731*^9, {3.69632485351542*^9, 3.696324853659338*^9}, {
   3.6963248983338003`*^9, 3.6963248985808697`*^9}, {3.696327746544529*^9, 
   3.6963277599504013`*^9}, {3.696327862915011*^9, 3.69632786891885*^9}, {
   3.696334619164743*^9, 3.6963346193515368`*^9}, {3.69633465922243*^9, 
   3.696334667669228*^9}, {3.696558545277938*^9, 3.696558545620257*^9}, {
   3.696558648462893*^9, 3.696558666480484*^9}, {3.696558863623109*^9, 
   3.6965588701612167`*^9}, {3.6965623122303867`*^9, 3.696562340850313*^9}, {
   3.696566960112402*^9, 3.696566970576413*^9}, {3.6965683767539873`*^9, 
   3.69656841848105*^9}, {3.6965686077091*^9, 3.696568617988285*^9}, {
   3.696582946257455*^9, 3.696582991025054*^9}, {3.696584965207852*^9, 
   3.69658496704139*^9}, 3.6983997376320457`*^9, {3.6984376065669727`*^9, 
   3.698437611569199*^9}, 3.699773004134186*^9, {3.719891495258315*^9, 
   3.719891497556979*^9}, 3.722694634979802*^9},
 CellLabel->
  "In[1258]:=",ExpressionUUID->"2d32ffd0-c007-4d9d-8621-78999f8471ff"],

Cell["\<\
At Born order, detailed balance is of course satisfied by construction. \
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6965688412897167`*^9, 3.696568859916535*^9}, {
   3.698400020545375*^9, 3.6984000221846333`*^9}, 3.698493631680745*^9, {
   3.719895140351009*^9, 
   3.719895141772334*^9}},ExpressionUUID->"5fe1a335-1ef0-4f62-a23e-\
7b88f36d63c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DetailedBalance0", "[", "T_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Lambda]nTOpBORN", "[", "T", "]"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"\[Lambda]pTOnBORN", "[", "T", "]"}], ")"}]}], "*", 
    RowBox[{"DetailedBalanceRatio0", "[", "T", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DetailedBalanceCheatNeutrino0", "[", "T_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Lambda]nTOpBORNCheatNeutrino", "[", "T", "]"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"\[Lambda]pTOnBORNCheatNeutrino", "[", "T", "]"}], ")"}]}], "*", 
    RowBox[{"DetailedBalanceRatio0", "[", "T", "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.696318822613143*^9, 3.6963189300193977`*^9}, {
  3.696319035383534*^9, 3.696319064442466*^9}, {3.696319113797925*^9, 
  3.696319121401868*^9}, {3.696319200030716*^9, 3.696319213112774*^9}, {
  3.696319994621787*^9, 3.6963200156491137`*^9}, {3.69632028627369*^9, 
  3.696320295439102*^9}, {3.696320387656167*^9, 3.696320390309903*^9}, {
  3.6963204748588*^9, 3.696320492473227*^9}, {3.6963206414658127`*^9, 
  3.696320651302537*^9}, {3.6963276648432426`*^9, 3.6963277098539457`*^9}, {
  3.696327772879138*^9, 3.696327776128262*^9}, {3.6965588772408457`*^9, 
  3.696558890381955*^9}, {3.696568780442127*^9, 3.696568830908843*^9}, {
  3.696590493141501*^9, 3.696590493624138*^9}, {3.698413605895928*^9, 
  3.6984136093795977`*^9}, {3.7198916969956627`*^9, 3.719891709431085*^9}},
 CellLabel->
  "In[1259]:=",ExpressionUUID->"4cab1aea-71cc-407a-814f-25b1b4b5f430"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", " ", "we", " ", "enforce", " ", 
   SubscriptBox["T", "\[Nu]"]}], "=", 
  RowBox[{"T", " ", "the", " ", "precision", " ", "is", " ", 
   RowBox[{"insane", ".", " ", "It"}], " ", "is", " ", "numerical", " ", 
   "precision", " ", "because", " ", "detailed", " ", "balance", " ", "is", 
   " ", "rooted", " ", "in", " ", "our", " ", 
   RowBox[{"method", "."}]}]}]], "Text",
 CellChangeTimes->{{3.719893370304784*^9, 
  3.719893398092801*^9}},ExpressionUUID->"46816bd7-9381-441a-8372-\
6eab46c8cb61"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DetailedBalanceRatio", "[", "T_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["Q", 
        RowBox[{"(", 
         RowBox[{"kB", " ", "T"}], ")"}]]}], "-", "\[Xi]\[Nu]"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Alpha]"}], ")"}], 
        FractionBox["Q", "mp"]}]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.696317568944995*^9, 3.696317623350902*^9}, {
   3.696317689006975*^9, 3.696317698962822*^9}, {3.696320248910652*^9, 
   3.696320250505892*^9}, {3.6963205287774*^9, 3.696320531330695*^9}, 
   3.69632066286731*^9, {3.69632485351542*^9, 3.696324853659338*^9}, {
   3.6963248983338003`*^9, 3.6963248985808697`*^9}, {3.696327746544529*^9, 
   3.6963277599504013`*^9}, {3.696327862915011*^9, 3.69632786891885*^9}, {
   3.696334619164743*^9, 3.6963346193515368`*^9}, {3.69633465922243*^9, 
   3.696334667669228*^9}, {3.696558545277938*^9, 3.696558545620257*^9}, {
   3.696558648462893*^9, 3.696558666480484*^9}, {3.696558863623109*^9, 
   3.6965588701612167`*^9}, {3.6965623122303867`*^9, 3.696562340850313*^9}, {
   3.696566960112402*^9, 3.696566970576413*^9}, {3.6965683767539873`*^9, 
   3.69656841848105*^9}, {3.6965686077091*^9, 3.696568617988285*^9}, {
   3.696582946257455*^9, 3.696582991025054*^9}, {3.696584965207852*^9, 
   3.69658496704139*^9}, 3.6983997376320457`*^9, {3.698437619286331*^9, 
   3.6984376400303497`*^9}, 3.699773004750842*^9, 3.717581565816092*^9, {
   3.7198915023111753`*^9, 3.719891503870845*^9}, 3.722694634991549*^9},
 CellLabel->
  "In[1261]:=",ExpressionUUID->"897208c4-337b-4d72-b9df-70cdba421e47"],

Cell["\<\
[Lopez&Turner 1997] define some quantity to parameterize how good detailed \
balance is obtained, this is the parameter \[Alpha]. 
\[Alpha] should be 0 so we use it to estimate the failure of detailed balance\
\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698399777081094*^9, 3.69839987232202*^9}, {
  3.722695012065412*^9, 
  3.722695019713744*^9}},ExpressionUUID->"970b9acd-b6e8-468c-9d6b-\
ab5d15277cc0"],

Cell["\<\
We first solve for \[Alpha] correctly, and then we do it when forcing the \
temperature of neutrinos to be the one of photons, in which case detailed \
balance must be true. Indeed if we do not force the temperature of neutrinos \
to be the one of photons, then it is only true before electrons/positrons \
annihilate, and at low temperature detailed balance is not satisfied.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698399877434156*^9, 
  3.698399948428933*^9}},ExpressionUUID->"87915065-dfe5-4d80-b112-\
9fbdef9cc0da"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Radiative Corrections (T=0)", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.696568876549485*^9, 3.696568883221107*^9}, {
  3.700388002897666*^9, 
  3.7003880077597837`*^9}},ExpressionUUID->"9c0d5916-5706-4a64-8805-\
c4452336559b"],

Cell[TextData[{
 "The CCR corrected rates are described in details in the companion paper. \n\
\nWhen electron and protons are on the same side we use the Fermi function to \
apply the Coulomb corrections.\n\nFor all processes the radiative correction \
are a factor (1+",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["\[Alpha]", 
     RowBox[{"2", "\[Pi]"}]], "C"}], TraditionalForm]],ExpressionUUID->
  "e9a0a4d4-d10d-49ff-ae0b-436c5bca60ba"],
 "), (similarly to Eq. 18 of [Lopez&Turner 1998] or Eq. 2.13 of [Dicus .et. \
al]) as described in companion paper."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698400100167746*^9, 3.698400114910536*^9}, {
  3.698400283707464*^9, 3.698400449480309*^9}, {3.698400582169602*^9, 
  3.6984006075499783`*^9}, {3.698400677257052*^9, 3.698400683443102*^9}, {
  3.698400726501363*^9, 3.698400845749423*^9}, {3.6984009233752623`*^9, 
  3.698400948540351*^9}, {3.7159346190386753`*^9, 3.715934619323278*^9}, {
  3.72269516899516*^9, 
  3.722695242094263*^9}},ExpressionUUID->"6fb94578-c2e4-4da0-b468-\
19573c655fad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IPENdpCCR", "[", 
    RowBox[{"pe_", ",", "x_", ",", "znu_", ",", "sgnq_"}], "]"}], ":=", 
   RowBox[{"IPENdpFrom\[Chi]CCR", "[", 
    RowBox[{
     RowBox[{"enOFpe", "[", 
      RowBox[{"pe", ",", "x"}], "]"}], ",", "pe", ",", "x", ",", 
     RowBox[{"If", "[", 
      RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", "sgnq", ",", 
     "\[Chi]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.716278526037504*^9, 3.716278538909265*^9}, 
   3.717409314553797*^9, 3.772875785099123*^9},
 CellLabel->
  "In[1262]:=",ExpressionUUID->"f5e19d5f-dcce-4bd9-a7c0-e585740457b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]nTOpCCR", "[", "Tv_", "]"}], ":=", 
   RowBox[{"IntegrateRatedp", "[", 
    RowBox[{"IPENdpCCR", ",", "1", ",", "Tv"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]pTOnCCR", "[", "Tv_", "]"}], ":=", 
   RowBox[{"IntegrateRatedp", "[", 
    RowBox[{"IPENdpCCR", ",", 
     RowBox[{"-", "1"}], ",", "Tv"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.695399410917375*^9, 3.695399430490005*^9}, 
   3.6953994836958942`*^9, {3.695399514744933*^9, 3.695399525106229*^9}, 
   3.695399695534388*^9, {3.6953997693746367`*^9, 3.695399773379814*^9}, {
   3.695399815986622*^9, 3.695399823611052*^9}, {3.695399890177977*^9, 
   3.695399891302362*^9}, {3.695400687974887*^9, 3.6954006984287367`*^9}, {
   3.695401313546454*^9, 3.695401314874227*^9}, {3.695408712450911*^9, 
   3.695408718833468*^9}, {3.698063269573107*^9, 3.6980632702477837`*^9}, {
   3.698064323896926*^9, 3.698064337970724*^9}, {3.698413616111005*^9, 
   3.6984136205846663`*^9}, {3.70031039103623*^9, 3.700310393082368*^9}, {
   3.7003163992330027`*^9, 3.700316410672761*^9}, {3.700330310846792*^9, 
   3.700330312217121*^9}, {3.700330909721245*^9, 3.70033091078543*^9}, {
   3.700332095844589*^9, 3.7003320961853533`*^9}, {3.70033517748048*^9, 
   3.700335178005267*^9}, {3.7008105632854652`*^9, 3.700810566713304*^9}, {
   3.716279357356186*^9, 3.716279361461356*^9}, {3.716310439404963*^9, 
   3.716310469813743*^9}, {3.716348337324896*^9, 3.716348341574752*^9}, {
   3.716695513044895*^9, 3.71669551643744*^9}, {3.722763019752287*^9, 
   3.722763020025922*^9}},
 CellLabel->
  "In[1263]:=",ExpressionUUID->"a814a364-1111-4021-9ca6-48cbfe1fc5d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finite-temperature Radiative Corrections ", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.695064093134568*^9, 3.695064134414332*^9}, {
   3.695067413948248*^9, 3.6950674240932083`*^9}, 3.696569096301001*^9, {
   3.722844347682692*^9, 
   3.7228443494176693`*^9}},ExpressionUUID->"796a2c72-649c-460e-bde4-\
03237cb89614"],

Cell[CellGroupData[{

Cell["Method", "Subsection",
 CellChangeTimes->{{3.72269692333986*^9, 
  3.722696926372854*^9}},ExpressionUUID->"5a792a66-3049-4c3d-acc8-\
ce1b3210bb94"],

Cell["\<\
We use exclusively [Brown&Sawyer] for the finite temperature radiative \
corrections, 
but the equation are gathered and summarized in companion paper essentially \
in section III.F and related appendix. The various terms are in Eq. 108.
Note also that on top of that, we also need to add what we called \
Brehmstrahlung corrections (Eqs. 107 in companion paper)\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"f9694a7f-1685-4766-b9f7-a12a1646c55d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Real photons processes integrand", "Subsection",
 CellChangeTimes->{{3.722696641227968*^9, 3.722696647145071*^9}, {
  3.722696906812999*^9, 
  3.7226969105595922`*^9}},ExpressionUUID->"ff312926-d311-4761-a937-\
5b9132e1bf63"],

Cell["\<\
Bose Einstein distribution function (and if sq = -1 it is stimulated emission)\
\>", "Text",
 CellChangeTimes->{{3.722695498431326*^9, 
  3.722695520941956*^9}},ExpressionUUID->"385736b0-a9a0-4950-88c3-\
1bbfccaeb084"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BEQ", "[", 
    RowBox[{"en_", ",", "sq_"}], "]"}], ":=", 
   RowBox[{"sq", " ", 
    RowBox[{"BE", "[", 
     RowBox[{"sq", " ", "en"}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.716634045100129*^9, 3.716634066022997*^9}, 
   3.716634172196467*^9},
 CellLabel->
  "In[1265]:=",ExpressionUUID->"33545788-7b10-4e5d-ae31-a2ea99a4e338"],

Cell[BoxData[
 RowBox[{
  OverscriptBox["\[Chi]", "~"], " ", "is", " ", "defined", " ", "in", " ", 
  "companion", " ", "paper", " ", "in", " ", 
  RowBox[{"Eq", ".", " ", "B45", "."}]}]], "Text",
 FontFamily->"Arial",ExpressionUUID->"250d2e6f-7b9d-46d7-acff-15657f2c3409"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Chi]tilde", "[", 
   RowBox[{"en_", ",", "znu_", ",", "sgnq_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"q", "=", 
      RowBox[{"Q", "/", "me"}]}], " ", "}"}], ",", 
    RowBox[{
     RowBox[{"FD\[Nu]", "[", 
      RowBox[{
       RowBox[{"en", "-", 
        RowBox[{"sgnq", " ", "q"}]}], ",", 
       RowBox[{"sgnq", " ", "\[Xi]\[Nu]"}], ",", "znu"}], "]"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"en", "-", 
        RowBox[{"sgnq", " ", "q"}]}], ")"}], "^", "2"}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{
  3.6997728342995863`*^9, {3.717386600163209*^9, 3.7173866158520803`*^9}, {
   3.719812047567501*^9, 3.7198120543292513`*^9}, 3.722694635015861*^9},
 CellLabel->
  "In[1266]:=",ExpressionUUID->"53dcc720-6b66-4465-9633-2aa1b2c4a7f3"],

Cell["\<\
We first compute real photons processes (absorption or stimulated emission)
We put Fermi function everywhere to be consistent.
The integrand is (Eq. 109 of companion paper)\
\>", "Text",ExpressionUUID->"303c681e-d506-4d30-80ec-b591c0998c91"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IPENCCRT", "[", 
     RowBox[{"en_", ",", "k_", ",", "x_", ",", "znu_", ",", "sgnq_"}], "]"}], 
    ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          SuperscriptBox["en", "2"], "-", "1"}], "]"}]}], "}"}], ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"b", "=", 
           RowBox[{"p", "/", "en"}]}], ",", 
          RowBox[{"A", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["en", "2"]}], "+", 
               SuperscriptBox["k", "2"]}], ")"}], 
             RowBox[{"Log", "[", 
              FractionBox[
               RowBox[{"en", "+", "p"}], 
               RowBox[{"en", "-", "p"}]], "]"}]}], "-", 
            RowBox[{"4", " ", "p", " ", "en"}]}]}], ",", 
          RowBox[{"B", "=", 
           RowBox[{
            RowBox[{"2", " ", "en", " ", 
             RowBox[{"Log", "[", 
              FractionBox[
               RowBox[{"en", "+", "p"}], 
               RowBox[{"en", "-", "p"}]], "]"}]}], "-", 
            RowBox[{"4", "p"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["\[Alpha]FS", 
          RowBox[{"2", "\[Pi]"}]], "*", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"BE", "[", 
            RowBox[{"x", " ", "k"}], "]"}], "k"], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"A", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"FD", "[", 
                RowBox[{
                 RowBox[{"-", "en"}], ",", "x"}], "]"}], 
               RowBox[{"Fermi", "[", 
                RowBox[{"sgnq", ",", "1", ",", "b"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Chi]tilde", "[", 
                  RowBox[{
                   RowBox[{"en", "-", "k"}], ",", "znu", ",", "sgnq"}], "]"}],
                  "+", 
                 RowBox[{"\[Chi]tilde", "[", 
                  RowBox[{
                   RowBox[{"en", "+", "k"}], ",", "znu", ",", "sgnq"}], "]"}],
                  "-", 
                 RowBox[{"2", 
                  RowBox[{"\[Chi]tilde", "[", 
                   RowBox[{"en", ",", "znu", ",", "sgnq"}], "]"}]}]}], 
                ")"}]}], "+", 
              RowBox[{
               RowBox[{"FD", "[", 
                RowBox[{"en", ",", "x"}], "]"}], 
               RowBox[{"Fermi", "[", 
                RowBox[{"sgnq", ",", 
                 RowBox[{"-", "1"}], ",", "b"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Chi]tilde", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "en"}], "+", "k"}], ",", "znu", ",", 
                   "sgnq"}], "]"}], "+", 
                 RowBox[{"\[Chi]tilde", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "en"}], "-", "k"}], ",", "znu", ",", 
                   "sgnq"}], "]"}], "-", 
                 RowBox[{"2", 
                  RowBox[{"\[Chi]tilde", "[", 
                   RowBox[{
                    RowBox[{"-", "en"}], ",", "znu", ",", "sgnq"}], "]"}]}]}],
                 ")"}]}]}], ")"}]}], "\[IndentingNewLine]", "-", 
           RowBox[{"k", " ", "B", " ", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"FD", "[", 
                RowBox[{
                 RowBox[{"-", "en"}], ",", "x"}], "]"}], 
               RowBox[{"Fermi", "[", 
                RowBox[{"sgnq", ",", "1", ",", "b"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Chi]tilde", "[", 
                  RowBox[{
                   RowBox[{"en", "-", "k"}], ",", "znu", ",", "sgnq"}], "]"}],
                  "-", 
                 RowBox[{"\[Chi]tilde", "[", 
                  RowBox[{
                   RowBox[{"en", "+", "k"}], ",", "znu", ",", "sgnq"}], 
                  "]"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"FD", "[", 
                RowBox[{"en", ",", "x"}], "]"}], 
               RowBox[{"Fermi", "[", 
                RowBox[{"sgnq", ",", 
                 RowBox[{"-", "1"}], ",", "b"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Chi]tilde", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "en"}], "+", "k"}], ",", "znu", ",", 
                   "sgnq"}], "]"}], "-", 
                 RowBox[{"\[Chi]tilde", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "en"}], "-", "k"}], ",", "znu", ",", 
                   "sgnq"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
          "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Compiled", " ", "version", " ", "to", " ", "compute", " ", "the", " ", 
    "integrals", " ", "slightly", " ", "faster"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IPENCCRTC", "=", 
   RowBox[{"MyCompile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"en", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"znu", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"sgnq", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"IPENCCRT", "[", 
       RowBox[{"en", ",", "k", ",", "x", ",", "znu", ",", "sgnq"}], "]"}], 
      "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"IPENCCRTCN", "[", 
    RowBox[{
     RowBox[{"en_", "?", "NumericQ"}], ",", "k_", ",", "x_", ",", "znu_", ",",
      "sgnq_"}], "]"}], ":=", 
   RowBox[{"IPENCCRTC", "[", 
    RowBox[{"en", ",", "k", ",", "x", ",", "znu", ",", "sgnq"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.695410718826062*^9, 3.69541113550143*^9}, {
   3.6954112963057528`*^9, 3.695411309529381*^9}, {3.695417412816882*^9, 
   3.695417413344215*^9}, {3.698437698486841*^9, 3.698437705471509*^9}, 
   3.7000190268083553`*^9, {3.700325645246752*^9, 3.700325715970257*^9}, {
   3.7003259144253883`*^9, 3.700325967557787*^9}, {3.70032602075037*^9, 
   3.700326052512817*^9}, {3.700326116798278*^9, 3.700326119905135*^9}, {
   3.700374533168674*^9, 3.700374536760147*^9}, {3.7003838737173243`*^9, 
   3.700383900055015*^9}, {3.717406420080267*^9, 3.717406442742491*^9}, {
   3.717407276565346*^9, 3.717407291832512*^9}, {3.7174082493627167`*^9, 
   3.717408261214456*^9}, {3.722695627299255*^9, 3.722695635306621*^9}, {
   3.722695683286381*^9, 3.722695702541976*^9}, {3.72269575891849*^9, 
   3.722695797456564*^9}, 3.772875794640394*^9},
 CellLabel->
  "In[1267]:=",ExpressionUUID->"53cfe635-7831-4d85-93c6-04f21df61ce0"],

Cell["\<\
Bremsstrahlung corrections (needed to obtain all real photons processes and \
eventually detailed balance).
The integrand is (Eqs. B48 and B49 using definitions B41)\
\>", "Text",ExpressionUUID->"6b83d46a-25a3-4c95-9e96-dfe065cb665d"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "IPENCCRDiffBremsstrahlungCN", ",", "IPENCCRDiffBremsstrahlungC", ",", 
   "IPENCCRDiffBremsstrahlung"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IPENCCRDiffBremsstrahlung", "[", 
     RowBox[{"en_", ",", "k_", ",", "x_", ",", "znu_", ",", "sgnq_"}], "]"}], 
    ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           SuperscriptBox["en", "2"], "-", "1"}], "]"}]}], ",", 
        RowBox[{"q", "=", 
         RowBox[{"Q", "/", "me"}]}]}], "}"}], ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"b", "=", 
           RowBox[{"p", "/", "en"}]}], ",", 
          RowBox[{"A", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["en", "2"]}], "+", 
               SuperscriptBox["k", "2"]}], ")"}], 
             RowBox[{"Log", "[", 
              FractionBox[
               RowBox[{"en", "+", "p"}], 
               RowBox[{"en", "-", "p"}]], "]"}]}], "-", 
            RowBox[{"4", " ", "p", " ", "en"}]}]}], ",", 
          RowBox[{"B", "=", 
           RowBox[{
            RowBox[{"2", " ", "en", " ", 
             RowBox[{"Log", "[", 
              FractionBox[
               RowBox[{"en", "+", "p"}], 
               RowBox[{"en", "-", "p"}]], "]"}]}], "-", 
            RowBox[{"4", "p"}]}]}]}], "}"}], ",", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Fp", "=", 
             RowBox[{"A", "+", 
              RowBox[{"k", " ", "B"}]}]}], ",", 
            RowBox[{"Fm", "=", 
             RowBox[{"A", "-", 
              RowBox[{"k", " ", "B"}]}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           FractionBox["\[Alpha]FS", 
            RowBox[{"2", "\[Pi]", " ", "k"}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"FD", "[", 
                RowBox[{
                 RowBox[{"-", "en"}], ",", "x"}], "]"}], 
               RowBox[{"Fermi", "[", 
                RowBox[{"sgnq", ",", "1", ",", "b"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Fp", " ", 
                  RowBox[{"\[Chi]tilde", "[", 
                   RowBox[{
                    RowBox[{"en", "+", "k"}], ",", "znu", ",", "sgnq"}], 
                   "]"}]}], "-", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "<", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"en", "-", 
                    RowBox[{"sgnq", " ", "q"}]}], "]"}]}], ",", 
                   RowBox[{"Fp", " ", 
                    RowBox[{"FD", "[", 
                    RowBox[{
                    RowBox[{"en", "-", 
                    RowBox[{"sgnq", " ", "q"}]}], ",", "znu"}], "]"}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"en", "-", 
                    RowBox[{"sgnq", " ", "q"}]}], "]"}], "-", "k"}], ")"}], 
                    "2"]}], ",", "0"}], "]"}]}], ")"}]}], ")"}], 
             "\[IndentingNewLine]", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"FD", "[", 
                RowBox[{"en", ",", "x"}], "]"}], 
               RowBox[{"Fermi", "[", 
                RowBox[{"sgnq", ",", 
                 RowBox[{"-", "1"}], ",", "b"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Fm", " ", 
                  RowBox[{"\[Chi]tilde", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "en"}], "+", "k"}], ",", "znu", ",", 
                    "sgnq"}], "]"}]}], "-", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "<", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"en", "+", 
                    RowBox[{"sgnq", " ", "q"}]}], "]"}]}], ",", 
                   RowBox[{"Fp", " ", 
                    RowBox[{"FD", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "en"}], "-", 
                    RowBox[{"sgnq", " ", "q"}]}], ",", "znu"}], "]"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"en", "+", 
                    RowBox[{"sgnq", " ", "q"}]}], "]"}], "-", "k"}], ")"}], 
                    "^", "2"}]}], ",", "0"}], "]"}]}], ")"}]}], ")"}]}], 
            "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{"(*", " ", 
   RowBox[{"We", " ", "compile", " ", "for", " ", "the", " ", "integration"}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IPENCCRDiffBremsstrahlungC", "=", 
   RowBox[{"MyCompile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"en", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"znu", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"sgnq", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"IPENCCRDiffBremsstrahlung", "[", 
       RowBox[{"en", ",", "k", ",", "x", ",", "znu", ",", "sgnq"}], "]"}], 
      "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"IPENCCRDiffBremsstrahlungCN", "[", 
    RowBox[{
     RowBox[{"en_", "?", "NumericQ"}], ",", "k_", ",", "x_", ",", "znu_", ",",
      "sgnq_"}], "]"}], ":=", 
   RowBox[{"IPENCCRDiffBremsstrahlungC", "[", 
    RowBox[{"en", ",", "k", ",", "x", ",", "znu", ",", "sgnq"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717330198346142*^9, 3.71733023879042*^9}, {
   3.717330315633149*^9, 3.7173303171533117`*^9}, {3.7173303480601053`*^9, 
   3.71733038620162*^9}, {3.7173304391552973`*^9, 3.717330579271893*^9}, {
   3.717330618870625*^9, 3.717330640471383*^9}, {3.717330786542292*^9, 
   3.7173307977239437`*^9}, 3.717330839030588*^9, {3.717331102888794*^9, 
   3.7173311121197023`*^9}, {3.7173316964012814`*^9, 3.717331812450779*^9}, {
   3.717331881572681*^9, 3.717331893447111*^9}, 3.7173330944740753`*^9, {
   3.717381644265684*^9, 3.71738165082836*^9}, {3.717381684396489*^9, 
   3.717381787043931*^9}, {3.71738182237145*^9, 3.717381853446203*^9}, {
   3.7173818908416977`*^9, 3.717381948837935*^9}, {3.71738581002102*^9, 
   3.717385840132536*^9}, {3.717385896092848*^9, 3.71738589899503*^9}, {
   3.7173863431079082`*^9, 3.7173863637040462`*^9}, {3.7173869925289*^9, 
   3.717387045781878*^9}, {3.71738708030486*^9, 3.717387100807612*^9}, {
   3.717390096350445*^9, 3.717390126992717*^9}, {3.717395023620401*^9, 
   3.717395028387678*^9}, 3.71740363883357*^9, 3.717403674180415*^9, {
   3.7174041001201077`*^9, 3.7174041020011787`*^9}, {3.7174043402300787`*^9, 
   3.717404379424965*^9}, {3.717405619391571*^9, 3.717405622673237*^9}, {
   3.7174058587107058`*^9, 3.717405861343122*^9}, {3.717406175986188*^9, 
   3.717406179269273*^9}, {3.717406282895767*^9, 3.7174062886215353`*^9}, {
   3.717406362625874*^9, 3.717406371796834*^9}, {3.7174070639152327`*^9, 
   3.717407086866067*^9}, {3.71740729454949*^9, 3.717407300314062*^9}, {
   3.717407437649233*^9, 3.717407470215459*^9}, {3.717407730641138*^9, 
   3.717407777970305*^9}, {3.717408238423264*^9, 3.7174082469050922`*^9}, {
   3.717842558352989*^9, 3.7178425626552553`*^9}, {3.7226956504665833`*^9, 
   3.7226956533994226`*^9}, {3.7226957744881687`*^9, 3.722695870974989*^9}, 
   3.7728758026080027`*^9},
 CellLabel->
  "In[1269]:=",ExpressionUUID->"d0be71b7-a7ca-4539-bd89-55689b3ead81"],

Cell["\<\
The expression IPENFiveBodyT0 implements the integrand of 5.21 of \
[Brown&Sawyer] (and not 5.20. Careful).
We showed in companion paper that this is only a part of the bremsstrahlung \
corrections needed.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698401207352257*^9, 3.698401266487153*^9}, {
  3.716586407521216*^9, 3.7165864201715*^9}, {3.72269589276657*^9, 
  3.7226959225559597`*^9}},ExpressionUUID->"5bbe805a-42ff-4ef8-b2f0-\
0228ac3cd4f1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IPENFiveBodyT0", "[", 
     RowBox[{"en_", ",", "k_", ",", "x_", ",", "znu_", ",", "sgnq_"}], "]"}], 
    ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          SuperscriptBox["en", "2"], "-", "1"}], "]"}]}], "}"}], ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"A", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["en", "2"]}], "+", 
               SuperscriptBox["k", "2"]}], ")"}], 
             RowBox[{"Log", "[", 
              FractionBox[
               RowBox[{"en", "+", "p"}], 
               RowBox[{"en", "-", "p"}]], "]"}]}], "-", 
            RowBox[{"4", " ", "p", " ", "en"}]}]}], ",", 
          RowBox[{"B", "=", 
           RowBox[{
            RowBox[{"2", " ", "en", " ", 
             RowBox[{"Log", "[", 
              FractionBox[
               RowBox[{"en", "+", "p"}], 
               RowBox[{"en", "-", "p"}]], "]"}]}], "-", 
            RowBox[{"4", "p"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["\[Alpha]FS", 
          RowBox[{"2", "\[Pi]", " ", "k"}]], 
         RowBox[{"(", 
          RowBox[{"FD", "[", 
           RowBox[{"en", ",", "x"}], "]"}], ")"}], 
         RowBox[{"\[Chi]tilde", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "en"}], "+", "k"}], ",", "znu", ",", "sgnq"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"A", "-", 
           RowBox[{"k", " ", "B"}]}], ")"}]}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Compiled", " ", "version"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IPENFiveBodyT0C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"en", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"znu", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"sgnq", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            SuperscriptBox["en", "2"], "-", "1"}], "]"}]}], "}"}], ",", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"A", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  SuperscriptBox["en", "2"]}], "+", 
                 SuperscriptBox["k", "2"]}], ")"}], 
               RowBox[{"Log", "[", 
                FractionBox[
                 RowBox[{"en", "+", "p"}], 
                 RowBox[{"en", "-", "p"}]], "]"}]}], "-", 
              RowBox[{"4", " ", "p", " ", "en"}]}]}], ",", 
            RowBox[{"B", "=", 
             RowBox[{
              RowBox[{"2", " ", "en", " ", 
               RowBox[{"Log", "[", 
                FractionBox[
                 RowBox[{"en", "+", "p"}], 
                 RowBox[{"en", "-", "p"}]], "]"}]}], "-", 
              RowBox[{"4", "p"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           FractionBox["\[Alpha]FS", 
            RowBox[{"2", "\[Pi]", " ", "k"}]], 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"BE", "[", 
              RowBox[{
               RowBox[{"-", "k"}], " ", "x"}], "]"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"FD", "[", 
             RowBox[{"en", ",", "x"}], "]"}], ")"}], 
           RowBox[{"\[Chi]tilde", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "en"}], "+", "k"}], ",", "znu", ",", "sgnq"}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"A", "-", 
             RowBox[{"k", " ", "B"}]}], ")"}]}]}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"\"\<RuntimeOptions\>\"", "\[Rule]", "\"\<Speed\>\""}], ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IPENFiveBodyT0CN", "[", 
    RowBox[{
     RowBox[{"en_", "?", "NumericQ"}], ",", "k_", ",", "x_", ",", "znu_", ",",
      "sgnq_"}], "]"}], ":=", 
   RowBox[{"IPENFiveBodyT0C", "[", 
    RowBox[{"en", ",", "k", ",", "x", ",", "znu", ",", "sgnq"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.69544668691394*^9, 3.695446766044786*^9}, {
   3.698437719784473*^9, 3.698437723035181*^9}, 3.700019026825101*^9, {
   3.700316459565806*^9, 3.700316460815658*^9}, {3.700326269579648*^9, 
   3.700326316828682*^9}, {3.700374541240868*^9, 3.700374541637694*^9}, {
   3.7165864025660152`*^9, 3.7165864251455507`*^9}, {3.72269592725914*^9, 
   3.722696019599032*^9}, {3.772875806170518*^9, 3.772875811438671*^9}},
 CellLabel->
  "In[1272]:=",ExpressionUUID->"86062f24-7f5b-491a-80fa-4dfbe4a42146"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mass shift and pe+ee integrand", "Subsection",
 CellChangeTimes->{{3.722696641227968*^9, 3.722696666433362*^9}, {
  3.7226969338131437`*^9, 
  3.7226969377065372`*^9}},ExpressionUUID->"fc5a519c-044c-41c2-8b8e-\
c18f9fc94d2d"],

Cell["We finally consider the mass shift and ep + ee corrections", "Text",
 CellChangeTimes->{{3.722696049025177*^9, 
  3.722696060947871*^9}},ExpressionUUID->"362acbee-0764-4946-9e83-\
456a072503fc"],

Cell["\<\
We split the contributions of the last two terms of 5.14 in [Brown and \
Sawyer] in two parts. 
Indeed these are given by 5.15 [Brown and Sawyer]. The first part has only \
one integral, while the second part has two integrals.
The integrand of first part with only one integral is C1dE, and the integrand \
of the second part with two integrals is C2dE1dE2 (see 5.16 [Brown and \
Sawyer]).\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"da793b32-a693-4901-9d1a-f5bb48a61af3"],

Cell["\<\
This is the simple integration in Eq. B50a of companion paper (more precisely \
the integrand and the integration itself is performed further below)\
\>", "Text",ExpressionUUID->"5d8bc187-f0d7-4847-bd01-67426cc62a97"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"C1dE", "[", 
    RowBox[{"en_", ",", "x_", ",", "znu_", ",", "sgnq_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pe", "=", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["en", "2"], "-", "1"}]]}], ",", 
       RowBox[{"q", "=", 
        RowBox[{"Q", "/", "me"}]}]}], " ", "}"}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[Alpha]FS", " ", "en"}], 
        RowBox[{"2", "\[Pi]", " ", "pe"}]]}], "*", 
      FractionBox[
       RowBox[{"2", 
        SuperscriptBox["\[Pi]", "2"]}], 
       RowBox[{"3", 
        SuperscriptBox["x", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Chi]", "[", 
         RowBox[{"en", ",", "pe", ",", "x", ",", "znu", ",", "sgnq"}], "]"}], 
        "+", 
        RowBox[{"\[Chi]", "[", 
         RowBox[{
          RowBox[{"-", "en"}], ",", "pe", ",", "x", ",", "znu", ",", "sgnq"}],
          "]"}]}], ")"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.695398458129932*^9, 3.695398458544178*^9}, {
   3.695398569314012*^9, 3.6953985698181467`*^9}, {3.695398603354608*^9, 
   3.695398604153324*^9}, {3.695398779374422*^9, 3.6953988952701473`*^9}, {
   3.6953989303928556`*^9, 3.695398934757702*^9}, {3.695398994343876*^9, 
   3.695399005306608*^9}, {3.695399742307755*^9, 3.695399747889206*^9}, {
   3.695412573768763*^9, 3.6954125792787867`*^9}, {3.6954126451356688`*^9, 
   3.6954127762617292`*^9}, 3.695412976709449*^9, {3.698437730591278*^9, 
   3.698437731413047*^9}, 3.699772835031294*^9, 3.700019026837167*^9, 
   3.700226456211849*^9, {3.716290437935371*^9, 3.7162904402351837`*^9}, {
   3.722696093326565*^9, 3.72269609792238*^9}},
 CellLabel->
  "In[1275]:=",ExpressionUUID->"42dae31b-01fd-4549-b526-2887f01b6f90"],

Cell["NB : L is given by 5.18 [Brown and Sawyer]", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698401457638472*^9, 3.698401480568026*^9}, 
   3.722696107041193*^9},ExpressionUUID->"8323285d-7277-4952-9e2b-\
162eeff7b4e3"],

Cell["\<\
And this is the double integration integrand of Eq.B50a of companion paper\
\>", "Text",ExpressionUUID->"93ae5bb0-dbe7-473d-bef2-db1655a7c0cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"C2dE1dE2", "[", 
     RowBox[{"e1_", ",", "e2_", ",", "x_", ",", "znu_", ",", "sgnq_"}], "]"}],
     ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "=", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["e1", "2"], "-", "1"}]]}], ",", 
        RowBox[{"p2", "=", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["e2", "2"], "-", "1"}]]}], ",", 
        RowBox[{"q", "=", 
         RowBox[{"Q", "/", "me"}]}]}], " ", "}"}], ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"L", "=", 
          RowBox[{"Log", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"e1", " ", "e2"}], " ", "+", 
             RowBox[{"p1", " ", "p2"}], " ", "+", "1"}], 
            RowBox[{
             RowBox[{"e1", " ", "e2"}], " ", "-", 
             RowBox[{"p1", " ", "p2"}], " ", "+", "1"}]], "]"}]}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["\[Alpha]FS", 
          RowBox[{"2", "\[Pi]", " "}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Chi]", "[", 
            RowBox[{"e1", ",", "p1", ",", "x", ",", "znu", ",", "sgnq"}], 
            "]"}], "+", 
           RowBox[{"\[Chi]", "[", 
            RowBox[{
             RowBox[{"-", "e1"}], ",", "p1", ",", "x", ",", "znu", ",", 
             "sgnq"}], "]"}]}], ")"}], "\[IndentingNewLine]", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "4"]}], 
            SuperscriptBox[
             RowBox[{"Log", "[", 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox[
                 RowBox[{"p1", "+", "p2"}], 
                 RowBox[{"p1", "-", "p2"}]], ")"}], "2"], "]"}], "2"], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"FDp", "[", 
                RowBox[{"e2", ",", "x"}], "]"}], 
               FractionBox["p2", "p1"], 
               FractionBox[
                SuperscriptBox["e1", "2"], "e2"], 
               RowBox[{"(", 
                RowBox[{"e1", "+", "e2"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"FD", "[", 
                RowBox[{"e2", ",", "x"}], "]"}], 
               FractionBox[
                SuperscriptBox["e1", "2"], 
                RowBox[{"p1", " ", "p2"}]], 
               RowBox[{"(", 
                RowBox[{"e2", "+", 
                 FractionBox["e1", 
                  SuperscriptBox["e2", "2"]]}], ")"}]}]}], ")"}]}], 
           "\[IndentingNewLine]", "+", 
           RowBox[{
            RowBox[{"Log", "[", 
             SuperscriptBox[
              RowBox[{"(", 
               FractionBox[
                RowBox[{"p1", "+", "p2"}], 
                RowBox[{"p1", "-", "p2"}]], ")"}], "2"], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"FDp", "[", 
                RowBox[{"e2", ",", "x"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["p2", "2"], 
                  FractionBox["e1", "e2"], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    SuperscriptBox["p1", "2"]], "+", "2"}], ")"}]}], "-", 
                 RowBox[{
                  SuperscriptBox["e1", "2"], 
                  FractionBox["p2", "p1"], " ", "L"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"FD", "[", 
                RowBox[{"e2", ",", "x"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox["e1", 
                   RowBox[{
                    SuperscriptBox["p1", "2"], 
                    SuperscriptBox["e2", "2"]}]], 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["e2", "2"], "+", 
                    RowBox[{"2", 
                    SuperscriptBox["p1", "2"]}], "+", "1"}], ")"}]}], "-", 
                 FractionBox[
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["e1", "2"], "+", 
                    SuperscriptBox["e2", "2"]}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{"e1", "+", "e2"}], ")"}]], "-", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["e1", "2"], "e2"}], 
                   RowBox[{"p1", " ", "p2"}]], " ", "L"}]}], ")"}]}]}], 
             ")"}]}], "\[IndentingNewLine]", "-", 
           RowBox[{
            RowBox[{"FD", "[", 
             RowBox[{"e2", ",", "x"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", "e1", " ", 
               FractionBox["p2", "p1"]}], "+", 
              RowBox[{"2", " ", "e2", " ", "L"}]}], ")"}]}]}], ")"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Compiled", " ", "version"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C2dE1dE2C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"e1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"e2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"znu", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"sgnq", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"p1", "=", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["e1", "2"], "-", "1"}]]}], ",", 
          RowBox[{"p2", "=", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["e2", "2"], "-", "1"}]]}], ",", 
          RowBox[{"q", "=", 
           RowBox[{"Q", "/", "me"}]}]}], " ", "}"}], ",", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"L", "=", 
            RowBox[{"Log", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"e1", " ", "e2"}], " ", "+", 
               RowBox[{"p1", " ", "p2"}], " ", "+", "1"}], 
              RowBox[{
               RowBox[{"e1", " ", "e2"}], " ", "-", 
               RowBox[{"p1", " ", "p2"}], " ", "+", "1"}]], "]"}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           FractionBox["\[Alpha]FS", 
            RowBox[{"2", "\[Pi]", " "}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"e1", ",", "p1", ",", "x", ",", "znu", ",", "sgnq"}], 
              "]"}], "+", 
             RowBox[{"\[Chi]", "[", 
              RowBox[{
               RowBox[{"-", "e1"}], ",", "p1", ",", "x", ",", "znu", ",", 
               "sgnq"}], "]"}]}], ")"}], "\[IndentingNewLine]", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               FractionBox["1", "4"]}], 
              SuperscriptBox[
               RowBox[{"Log", "[", 
                SuperscriptBox[
                 RowBox[{"(", 
                  FractionBox[
                   RowBox[{"p1", "+", "p2"}], 
                   RowBox[{"p1", "-", "p2"}]], ")"}], "2"], "]"}], "2"], "*", 
              
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"FDp", "[", 
                  RowBox[{"e2", ",", "x"}], "]"}], 
                 FractionBox["p2", "p1"], 
                 FractionBox[
                  SuperscriptBox["e1", "2"], "e2"], 
                 RowBox[{"(", 
                  RowBox[{"e1", "+", "e2"}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"FD", "[", 
                  RowBox[{"e2", ",", "x"}], "]"}], 
                 FractionBox[
                  SuperscriptBox["e1", "2"], 
                  RowBox[{"p1", " ", "p2"}]], 
                 RowBox[{"(", 
                  RowBox[{"e2", "+", 
                   FractionBox["e1", 
                    SuperscriptBox["e2", "2"]]}], ")"}]}]}], ")"}]}], 
             "\[IndentingNewLine]", "+", 
             RowBox[{
              RowBox[{"Log", "[", 
               SuperscriptBox[
                RowBox[{"(", 
                 FractionBox[
                  RowBox[{"p1", "+", "p2"}], 
                  RowBox[{"p1", "-", "p2"}]], ")"}], "2"], "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"FDp", "[", 
                  RowBox[{"e2", ",", "x"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["p2", "2"], 
                    FractionBox["e1", "e2"], 
                    RowBox[{"(", 
                    RowBox[{
                    FractionBox["1", 
                    SuperscriptBox["p1", "2"]], "+", "2"}], ")"}]}], "-", 
                   RowBox[{
                    SuperscriptBox["e1", "2"], 
                    FractionBox["p2", "p1"], " ", "L"}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"FD", "[", 
                  RowBox[{"e2", ",", "x"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    FractionBox["e1", 
                    RowBox[{
                    SuperscriptBox["p1", "2"], 
                    SuperscriptBox["e2", "2"]}]], 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["e2", "2"], "+", 
                    RowBox[{"2", 
                    SuperscriptBox["p1", "2"]}], "+", "1"}], ")"}]}], "-", 
                   FractionBox[
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["e1", "2"], "+", 
                    SuperscriptBox["e2", "2"]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"e1", "+", "e2"}], ")"}]], "-", 
                   RowBox[{
                    FractionBox[
                    RowBox[{
                    SuperscriptBox["e1", "2"], "e2"}], 
                    RowBox[{"p1", " ", "p2"}]], " ", "L"}]}], ")"}]}]}], 
               ")"}]}], "\[IndentingNewLine]", "-", 
             RowBox[{
              RowBox[{"FD", "[", 
               RowBox[{"e2", ",", "x"}], "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "e1", " ", 
                 FractionBox["p2", "p1"]}], "+", 
                RowBox[{"2", " ", "e2", " ", "L"}]}], ")"}]}]}], ")"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"\"\<RuntimeOptions\>\"", "\[Rule]", "\"\<Speed\>\""}], ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C2dE1dE2CN", "[", 
    RowBox[{
     RowBox[{"e1_", "?", "NumericQ"}], ",", 
     RowBox[{"e2_", "?", "NumericQ"}], ",", "x_", ",", "znu_", ",", "sgnq_"}],
     "]"}], ":=", 
   RowBox[{"C2dE1dE2C", "[", 
    RowBox[{"e1", ",", "e2", ",", "x", ",", "znu", ",", "sgnq"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.695418433204262*^9, 3.695418433574882*^9}, {
   3.6954185992962227`*^9, 3.695418599595653*^9}, {3.695418816220228*^9, 
   3.695418819473345*^9}, {3.695418947651333*^9, 3.695418949844535*^9}, {
   3.695419247525373*^9, 3.695419247675294*^9}, {3.69541931182075*^9, 
   3.695419312366115*^9}, {3.695419352053487*^9, 3.695419356499435*^9}, {
   3.695419736049988*^9, 3.695419749728456*^9}, {3.695420014453149*^9, 
   3.695420016564787*^9}, 3.6965691975092297`*^9, {3.6984377379301367`*^9, 
   3.698437793935587*^9}, 3.699772835889678*^9, 3.700019026863061*^9, {
   3.70032636359359*^9, 3.7003264618758287`*^9}, 3.7003277672543983`*^9, {
   3.70037454387849*^9, 3.700374544673587*^9}, {3.716290446095908*^9, 
   3.716290472311123*^9}, {3.722696115005368*^9, 3.7226963870636377`*^9}},
 CellLabel->
  "In[1276]:=",ExpressionUUID->"28fc4704-184b-4bc7-8dc0-c7e6fee89cce"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Integrations on momenta", "Subsection",
 CellChangeTimes->{{3.722696641227968*^9, 3.722696695615993*^9}, {
  3.7226968087823887`*^9, 
  3.722696812380465*^9}},ExpressionUUID->"f3677493-ad71-46ce-ae8e-\
88b9c1ece9a7"],

Cell["\<\
We perform all integrations now that we have expressed their integrands.

TruePhoton -> real photon processes 
Diffbremsstrahlung -> bremsstrahlung corrections 
Thermal -> mass shift and pe+ee corrections\
\>", "Text",
 InitializationCell->
  True,ExpressionUUID->"9f75ebfd-0398-45d6-9d72-b18fa4f9b1bb"],

Cell["Let us start with n -> p processes", "Text",
 CellChangeTimes->{{3.722696714647677*^9, 
  3.7226967243517*^9}},ExpressionUUID->"79e6f394-be83-438c-a840-ebc2facee63f"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "\[Lambda]nTOpThermal", ",", "\[Lambda]nTOpThermalTruePhoton", ",", 
   "\[Lambda]pTOnThermalTruePhoton", ",", "\[Lambda]nTOp5bodies", ",", 
   "\[Lambda]pTOnThermal", ",", "\[Lambda]nTOpThermalDiffBremsstrahlung", ",",
    "\[Lambda]pTOnThermalDiffBremsstrahlung"}], "]"}]], "Input",
 CellChangeTimes->{{3.716584244417206*^9, 3.716584254908677*^9}, {
  3.7166294953160963`*^9, 3.716629509457139*^9}, {3.716635336841669*^9, 
  3.716635353867173*^9}, {3.716701166535884*^9, 3.7167011679973373`*^9}, {
  3.71732926401121*^9, 3.717329278285408*^9}, {3.717332013762484*^9, 
  3.71733201823974*^9}, {3.717842567566923*^9, 3.717842568348681*^9}},
 CellLabel->
  "In[1279]:=",ExpressionUUID->"a9479f35-6b54-4e43-a3d7-ab058599c19e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]nTOpThermalTruePhoton", "[", "Tv_", "]"}], ":=", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"\[Lambda]nTOpThermalTruePhoton", "[", "Tv", "]"}], "="}], 
     "*)"}], 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "=", 
         FractionBox["me", 
          RowBox[{"(", 
           RowBox[{"kB", " ", "Tv"}], ")"}]]}], ",", 
        RowBox[{"znu", "=", 
         FractionBox["me", 
          RowBox[{"(", 
           RowBox[{"kB", " ", "Tv", " ", 
            RowBox[{"T\[Nu]overT", "[", "Tv", "]"}]}], ")"}]]}], ",", 
        RowBox[{"q", "=", 
         RowBox[{"Q", "/", "me"}]}]}], " ", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"IPENCCRTCN", "[", 
         RowBox[{"en", ",", "k", ",", "x", ",", 
          RowBox[{"If", "[", 
           RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", "1"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0.001", ",", 
          RowBox[{"Max", "[", 
           RowBox[{"10", ",", 
            RowBox[{"20", "/", "x"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"en", ",", "1.001", ",", 
          RowBox[{"Max", "[", 
           RowBox[{"10", ",", 
            RowBox[{"20", "/", "x"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "4"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]nTOpThermalDiffBremsstrahlung", "[", "Tv_", "]"}], ":=", 
   
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Lambda]nTOpThermalDiffBremsstrahlung", "[", "Tv", "]"}], 
     "="}], "*)"}], 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "=", 
        FractionBox["me", 
         RowBox[{"(", 
          RowBox[{"kB", " ", "Tv"}], ")"}]]}], ",", 
       RowBox[{"znu", "=", 
        FractionBox["me", 
         RowBox[{"(", 
          RowBox[{"kB", " ", "Tv", " ", 
           RowBox[{"T\[Nu]overT", "[", "Tv", "]"}]}], ")"}]]}], ",", 
       RowBox[{"q", "=", 
        RowBox[{"Q", "/", "me"}]}]}], " ", "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"IPENCCRDiffBremsstrahlungCN", "[", 
        RowBox[{"en", ",", "k", ",", "x", ",", 
         RowBox[{"If", "[", 
          RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", "1"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"en", ",", "1.001", ",", 
         RowBox[{"Max", "[", 
          RowBox[{"10", ",", 
           RowBox[{"20", "/", "x"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0.001", ",", 
         RowBox[{"Abs", "[", 
          RowBox[{"en", "-", "q"}], "]"}], ",", 
         RowBox[{"Abs", "[", 
          RowBox[{"en", "+", "q"}], "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{"10", ",", 
           RowBox[{"20", "/", "x"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"PrecisionGoal", "\[Rule]", "4"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwd0X0sFHAcBvCbWpLEMJtwSS+zhIlyjMsd2UJIXq+zOGdh14zJUOetXNLK
2+GYYSwJZXfklmRGzGtFXBIWqa5d09aEUPo9vz+++/zx/PPs+R4WJAbFajEY
DDY52BkSmq0r13DsK/RzYIrgVD2cMcxohMlVF5/CGh6/De56E/kSdm2M98K4
LdU4TK9jvIW9P+OnoNTVaQGOfilxsiMKfc95wuGi3JNshYaT9F5sC60HJO4w
iLGHDTeO7PaELGYH9ZEkNxuODd6hRjkwb5wl8sKjxTA8NK0I9mjqqQm/ZVLI
bVsrh0d3GI+hsKL2GRwU8WZgsnfKHLVAuQS3DMvU0NIiYa8HkfGXqwNbP21s
RBADrPz+wUqmqJZPLJAk1sHqtMl3MGN+m1poLT4Tidwu0wXevKLwhA9HVrzg
EEt6Hor6g31gt6rBH8omLYOhx2pBAhTy5CKo0lJch/4GXdRt4Y8BuDk3Mggb
ZrXHoJlqP3VCHiYToP9oayU84FL7HHbFf3sBPVtu9UN1evMryA1fH4J8m6Zh
+LX9/jhkbgW9htKo6rUYoqQ44g8sL9Z2FBIvrQ9RHzRPu8K68V9sqGo63gKP
leY8gVMx/AEoKpun5vl7WMUSy7wXrWGjXk8glFx2C4HBzGge5AxuUv16c2Ph
imnOVdgX55oM55IqqT76WflQYGR2FzoLmBOsdg1HYcyl1pTvq8ru0HCMd/Gp
rBn29AzxYGY9NbXBxugDcVVPRl2InmiZJZp7HGqFToX8ZeilTKUqbP3UMCAv
kLq5rBF8JIpK16nMayYsXSX5h4GY2lkYtujdRXaTOSzBHnsdxwvE29+HqSZ9
CYVBRDXXtAhGmSQKIoiaKfcYeM90eiGjW8PxHU3+DJuH1atQ5iZbg6cr84vF
xB0j2xLoJ3c2zyKWKU9YwP/LiBK+
  "],
 CellLabel->
  "In[1280]:=",ExpressionUUID->"5b09f7b8-2a70-492e-8702-889ef2225c21"],

Cell["\<\
The global 1/2 factor is Jacobian of the change of variables (we integrate in \
the sum and difference of energies).\
\>", "Text",
 CellChangeTimes->{{3.718729919175832*^9, 3.718729930621046*^9}, {
  3.718730124683784*^9, 3.718730137087079*^9}, {3.72269648832174*^9, 
  3.722696514725157*^9}},ExpressionUUID->"eec702f1-9a46-41fb-ad96-\
5c9c645d5c2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]nTOpThermal", "[", "Tv_", "]"}], ":=", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"\[Lambda]nTOpThermal", "[", "Tv", "]"}], "="}], "*)"}], 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "=", 
         FractionBox["me", 
          RowBox[{"(", 
           RowBox[{"kB", " ", "Tv"}], ")"}]]}], ",", 
        RowBox[{"znu", "=", 
         FractionBox["me", 
          RowBox[{"(", 
           RowBox[{"kB", " ", "Tv", " ", 
            RowBox[{"T\[Nu]overT", "[", "Tv", "]"}]}], ")"}]]}], ",", 
        RowBox[{"q", "=", 
         RowBox[{"Q", "/", "me"}]}]}], " ", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{"C1dE", "[", 
          RowBox[{"en", ",", "x", ",", 
           RowBox[{"If", "[", 
            RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", "1"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"en", ",", "1", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"25", ",", 
             RowBox[{"150", "/", "x"}]}], "]"}]}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", "+", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", "2"}], 
          RowBox[{"C2dE1dE2CN", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"e1pe2", "+", "e1me2"}], ")"}], "/", "2"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"e1pe2", "-", "e1me2"}], ")"}], "/", "2"}], ",", "x", 
            ",", 
            RowBox[{"If", "[", 
             RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", "1"}], 
           "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"e1me2", ",", 
           RowBox[{"-", 
            RowBox[{"Max", "[", 
             RowBox[{"10", ",", 
              RowBox[{"15", "/", "x"}]}], "]"}]}], ",", 
           RowBox[{"-", "0.001"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"e1pe2", ",", 
           RowBox[{"2.001", "+", 
            RowBox[{"Abs", "[", "e1me2", "]"}]}], ",", 
           RowBox[{"2", "+", 
            RowBox[{"Abs", "[", "e1me2", "]"}], "+", 
            RowBox[{"Max", "[", 
             RowBox[{"10", ",", 
              RowBox[{"15", "/", "x"}]}], "]"}]}]}], "}"}], ",", 
         RowBox[{"PrecisionGoal", "\[Rule]", "3"}], ",", 
         RowBox[{"Exclusions", "\[Rule]", 
          RowBox[{"{", "0", "}"}]}]}], "]"}], "\[IndentingNewLine]", "+", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", "2"}], 
          RowBox[{"C2dE1dE2CN", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"e1pe2", "+", "e1me2"}], ")"}], "/", "2"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"e1pe2", "-", "e1me2"}], ")"}], "/", "2"}], ",", "x", 
            ",", 
            RowBox[{"If", "[", 
             RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", "1"}], 
           "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"e1me2", ",", "0.001", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"10", ",", 
             RowBox[{"15", "/", "x"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"e1pe2", ",", 
           RowBox[{"2.001", "+", 
            RowBox[{"Abs", "[", "e1me2", "]"}]}], ",", 
           RowBox[{"2", "+", 
            RowBox[{"Abs", "[", "e1me2", "]"}], "+", 
            RowBox[{"Max", "[", 
             RowBox[{"10", ",", 
              RowBox[{"15", "/", "x"}]}], "]"}]}]}], "}"}], ",", 
         RowBox[{"PrecisionGoal", "\[Rule]", "3"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.7167011866979628`*^9, 3.716701192487205*^9}, {
   3.716701457574518*^9, 3.7167014918148003`*^9}, {3.716701554550103*^9, 
   3.7167015628860617`*^9}, {3.71670167493152*^9, 3.716701702436612*^9}, {
   3.7167018067181892`*^9, 3.716701824019589*^9}, {3.7167018593105164`*^9, 
   3.7167019376321507`*^9}, {3.716772260590551*^9, 3.716772378165453*^9}, {
   3.717329252080174*^9, 3.717329259932549*^9}, {3.717329388211567*^9, 
   3.717329392187539*^9}, {3.7173294321293907`*^9, 3.717329437628689*^9}, {
   3.717329924078937*^9, 3.717329924243017*^9}, {3.717331928943527*^9, 
   3.717331947042035*^9}, {3.71733209976054*^9, 3.717332101091277*^9}, {
   3.717332132779958*^9, 3.717332151708894*^9}, {3.717332296031145*^9, 
   3.7173323969872303`*^9}, {3.717332674825778*^9, 3.7173326818222647`*^9}, {
   3.717390512642786*^9, 3.717390515944734*^9}, {3.717409097661323*^9, 
   3.717409107276678*^9}, {3.7186945764392147`*^9, 3.718694578745431*^9}, {
   3.7186950714462557`*^9, 3.718695073629483*^9}, {3.718695215513376*^9, 
   3.7186952183250217`*^9}, {3.718695830667795*^9, 3.718695854318836*^9}, {
   3.718695890047414*^9, 3.7186958919261227`*^9}, {3.718698250147637*^9, 
   3.718698256573242*^9}, {3.7186988246541433`*^9, 3.718698830648159*^9}, {
   3.718699802066505*^9, 3.7186998034872637`*^9}, 3.71984633320979*^9, {
   3.721541380661818*^9, 3.721541382907858*^9}, 3.7215446792402153`*^9, {
   3.7215543222651052`*^9, 3.7215543241129017`*^9}, {3.721565314565539*^9, 
   3.721565316625348*^9}, {3.721579293769772*^9, 3.721579295742381*^9}, {
   3.7226965210097523`*^9, 3.7226965215127573`*^9}, 3.722696773105233*^9, {
   3.722696897095829*^9, 3.722696899378783*^9}, {3.722701971050438*^9, 
   3.7227019729969873`*^9}, {3.722705117036276*^9, 3.722705119131403*^9}, {
   3.722705956187887*^9, 3.722705958072191*^9}},
 CellLabel->
  "In[1282]:=",ExpressionUUID->"538fe268-799d-4732-9189-637c968b8efd"],

Cell["The 5 body is just for comparison with [Brown & Sawyer]", "Text",
 CellChangeTimes->{{3.722696592920362*^9, 
  3.722696608118235*^9}},ExpressionUUID->"9f717899-a1e4-4e00-af16-\
adfd7e45ff3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]nTOp5bodies", "[", "Tv_", "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Lambda]nTOp5bodies", "[", "Tv", "]"}], "="}], "*)"}], 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "=", 
        FractionBox["me", 
         RowBox[{"(", 
          RowBox[{"kB", " ", "Tv"}], ")"}]]}], ",", 
       RowBox[{"znu", "=", 
        FractionBox["me", 
         RowBox[{"(", 
          RowBox[{"kB", " ", "Tv", " ", 
           RowBox[{"T\[Nu]overT", "[", "Tv", "]"}]}], ")"}]]}], ",", 
       RowBox[{"q", "=", 
        RowBox[{"Q", "/", "me"}]}]}], " ", "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"IPENFiveBodyT0CN", "[", 
        RowBox[{"en", ",", "k", ",", "x", ",", 
         RowBox[{"If", "[", 
          RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", "1"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"en", ",", "1", ",", 
         RowBox[{"Max", "[", 
          RowBox[{"20", ",", 
           RowBox[{"20", "/", "x"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"en", "+", "q"}], ",", 
         RowBox[{"en", "+", "q", "+", 
          RowBox[{"Max", "[", 
           RowBox[{"20", ",", 
            RowBox[{"20", "/", "x"}]}], "]"}]}]}], "}"}], ",", 
       RowBox[{"PrecisionGoal", "\[Rule]", "4"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.716580223198764*^9, 3.716580241662072*^9}, {
   3.716581466191847*^9, 3.716581467739747*^9}, {3.716695580836507*^9, 
   3.71669558242237*^9}, {3.716772392894226*^9, 3.716772393903111*^9}, {
   3.71732947327734*^9, 3.717329477956744*^9}, 3.717409112656114*^9, {
   3.718694581236878*^9, 3.7186945813915854`*^9}, {3.7186950790927763`*^9, 
   3.71869507919333*^9}, {3.718698838406252*^9, 3.718698838586862*^9}, 
   3.719846316006147*^9, {3.721541374844678*^9, 3.721541376617936*^9}, {
   3.7215543174065332`*^9, 3.721554319752338*^9}, {3.7215653183316298`*^9, 
   3.7215653199650183`*^9}, {3.72157929852731*^9, 3.721579300533836*^9}, 
   3.722696776624539*^9, {3.7227019753474207`*^9, 3.7227019766306*^9}, {
   3.722705112906983*^9, 3.7227051149321203`*^9}},
 CellLabel->
  "In[1283]:=",ExpressionUUID->"d93cc058-9001-4984-bc50-d4f229ee9bf7"],

Cell["Let us finish with p -> n processes", "Text",
 CellChangeTimes->{{3.722696714647677*^9, 
  3.722696736340723*^9}},ExpressionUUID->"8fbc4548-f4f8-4da5-b830-\
ae70821f5c5a"],

Cell["\<\
When we have computed the corrections to n -> p rates, the converse are \
obtained from detailed balance arguments. That is we perform the replacement \
Q -> -Q as argued in [Brown&Sawyer]. This is also explained in details in the \
companion paper.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.698401662146998*^9, 3.698401755115117*^9}, {
  3.7226967409132633`*^9, 
  3.7226967619242363`*^9}},ExpressionUUID->"20a5b656-5261-45a4-9ced-\
281a0cb27465"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]pTOnThermalTruePhoton", "[", "Tv_", "]"}], ":=", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"\[Lambda]pTOnThermalTruePhoton", "[", "Tv", "]"}], "="}], 
     "*)"}], 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Tv", "<", 
       RowBox[{"10", "^", "8.2"}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "When", " ", "the", " ", "temperature", " ", "is", " ", "too", " ", 
        "low", " ", "it", " ", "is", " ", "better", " ", "to", " ", "put", 
        " ", "0"}], " ", "*)"}], ",", "0", ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "=", 
           FractionBox["me", 
            RowBox[{"(", 
             RowBox[{"kB", " ", "Tv"}], ")"}]]}], ",", 
          RowBox[{"znu", "=", 
           FractionBox["me", 
            RowBox[{"(", 
             RowBox[{"kB", " ", "Tv", " ", 
              RowBox[{"T\[Nu]overT", "[", "Tv", "]"}]}], ")"}]]}], ",", 
          RowBox[{"q", "=", 
           RowBox[{"Q", "/", "me"}]}]}], " ", "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{"IPENCCRTCN", "[", 
           RowBox[{"en", ",", "k", ",", "x", ",", 
            RowBox[{"If", "[", 
             RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0.001", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"10", ",", 
              RowBox[{"20", "/", "x"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"en", ",", "1.001", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"10", ",", 
              RowBox[{"20", "/", "x"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"PrecisionGoal", "\[Rule]", "4"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]pTOnThermalDiffBremsstrahlung", "[", "Tv_", "]"}], ":=", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"\[Lambda]pTOnThermalDiffBremsstrahlung", "[", "Tv", "]"}], 
      "="}], "*)"}], 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Tv", "<", 
       RowBox[{"10", "^", "8.2"}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "When", " ", "the", " ", "temperature", " ", "is", " ", "too", " ", 
        "low", " ", "it", " ", "is", " ", "better", " ", "to", " ", "put", 
        " ", "0"}], " ", "*)"}], ",", "0", ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "=", 
           FractionBox["me", 
            RowBox[{"(", 
             RowBox[{"kB", " ", "Tv"}], ")"}]]}], ",", 
          RowBox[{"znu", "=", 
           FractionBox["me", 
            RowBox[{"(", 
             RowBox[{"kB", " ", "Tv", " ", 
              RowBox[{"T\[Nu]overT", "[", "Tv", "]"}]}], ")"}]]}], ",", 
          RowBox[{"q", "=", 
           RowBox[{"Q", "/", "me"}]}]}], " ", "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{"IPENCCRDiffBremsstrahlungCN", "[", 
           RowBox[{"en", ",", "k", ",", "x", ",", 
            RowBox[{"If", "[", 
             RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"en", ",", "1.001", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"10", ",", 
              RowBox[{"20", "/", "x"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0.001", ",", 
            RowBox[{"Abs", "[", 
             RowBox[{"en", "-", "q"}], "]"}], ",", 
            RowBox[{"Abs", "[", 
             RowBox[{"en", "+", "q"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"10", ",", 
              RowBox[{"20", "/", "x"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"PrecisionGoal", "\[Rule]", "4"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]pTOnThermal", "[", "Tv_", "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Lambda]pTOnThermal", "[", "Tv", "]"}], "="}], "*)"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Tv", "<", 
      RowBox[{"10", "^", "8.2"}]}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "When", " ", "the", " ", "temperature", " ", "is", " ", "too", " ", 
       "low", " ", "it", " ", "is", " ", "better", " ", "to", " ", "put", " ",
        "0"}], " ", "*)"}], ",", "0", ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "=", 
          FractionBox["me", 
           RowBox[{"(", 
            RowBox[{"kB", " ", "Tv"}], ")"}]]}], ",", 
         RowBox[{"znu", "=", 
          FractionBox["me", 
           RowBox[{"(", 
            RowBox[{"kB", " ", "Tv", " ", 
             RowBox[{"T\[Nu]overT", "[", "Tv", "]"}]}], ")"}]]}], ",", 
         RowBox[{"q", "=", 
          RowBox[{"Q", "/", "me"}]}]}], " ", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{"C1dE", "[", 
           RowBox[{"en", ",", "x", ",", 
            RowBox[{"If", "[", 
             RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"en", ",", "1", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"25", ",", 
              RowBox[{"150", "/", "x"}]}], "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "2"}], 
           RowBox[{"C2dE1dE2CN", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"e1pe2", "+", "e1me2"}], ")"}], "/", "2"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"e1pe2", "-", "e1me2"}], ")"}], "/", "2"}], ",", "x", 
             ",", 
             RowBox[{"If", "[", 
              RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"e1me2", ",", 
            RowBox[{"-", 
             RowBox[{"Max", "[", 
              RowBox[{"10", ",", 
               RowBox[{"15", "/", "x"}]}], "]"}]}], ",", 
            RowBox[{"-", "0.001"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"e1pe2", ",", 
            RowBox[{"2.001", "+", 
             RowBox[{"Abs", "[", "e1me2", "]"}]}], ",", 
            RowBox[{"2", "+", 
             RowBox[{"Abs", "[", "e1me2", "]"}], "+", 
             RowBox[{"Max", "[", 
              RowBox[{"10", ",", 
               RowBox[{"15", "/", "x"}]}], "]"}]}]}], "}"}], ",", 
          RowBox[{"PrecisionGoal", "\[Rule]", "3"}]}], "]"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "2"}], 
           RowBox[{"C2dE1dE2CN", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"e1pe2", "+", "e1me2"}], ")"}], "/", "2"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"e1pe2", "-", "e1me2"}], ")"}], "/", "2"}], ",", "x", 
             ",", 
             RowBox[{"If", "[", 
              RowBox[{"$TnuEqualT", ",", "x", ",", "znu"}], "]"}], ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"e1me2", ",", "0.001", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"10", ",", 
              RowBox[{"15", "/", "x"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"e1pe2", ",", 
            RowBox[{"2.001", "+", 
             RowBox[{"Abs", "[", "e1me2", "]"}]}], ",", 
            RowBox[{"2", "+", 
             RowBox[{"Abs", "[", "e1me2", "]"}], "+", 
             RowBox[{"Max", "[", 
              RowBox[{"10", ",", 
               RowBox[{"15", "/", "x"}]}], "]"}]}]}], "}"}], ",", 
          RowBox[{"PrecisionGoal", "\[Rule]", "3"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.695408805617322*^9, 3.6954088264832497`*^9}, {
   3.69540908215277*^9, 3.695409084874832*^9}, {3.695411148582594*^9, 
   3.69541121485174*^9}, {3.6954112627276087`*^9, 3.695411282779182*^9}, {
   3.695411319191839*^9, 3.6954113204595346`*^9}, {3.695411683565934*^9, 
   3.695411930470559*^9}, {3.695412548614024*^9, 3.695412548801524*^9}, {
   3.695412813753017*^9, 3.6954128759881496`*^9}, {3.695413624356874*^9, 
   3.6954136927145557`*^9}, {3.6954138880312967`*^9, 3.695414083789287*^9}, {
   3.6954142188305693`*^9, 3.695414317780036*^9}, {3.695414428764748*^9, 
   3.69541444748098*^9}, {3.695414483349578*^9, 3.695414563608436*^9}, {
   3.6954148595595407`*^9, 3.695414872856926*^9}, {3.6954150562189302`*^9, 
   3.695415261251935*^9}, {3.695415333662332*^9, 3.695415371336487*^9}, {
   3.69541542023629*^9, 3.695415685890689*^9}, {3.6954157789539423`*^9, 
   3.695415780929082*^9}, {3.69541581543397*^9, 3.6954158165849047`*^9}, {
   3.695415949478023*^9, 3.695415963308518*^9}, {3.6954160082026043`*^9, 
   3.695416126158175*^9}, {3.695416192909975*^9, 3.69541625576624*^9}, {
   3.695416312367312*^9, 3.695416450000547*^9}, {3.695416558249814*^9, 
   3.6954165635307703`*^9}, {3.695416851534768*^9, 3.69541687956923*^9}, {
   3.695417069712232*^9, 3.695417087165868*^9}, {3.695417251802918*^9, 
   3.69541725594354*^9}, {3.695417436926791*^9, 3.695417441306699*^9}, {
   3.695417662867832*^9, 3.695417796070326*^9}, {3.6954179289249277`*^9, 
   3.69541796959328*^9}, 3.695418174019536*^9, {3.695418989653274*^9, 
   3.695418991618455*^9}, {3.6954194613404217`*^9, 3.695419467781343*^9}, {
   3.695419518802784*^9, 3.695419554278721*^9}, {3.695419587120013*^9, 
   3.695419677539056*^9}, {3.695419774813271*^9, 3.695419776240519*^9}, {
   3.695419905122869*^9, 3.695419942299942*^9}, {3.695419982431287*^9, 
   3.695420075621745*^9}, {3.695446482819448*^9, 3.695446489228162*^9}, {
   3.695446621699484*^9, 3.695446628745178*^9}, {3.695446810187834*^9, 
   3.6954469746341143`*^9}, {3.69544846867837*^9, 3.6954484704353037`*^9}, {
   3.69544851603972*^9, 3.695448516600215*^9}, {3.69547037254387*^9, 
   3.695470374483967*^9}, {3.695470512247386*^9, 3.695470514443918*^9}, {
   3.696569181336141*^9, 3.696569186070191*^9}, 3.696569217711074*^9, {
   3.698042573908451*^9, 3.698042619174037*^9}, {3.69804269582412*^9, 
   3.698042746594805*^9}, {3.698042788270297*^9, 3.698042837841577*^9}, {
   3.698042868945743*^9, 3.698043022991468*^9}, {3.698043069726562*^9, 
   3.6980433219208527`*^9}, {3.698043392325575*^9, 3.698043392827445*^9}, 
   3.698401660274262*^9, {3.698413649920356*^9, 3.698413657521294*^9}, {
   3.698415470374662*^9, 3.6984154786630507`*^9}, {3.699585955455759*^9, 
   3.6995859611972733`*^9}, {3.699586452372814*^9, 3.699586463923623*^9}, {
   3.699586528463567*^9, 3.699586529528634*^9}, {3.6997728402875566`*^9, 
   3.699772841697*^9}, {3.699773010239686*^9, 3.699773010763689*^9}, {
   3.700326572021994*^9, 3.70032657712643*^9}, {3.700327182881001*^9, 
   3.700327446944428*^9}, {3.700327550397286*^9, 3.700327561533646*^9}, {
   3.700327622044402*^9, 3.700327644378138*^9}, {3.7003321869916267`*^9, 
   3.700332190211978*^9}, {3.700334913933907*^9, 3.700334944319241*^9}, {
   3.700335137604817*^9, 3.700335142489628*^9}, {3.716581454842904*^9, 
   3.716581458012199*^9}, {3.716584262361559*^9, 3.716584264326535*^9}, {
   3.7165843042998123`*^9, 3.716584397659636*^9}, {3.7165869755440063`*^9, 
   3.716586977917222*^9}, {3.716588381166247*^9, 3.716588388916197*^9}, {
   3.7165884281826057`*^9, 3.716588453503285*^9}, {3.716627875887525*^9, 
   3.7166278958667173`*^9}, {3.716628050247574*^9, 3.7166280525881023`*^9}, {
   3.716629142791544*^9, 3.716629142915267*^9}, {3.7166291769030743`*^9, 
   3.7166292210157824`*^9}, {3.716629408725535*^9, 3.716629414865149*^9}, {
   3.7166294907498503`*^9, 3.7166295366265078`*^9}, {3.716629620741522*^9, 
   3.716629634568874*^9}, {3.71663502780064*^9, 3.7166350392587233`*^9}, {
   3.716635091960348*^9, 3.716635098315839*^9}, {3.716635147125874*^9, 
   3.716635158729024*^9}, {3.716635200438099*^9, 3.716635200899722*^9}, {
   3.716635238147945*^9, 3.716635238285269*^9}, {3.716635358940545*^9, 
   3.716635399413587*^9}, {3.716637641040896*^9, 3.7166376435882273`*^9}, {
   3.71663800912764*^9, 3.716638019829165*^9}, {3.716685708143037*^9, 
   3.716685708281231*^9}, {3.7166862772157288`*^9, 3.716686289668921*^9}, {
   3.716687944545211*^9, 3.7166879447006683`*^9}, {3.716688181495327*^9, 
   3.71668818327521*^9}, {3.716688802595345*^9, 3.716688804508524*^9}, {
   3.716691544976377*^9, 3.716691561513695*^9}, {3.716691785513126*^9, 
   3.716691788093131*^9}, {3.716695596948971*^9, 3.7166956030585546`*^9}, {
   3.716700837563464*^9, 3.716700848883312*^9}, {3.716701829652976*^9, 
   3.7167018357039423`*^9}, {3.716772397488587*^9, 3.716772408765436*^9}, {
   3.717329493345883*^9, 3.717329527555017*^9}, {3.717329895625128*^9, 
   3.717329904864751*^9}, {3.7173299350450993`*^9, 3.7173299353616123`*^9}, {
   3.717331966244721*^9, 3.717331990827976*^9}, {3.7173320890420637`*^9, 
   3.717332091168643*^9}, {3.7173323536269827`*^9, 3.7173323556811028`*^9}, {
   3.717332391578512*^9, 3.717332393791799*^9}, {3.71739064244424*^9, 
   3.717390643427246*^9}, {3.717391625934546*^9, 3.717391634292562*^9}, {
   3.717391984501903*^9, 3.717392026109132*^9}, {3.7173928165918217`*^9, 
   3.717392816835676*^9}, {3.7173928522537413`*^9, 3.717392856710593*^9}, {
   3.717392942571946*^9, 3.7173929449696817`*^9}, {3.717392984479127*^9, 
   3.7173929858548813`*^9}, {3.717393068234655*^9, 3.717393073873994*^9}, {
   3.717393232795927*^9, 3.717393261961383*^9}, {3.71739333167202*^9, 
   3.717393331824421*^9}, {3.717393963847945*^9, 3.717394012472268*^9}, {
   3.717403858385776*^9, 3.717403869747657*^9}, {3.7174041184449167`*^9, 
   3.7174041416191397`*^9}, {3.717404205034954*^9, 3.717404210545866*^9}, {
   3.717404249970275*^9, 3.717404287538118*^9}, {3.7174066222730083`*^9, 
   3.71740664146977*^9}, {3.717407139025114*^9, 3.71740714348552*^9}, {
   3.717407176790389*^9, 3.7174071875384398`*^9}, {3.7174072320291*^9, 
   3.7174072365125093`*^9}, {3.71740806838551*^9, 3.717408085271978*^9}, 
   3.717408121866753*^9, {3.717408310322826*^9, 3.717408312202176*^9}, {
   3.717409114641275*^9, 3.717409124717613*^9}, {3.717409422280059*^9, 
   3.717409424459403*^9}, {3.717409454878808*^9, 3.7174094612459927`*^9}, {
   3.7174095005815973`*^9, 3.717409504731345*^9}, {3.71740960240067*^9, 
   3.717409618547143*^9}, {3.717409691229671*^9, 3.717409693755012*^9}, {
   3.717409867767646*^9, 3.7174098729399357`*^9}, {3.7178425706700563`*^9, 
   3.7178425717494507`*^9}, {3.718513880905047*^9, 3.718513884297166*^9}, {
   3.7186945844673634`*^9, 3.718694593449009*^9}, {3.71869508151641*^9, 
   3.718695088510728*^9}, {3.718695230533495*^9, 3.7186952323083277`*^9}, {
   3.718695835666507*^9, 3.718695862704299*^9}, {3.718695895274446*^9, 
   3.718695898241364*^9}, {3.718698841586896*^9, 3.718698843787794*^9}, {
   3.719846319337076*^9, 3.71984632578863*^9}, {3.7215413570706673`*^9, 
   3.7215413710066547`*^9}, {3.721554302071693*^9, 3.721554314792347*^9}, {
   3.721565322992466*^9, 3.721565332693041*^9}, {3.721579302980389*^9, 
   3.721579315336062*^9}, {3.7226967816007013`*^9, 3.72269679618972*^9}, {
   3.722696864610602*^9, 3.7226968730794773`*^9}, {3.722701977711771*^9, 
   3.72270199594862*^9}, {3.722705099760632*^9, 3.7227051100516367`*^9}, {
   3.722705967175733*^9, 3.722705969052929*^9}},
 CellLabel->
  "In[1284]:=",ExpressionUUID->"ec6154eb-b241-4374-9346-a09ea3f4d533"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Collecting all finite-temperature corrections", "Subsection",
 CellChangeTimes->{{3.722696641227968*^9, 3.722696695615993*^9}, {
  3.7226968087823887`*^9, 3.722696842882162*^9}, {3.722696951498478*^9, 
  3.722696953647703*^9}, {3.722844345439295*^9, 
  3.722844345598024*^9}},ExpressionUUID->"d2dc865e-00f3-440c-8900-\
c687f79f0cfb"],

Cell["\<\
We collect the various contributions of Eq. 108. The TruePhoton contribution \
refers to the first term on the rhs of Eq. 108, and the Thermal contribution \
to the second and third. The Bremsstrahlung corrections are Eqs. 107.\
\>", "Text",ExpressionUUID->"26935800-4224-45f0-9a11-d069362e2db6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]nTOpCCRTh", "[", "Tv_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Lambda]nTOpThermal", "[", "Tv", "]"}], "+", 
      RowBox[{"\[Lambda]nTOpThermalTruePhoton", "[", "Tv", "]"}], "+", 
      RowBox[{"If", "[", 
       RowBox[{"$CorrectionBremsstrahlung", ",", 
        RowBox[{"\[Lambda]nTOpThermalDiffBremsstrahlung", "[", "Tv", "]"}], 
        ",", 
        RowBox[{"\[Lambda]nTOp5bodies", "[", "Tv", "]"}]}], "]"}]}], ")"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]pTOnCCRTh", "[", "Tv_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Lambda]pTOnThermal", "[", "Tv", "]"}], "+", 
     RowBox[{"\[Lambda]pTOnThermalTruePhoton", "[", "Tv", "]"}], "+", 
     RowBox[{"If", "[", 
      RowBox[{"$CorrectionBremsstrahlung", ",", 
       RowBox[{"\[Lambda]pTOnThermalDiffBremsstrahlung", "[", "Tv", "]"}], 
       ",", "0"}], "]"}]}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.718442914557778*^9, 3.7184429464162903`*^9}, {
  3.7184429795211487`*^9, 3.718442985647987*^9}, {3.722703833539338*^9, 
  3.722703869357932*^9}, {3.7227069471958113`*^9, 3.722706960126197*^9}, {
  3.7228410233033*^9, 3.7228410352325907`*^9}, {3.722843158806149*^9, 
  3.7228431675288477`*^9}},
 CellLabel->
  "In[1287]:=",ExpressionUUID->"3d22df03-bfce-4ada-917c-f2bf43e21347"],

Cell["\<\
We gather all corrections according to the Booleans chosen at the beginning\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.69656922941325*^9, 3.696569244900646*^9}, {
   3.69840176113693*^9, 3.698401766275239*^9}, {3.700327305653832*^9, 
   3.7003273069414043`*^9}, 3.700327370880028*^9, {3.716629639996961*^9, 
   3.716629640961618*^9}, {3.716635104882784*^9, 
   3.7166351064167767`*^9}},ExpressionUUID->"628e3b84-bad5-462f-b140-\
b944ddffc91a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]0", ":=", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
     "$RadiativeCorrections", ",", "\[Lambda]Rad", ",", "\[Lambda]BORN"}], 
     "]"}], "+", 
    RowBox[{"If", "[", 
     RowBox[{"$FiniteNucleonMass", ",", "\[Lambda]FM", ",", "0"}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.716695618059411*^9, 3.716695671869442*^9}, 
   3.71678243973044*^9, {3.718341911113452*^9, 3.7183419332988997`*^9}, 
   3.718534492246272*^9, {3.722258583794449*^9, 3.7222586005414457`*^9}, 
   3.7728758312360764`*^9},
 CellLabel->
  "In[1289]:=",ExpressionUUID->"d1629a70-0ffb-4e57-a9e9-14930147e9ce"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gathering all corrections", "Section",
 CellChangeTimes->{{3.719115627928853*^9, 
  3.719115635704762*^9}},ExpressionUUID->"1dda229b-1df7-44f8-98ed-\
3df5b878e9d6"],

Cell["We add them depending on options", "Text",ExpressionUUID->"34d31060-a104-4f69-ad77-fd211d63a546"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "\[Lambda]nTOp", ",", "\[Lambda]pTOn", ",", "\[Lambda]nTOpNormalized", ",",
     "\[Lambda]pTOnNormalized"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]nTOpNormalized", "[", "Tv_", "]"}], ":=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", "\[Lambda]0", ")"}], 
      RowBox[{"-", "1"}]], 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"$RadiativeCorrections", ",", 
         RowBox[{"\[Lambda]nTOpCCR", "[", "Tv", "]"}], ",", 
         RowBox[{"\[Lambda]nTOpBORN", "[", "Tv", "]"}]}], "]"}], 
       "\[IndentingNewLine]", "+", 
       RowBox[{"If", "[", 
        RowBox[{"$RadiativeThermal", ",", 
         RowBox[{"\[Lambda]nTOpCCRTh", "[", "Tv", "]"}], ",", "0"}], "]"}], 
       "\[IndentingNewLine]", "+", 
       RowBox[{"If", "[", 
        RowBox[{"$FiniteNucleonMass", ",", 
         RowBox[{"If", "[", 
          RowBox[{"$CoupledFMandRC", ",", 
           RowBox[{"\[Lambda]nTOpFMCCR", "[", "Tv", "]"}], ",", 
           RowBox[{"\[Lambda]nTOpFMNoCCR", "[", "Tv", "]"}]}], "]"}], ",", 
         "0"}], "]"}]}], "\[IndentingNewLine]", ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]pTOnNormalized", "[", "Tv_", "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", "\[Lambda]0", ")"}], 
     RowBox[{"-", "1"}]], 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"$RadiativeCorrections", ",", 
        RowBox[{"\[Lambda]pTOnCCR", "[", "Tv", "]"}], ",", 
        RowBox[{"\[Lambda]pTOnBORN", "[", "Tv", "]"}]}], "]"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{"If", "[", 
       RowBox[{"$RadiativeThermal", ",", 
        RowBox[{"\[Lambda]pTOnCCRTh", "[", "Tv", "]"}], ",", "0"}], "]"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{"If", "[", 
       RowBox[{"$FiniteNucleonMass", ",", 
        RowBox[{"If", "[", 
         RowBox[{"$CoupledFMandRC", ",", 
          RowBox[{"\[Lambda]pTOnFMCCR", "[", "Tv", "]"}], ",", 
          RowBox[{"\[Lambda]pTOnFMNoCCR", "[", "Tv", "]"}]}], "]"}], ",", 
        "0"}], "]"}]}], ")"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.695064373905018*^9, 3.69506445754451*^9}, {
   3.695064694659678*^9, 3.6950647663342047`*^9}, {3.695408773279675*^9, 
   3.6954088292821703`*^9}, {3.695412001753669*^9, 3.695412002914415*^9}, {
   3.696257174643622*^9, 3.6962572348636417`*^9}, {3.696320039231606*^9, 
   3.696320059119977*^9}, {3.696560330742922*^9, 3.696560368599556*^9}, {
   3.69841366107887*^9, 3.698413679704706*^9}, 3.7006501210863523`*^9, {
   3.700650166604313*^9, 3.7006501780866632`*^9}, {3.716278776565542*^9, 
   3.716278817003685*^9}, {3.716279386110992*^9, 3.716279423504142*^9}, {
   3.716348362147277*^9, 3.7163484016203337`*^9}, {3.716552216680551*^9, 
   3.716552232045948*^9}, {3.716552370655571*^9, 3.716552370836754*^9}, {
   3.716580257931612*^9, 3.7165802594387302`*^9}, {3.716627824217421*^9, 
   3.7166278269092817`*^9}, {3.716635286985628*^9, 3.716635295081327*^9}, {
   3.71663540753647*^9, 3.716635466388023*^9}, {3.716639298595077*^9, 
   3.716639310812118*^9}, {3.716695653916298*^9, 3.716695660253028*^9}, 
   3.716695800181916*^9, {3.716797179034683*^9, 3.716797243291263*^9}, {
   3.717390531801889*^9, 3.717390578026553*^9}, {3.71739069594687*^9, 
   3.7173907041673603`*^9}, {3.7173907390919857`*^9, 
   3.7173907416081467`*^9}, {3.717392604816434*^9, 3.717392624797221*^9}, {
   3.717394256168786*^9, 3.7173942710759487`*^9}, {3.717406493731933*^9, 
   3.7174065261452713`*^9}, {3.717407842572586*^9, 3.717407845041079*^9}, {
   3.717409196063448*^9, 3.7174091983386707`*^9}, {3.717409653709322*^9, 
   3.717409656051174*^9}, {3.71740974475494*^9, 3.717409747718233*^9}, {
   3.717416406409479*^9, 3.7174164486521463`*^9}, {3.7174169961974573`*^9, 
   3.717416997360804*^9}, {3.717417790948159*^9, 3.7174177960968113`*^9}, {
   3.717419198220565*^9, 3.717419200909136*^9}, {3.717842573149127*^9, 
   3.717842575084733*^9}, {3.71844299167854*^9, 3.7184430048897743`*^9}, {
   3.718443054074301*^9, 3.718443054077876*^9}, {3.71853449225346*^9, 
   3.7185344922577877`*^9}, {3.719115646863418*^9, 3.719115675445386*^9}, {
   3.719846359957387*^9, 3.7198463635728207`*^9}, {3.721542353191823*^9, 
   3.721542354248949*^9}, {3.7215425922226763`*^9, 3.721542604259848*^9}},
 CellLabel->
  "In[1290]:=",ExpressionUUID->"9d8adf05-77ee-430f-b806-8bbb80b00470"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "\[Lambda]nTOp", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]nTOp", "[", "Tv_", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "\[Tau]neutron"}], " ", 
    RowBox[{"\[Lambda]nTOpNormalized", "[", "Tv", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]pTOn", "[", "Tv_", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "\[Tau]neutron"}], " ", 
    RowBox[{"\[Lambda]pTOnNormalized", "[", "Tv", "]"}]}]}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.719115682561501*^9, 3.7191157047802067`*^9}, {
  3.719891110866403*^9, 3.7198911236454353`*^9}, {3.721542275397078*^9, 
  3.721542277581934*^9}},
 CellLabel->
  "In[1293]:=",ExpressionUUID->"9cb79178-05ea-4aba-9104-042c376fffb7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Precomputation and storage of rates", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.69656927451437*^9, 3.696569299466792*^9}, {
  3.6984157233273363`*^9, 3.698415727735632*^9}, {3.700388024839624*^9, 
  3.7003880263513937`*^9}, {3.7003898901644793`*^9, 3.700389892524732*^9}, {
  3.719812827112528*^9, 3.719812828369467*^9}},
 ExpressionUUID -> "d7fb6dc0-79f4-4c35-b59d-633e95dc9643"],

Cell["\<\
We precompute the weak rates the first time and then we save them on the \
disk.
If the options $RecomputeWeakRates is set to True, the computation is forced.\
\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.69480767445238*^9, 3.694807700179017*^9}, {
   3.698401840923093*^9, 3.698401850842255*^9}, {3.700462153905198*^9, 
   3.700462162326358*^9}, {3.715942268236507*^9, 3.715942272002462*^9}, 
   3.71596165895201*^9, {3.722686564986161*^9, 3.722686581973958*^9}},
 ExpressionUUID -> "2df703e6-e6ab-452c-9465-0406bc56d708"],

Cell["\<\
We first build the name of the file to store the PEN rates. It includes as a \
postfix the values of the booleans for the various effects taken or not taken \
into account.\
\>", "Text",
 CellChangeTimes->{{3.71567398873219*^9, 3.715673999953617*^9}, {
  3.715942273779763*^9, 3.7159422924775867`*^9}},
 ExpressionUUID -> "cb74fbb5-3670-4931-aaaf-c730d65ed74c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LetterFromBoolean", "[", "Bool_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{"Bool", ",", "\"\<T\>\"", ",", "\"\<F\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StringFromBoolean", "[", "BoolList_List", "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"LetterFromBoolean", "/@", "BoolList"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"BooleanSuffix", "=", 
  RowBox[{"StringFromBoolean", "[", 
   RowBox[{"{", 
    RowBox[{
    "$RadiativeCorrections", ",", "$RadiativeThermal", ",", 
     "$FiniteNucleonMass", ",", "$CoupledFMandRC", ",", 
     "$QEDPlasmaCorrections", ",", "$IncompleteNeutrinoDecoupling"}], "}"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7156736603063583`*^9, 3.7156738026009827`*^9}, {
   3.715673984197674*^9, 3.715674010495792*^9}, 3.715961379730034*^9, 
   3.716278723106482*^9, {3.717504656768413*^9, 3.717504657072988*^9}, 
   3.718443054086751*^9, {3.7184442976955223`*^9, 3.718444301604754*^9}, {
   3.7185135492787323`*^9, 3.718513550128767*^9}, 3.7185344922644577`*^9, {
   3.721967670411941*^9, 3.721967687627954*^9}, 3.7226973182082577`*^9, 
   3.722700852065742*^9},
 CellLabel->
  "In[1296]:=",ExpressionUUID->"82866637-a832-488c-8bed-3445bd549f04"],

Cell[BoxData["\<\"TTTTTT\"\>"], "Output",
 CellChangeTimes->CompressedData["
1:eJwdzFsoQ3EABvDjuF9eVi6FRDESjabl1uZgD4q0kS23TKm9nAzTUqSope0U
uUdoaFqaFHuQrTTJULNIoSmtJJpMCWk1/8/D16/ve/iyunvlPWEURZWRHCU3
3O6n+hkNK9DbiHZxtQk6eVOXMKfNNdKe5mduiiUbcMoaGYCdSf2/kBM/xXUQ
tyJmjlXYbw13kLbPFYWl+5lvNU8KabXOC3XW4Xe4MPASQxP5jaFseFJhL4QH
NYcl0Pmsq4Ihk0wKC+RndfBwtLYRBqt/mmGgie2CNPeghmOnHxooMMQOQe9V
2vj/37Seg/JK9TSsZ1YWocqmWP3vbs0mXJctWaBo0LcDhSKhDSZKtA742X1+
HUmcpWffYKfKmxBFrBIu58KgvJyF94/bEzBzI9wMtcYUKppY6jEXwXhZnhI6
LBksdI94DDDf2LIGX3miPRiMybyA11+7rS1E3x0zCaM417yCKF3j9ymJf3zY
wZ0=
  "],
 CellLabel->
  "Out[1298]=",ExpressionUUID->"737ef55b-b194-4680-93a5-706d586c9c51"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NamePENFilenp", "=", "\"\<Interpolations/NP_RATES\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NamePENFilepn", "=", "\"\<Interpolations/PN_RATES\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7156736603063583`*^9, 3.7156738026009827`*^9}, {
   3.715673984197674*^9, 3.715674010495792*^9}, 3.715961379730034*^9, 
   3.716278723106482*^9, {3.717504656768413*^9, 3.717504657072988*^9}, 
   3.718443054086751*^9, {3.7184442976955223`*^9, 3.718444301604754*^9}, {
   3.7185135492787323`*^9, 3.718513550128767*^9}, 3.7185344922644577`*^9, {
   3.721967670411941*^9, 3.721967687627954*^9}, 3.7226973182082577`*^9, 
   3.722700852065742*^9, 3.722700992900197*^9, {3.772095796560708*^9, 
   3.7720958235572968`*^9}, {3.7728758446510477`*^9, 3.772875845719522*^9}},
 CellLabel->
  "In[1299]:=",ExpressionUUID->"c6a6272f-050b-41fe-a4c9-a01528cd58c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$BornBool", "=", 
   RowBox[{
    RowBox[{"Not", "[", "$RadiativeThermal", "]"}], "&&", 
    RowBox[{"Not", "[", "$RadiativeCorrections", "]"}], "&&", 
    RowBox[{"Not", "[", "$FiniteNucleonMass", "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.695064617667581*^9, 3.695064635724402*^9}, {
   3.69541195891753*^9, 3.695411961299*^9}, 3.695411997104*^9, {
   3.696257125368524*^9, 3.696257133961357*^9}, {3.696318306288525*^9, 
   3.696318315377961*^9}, 3.718534492270424*^9},
 CellLabel->
  "In[1301]:=",ExpressionUUID->"d4e6efe5-31d0-43ee-9e1b-46350ea23df7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "We", " ", "store", " ", "the", " ", "rate", " ", "but", " ", "without", 
   " ", "the", " ", "division", " ", "by", " ", 
   RowBox[{"\[Tau]neutron", " ", ".", " ", "So"}], " ", "that", " ", "we", 
   " ", "can", " ", "use", " ", "the", " ", "same", " ", "fit", " ", "for", 
   " ", "the", " ", "reaction", " ", "rates"}], ",", " ", 
  RowBox[{"and", " ", "still", " ", "vary", " ", 
   RowBox[{"\[Tau]neutron", " ", "."}]}]}]], "Text",
 CellChangeTimes->{{3.719058709280066*^9, 3.7190587230718393`*^9}, {
  3.7190590304042273`*^9, 3.719059045927733*^9}, {3.719891110896352*^9, 
  3.719891123654189*^9}},
 FontFamily->"Arial",
 ExpressionUUID -> "e9facffe-bb50-4220-b464-d90979030326"],

Cell[TextData[{
 "The rates in the files, once loaded, are interpolated once the division by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Tau]neutron", "  ", "has", " ", "been", " ", 
    RowBox[{"added", "."}]}], TraditionalForm]],
  ExpressionUUID -> "96719514-78a0-40f3-bf87-8685b99ba75e"]
}], "Text",
 CellChangeTimes->{{3.715942318299591*^9, 3.7159423352996063`*^9}, {
  3.719058726353889*^9, 3.719058743057982*^9}, {3.719891110909333*^9, 
  3.719891123663546*^9}},
 ExpressionUUID -> "def768aa-e09d-4ad1-86ea-ee90f5a32461"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MyTableWeakRate", ":=", 
   RowBox[{"If", "[", 
    RowBox[{"$ParallelWeakRates", ",", 
     RowBox[{
      RowBox[{"ParallelEvaluate", "[", 
       RowBox[{
        RowBox[{"Off", "[", 
         StyleBox[
          RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], "]"}], 
        ";"}], "]"}], ";", "ParallelTable"}], ",", "Table"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PreComputeWeakRates", ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Off", "[", 
      StyleBox[
       RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]nTOpTab", "=", 
      RowBox[{"MyTableWeakRate", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T", ",", 
          RowBox[{"\[Lambda]nTOpNormalized", "[", "T", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"T", ",", "ListT"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]pTOnTab", "=", 
      RowBox[{"MyTableWeakRate", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T", ",", 
          RowBox[{"\[Lambda]pTOnNormalized", "[", "T", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"T", ",", "ListT"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TabRatenp", "=", "\[Lambda]nTOpTab"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TabRatepn", "=", "\[Lambda]pTOnTab"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"On", "[", 
      StyleBox[
       RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]nTOpI", "=", 
      RowBox[{"MyInterpolationRate", "[", 
       RowBox[{"ToExpression", "[", "TabRatenp", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]pTOnI", "=", 
      RowBox[{"MyInterpolationRate", "[", 
       RowBox[{"ToExpression", "[", "TabRatepn", "]"}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[1302]:=",ExpressionUUID->"5e486bd9-fa38-46e2-b586-5e7c7a408bbe"],

Cell["\<\
Importing the rates previously stored if they exist, and recompute if not.\
\>", "Text",
 CellChangeTimes->{{3.72269734584525*^9, 3.72269736839361*^9}, {
  3.772097819280446*^9, 3.772097819938483*^9}},
 ExpressionUUID -> "cfb25198-5671-4d65-8d90-2985f00e5289"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TabRatenp", "=", 
    RowBox[{"Check", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"NamePENFilenp", ",", "\"\<TSV\>\""}], "]"}], ",", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Precomputed n -> p rate not found. We recompute the rates and \
store them. This can take very long\>\"", "]"}], ";", "$Failed"}], ",", 
      RowBox[{"Import", "::", "nffil"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabRatepn", "=", 
    RowBox[{"Check", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"NamePENFilepn", ",", "\"\<TSV\>\""}], "]"}], ",", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Precomputed p -> n rate not found. We recompute the rates and \
store them. This can take very long\>\"", "]"}], ";", "$Failed"}], ",", 
      RowBox[{"Import", "::", "nffil"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"TabRatenp", "===", "$Failed"}], "||", 
      RowBox[{"TabRatepn", "===", "$Failed"}], "||", "$RecomputeWeakRates"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"PreComputeWeakRates", ";"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Lambda]nTOpIPre", "=", 
       RowBox[{
        RowBox[{"MyInterpolationRate", "[", 
         RowBox[{"ToExpression", "[", "TabRatenp", "]"}], "]"}], "@@@", 
        "T\[Nu]overTTable"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]pTOnIPre", "=", 
       RowBox[{
        RowBox[{"MyInterpolationRate", "[", 
         RowBox[{"ToExpression", "[", "TabRatepn", "]"}], "]"}], "@@@", 
        "T\[Nu]overTTable"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]nTOpI", "=", 
       RowBox[{"MyInterpolationRate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ListT", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
            RowBox[{"\[Lambda]nTOpIPre", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "ListT", "]"}]}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]pTOnI", "=", 
       RowBox[{"MyInterpolationRate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ListT", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
            RowBox[{"\[Lambda]pTOnIPre", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "ListT", "]"}]}], "}"}]}], "]"}], "]"}]}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.772095852755252*^9, 3.772095867511056*^9}, {
  3.7720963462092953`*^9, 3.772096376448097*^9}, {3.772097739085281*^9, 
  3.772097774895013*^9}, {3.772097886138743*^9, 3.772097913012102*^9}, {
  3.7720979719051323`*^9, 3.772098020992258*^9}, {3.7720980798159437`*^9, 
  3.772098179630237*^9}, {3.7720995319126787`*^9, 3.772099536668784*^9}, {
  3.772099660749548*^9, 3.772099662576859*^9}, {3.772441778466552*^9, 
  3.772441780128255*^9}, {3.772442463937126*^9, 3.772442470404503*^9}, {
  3.7728758526942053`*^9, 3.7728758653219347`*^9}},
 CellLabel->
  "In[1304]:=",ExpressionUUID->"a238ba9e-05a7-4f12-817e-84e903c0f624"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.50273`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.772441828577292*^9, 3.7724418821911993`*^9, {3.772442474097471*^9, 
   3.772442497296385*^9}, 3.772442580539402*^9, 3.772442712139284*^9, 
   3.7724523819746237`*^9, 3.772452558017808*^9, 3.772778886428431*^9, 
   3.7727790501151657`*^9, 3.772780261301382*^9, 3.77278041325352*^9, 
   3.77278061667974*^9, 3.772780841681773*^9, 3.772780911398409*^9, 
   3.7727809672362137`*^9, 3.772781061113832*^9, 3.772781099926429*^9, 
   3.77278113568257*^9, 3.772781179539308*^9, 3.7727812251766768`*^9, 
   3.772781316887251*^9, 3.772781384287446*^9, 3.772781448930656*^9, 
   3.772781513664192*^9, 3.772781594230402*^9, 3.7727816695706244`*^9, 
   3.77278171685139*^9, 3.772781766378111*^9, 3.772781812130157*^9, 
   3.7727818611949387`*^9, 3.772781902320908*^9, 3.7727819453744307`*^9, 
   3.772781995118149*^9, 3.772782061011264*^9, 3.772788383726211*^9, 
   3.772788590244363*^9, 3.772788840337471*^9, 3.772789054571106*^9, 
   3.772789611225688*^9, 3.772789831027657*^9, 3.772790065501535*^9, 
   3.772790786360014*^9, 3.772791174576042*^9, 3.7727914906332703`*^9, 
   3.772791658322257*^9, 3.772791895878213*^9, 3.772792060144987*^9, 
   3.772792219063549*^9, 3.772792410486663*^9, 3.772953302735054*^9, 
   3.77295372320366*^9, 3.7729558313064747`*^9, 3.77295757818981*^9},
 CellLabel->
  "Out[1306]=",ExpressionUUID->"92303e89-4c77-4eaf-b59a-e8083795802e"]
}, Open  ]],

Cell[TextData[{
 "We give standard names that are used in the network of reactions later. The \
factor ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"1", "/", 
     SubscriptBox["\[Tau]", "n"]}], " ", "is", " ", "the", " ", "one", " ", 
    "appearing", " ", "in", " ", "the", " ", "constant", " ", "defined", " ", 
    "in", " ", 
    RowBox[{"Eq", ".", " ", "91"}], " ", "of", " ", "companion", " ", 
    RowBox[{"paper", "."}]}], TraditionalForm]],
  ExpressionUUID -> "6fe478be-2857-4d7d-9478-1e8c62a3f59a"]
}], "Text",
 InitializationCell->True,
 ExpressionUUID -> "2e09d548-cdbf-4c7a-a90e-1fe02ee09601"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LnTOp", "[", "Tv_", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "\[Tau]neutron"}], "*", 
    RowBox[{"\[Lambda]nTOpI", "[", "Tv", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LpTOn", "[", "Tv_", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "\[Tau]neutron"}], "*", 
    RowBox[{"\[Lambda]pTOnI", "[", "Tv", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LbarnTOp", "[", "Tv_", "]"}], ":=", 
   RowBox[{"LpTOn", "[", "Tv", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.694054719377746*^9, 3.694054764585081*^9}, {
   3.6948053727839737`*^9, 3.69480540790536*^9}, {3.694810211648344*^9, 
   3.694810288143743*^9}, {3.694810323706073*^9, 3.694810326589632*^9}, 
   3.694812692860731*^9, {3.69494370298179*^9, 3.69494371852195*^9}, 
   3.694945348736021*^9, {3.6954089202433367`*^9, 3.695408929034396*^9}, {
   3.6984137014760723`*^9, 3.698413726706608*^9}, {3.699778048403771*^9, 
   3.699778068749795*^9}, 3.715942364016141*^9, {3.719922865372251*^9, 
   3.719922871027533*^9}},
 CellLabel->
  "In[1307]:=",ExpressionUUID->"29fcf689-3451-41b1-8878-47e3b01f3564"],

Cell[TextData[{
 "We check that the rate for neutron decay is what we expect at low \
temperature, that is it is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Tau]neutron", "  ", 
    RowBox[{"only", "."}]}], TraditionalForm]],
  ExpressionUUID -> "cef0d2bf-b4ac-4ae8-aada-fb94d5223afc"],
 " At ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["10", "8"], TraditionalForm]],
  ExpressionUUID -> "9f0f4fc1-fe63-4446-bc61-bb8e882863d1"],
 " K it should be the case."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6940075399459143`*^9, 3.694007557063714*^9}, {
  3.694007981332489*^9, 3.694007981930769*^9}, {3.695017682424944*^9, 
  3.6950176884397497`*^9}, {3.696569338084838*^9, 3.696569345536664*^9}, {
  3.715942379971192*^9, 3.7159423808081636`*^9}, {3.719891110920299*^9, 
  3.719891123677075*^9}},
 ExpressionUUID -> "e97c8450-f5f2-42bb-8055-87dd8789799d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"1", "/", 
  RowBox[{"LnTOp", "[", "Tf", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6940604419305077`*^9, 3.694060451668269*^9}, 
   3.6947569734452877`*^9, {3.6948068197645063`*^9, 3.694806835657609*^9}, {
   3.6954089398933563`*^9, 3.6954089400585623`*^9}, {3.6954463492758083`*^9, 
   3.695446356663975*^9}, {3.70033004927064*^9, 3.700330049489616*^9}, {
   3.71634820534811*^9, 3.716348270264617*^9}, {3.7163683827720613`*^9, 
   3.716368382910007*^9}, {3.716581429095832*^9, 3.716581436238228*^9}, 
   3.719923180490309*^9},
 CellLabel->
  "In[1310]:=",ExpressionUUID->"6fb48859-7390-4309-b1ec-1c2809bf2a67"],

Cell[BoxData["879.5091260495095`"], "Output",
 CellChangeTimes->{
  3.7720996355702057`*^9, 3.7720998518539352`*^9, 3.772101072795516*^9, 
   3.772441582580235*^9, 3.772441905790062*^9, {3.772442481380137*^9, 
   3.772442497336768*^9}, 3.772442580565997*^9, 3.7724427121773033`*^9, 
   3.772452382148078*^9, 3.7724525581877193`*^9, 3.7727788868401957`*^9, 
   3.772779050231626*^9, 3.772780261438005*^9, 3.772780413360015*^9, 
   3.77278061677809*^9, 3.7727808418006*^9, 3.7727809114967737`*^9, 
   3.772780967345669*^9, 3.77278106119804*^9, 3.772781100037136*^9, 
   3.7727811357855597`*^9, 3.772781179632959*^9, 3.772781225281909*^9, 
   3.772781316980596*^9, 3.772781384392434*^9, 3.772781449037756*^9, 
   3.77278151375771*^9, 3.772781594314351*^9, 3.772781669669444*^9, 
   3.772781716967329*^9, 3.7727817664682093`*^9, 3.7727818122229548`*^9, 
   3.7727818612897873`*^9, 3.7727819024051847`*^9, 3.77278194558497*^9, 
   3.772781995228703*^9, 3.772782061116479*^9, 3.772788383867653*^9, 
   3.7727885903903313`*^9, 3.772788840436947*^9, 3.772789055525921*^9, 
   3.7727896113377666`*^9, 3.7727898311403923`*^9, 3.772790065613329*^9, 
   3.772790786473619*^9, 3.772791174694998*^9, 3.772791490741485*^9, 
   3.772791658442473*^9, 3.7727918959992523`*^9, 3.772792060253601*^9, 
   3.772792219169931*^9, 3.772792410617166*^9, 3.772953302781095*^9, 
   3.772953723247714*^9, 3.7729558313377037`*^9, 3.772957578234726*^9},
 CellLabel->
  "Out[1310]=",ExpressionUUID->"62510b2d-71b4-416b-b5b8-0f0ee4c7b109"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"timingEnd", " ", "=", " ", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<[PrimiCosmo]: Completed. Total Time - \>\"", ",", " ", 
   RowBox[{"Round", "[", 
    RowBox[{"timingEnd", " ", "-", " ", "timingStart"}], "]"}], ",", " ", 
   "\"\< seconds\>\""}], "]"}]}], "Code",
 CellChangeTimes->{{3.772875989360373*^9, 3.772876006996375*^9}, {
  3.772876761766905*^9, 3.772876770415348*^9}, {3.772876892295721*^9, 
  3.772876939438114*^9}, {3.772877078504958*^9, 3.7728771043940363`*^9}, {
  3.772877146042914*^9, 3.772877166565716*^9}, {3.772877263031528*^9, 
  3.77287726377955*^9}},
 CellLabel->
  "In[1311]:=",ExpressionUUID->"af5e75bb-fb0e-4926-9104-644b711dd58a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"[PrimiCosmo]: Completed. Total Time - \"\>", 
   "\[InvisibleSpace]", "1794", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["[PrimiCosmo]: Completed. Total Time - ", 1794, " seconds"],
  Editable->False]], "Print",
 CellChangeTimes->{3.7729533028085337`*^9, 3.772953723273099*^9, 
  3.772955831360688*^9, 3.772957578262638*^9},
 CellLabel->
  "During evaluation of \
In[1311]:=",ExpressionUUID->"c138821e-460f-4f7f-ac4e-e513f3fa7245"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{3090, 1689},
WindowMargins->{{0, Automatic}, {0, Automatic}},
PrintPrecision->8,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 217, 4, 229, "Title",ExpressionUUID->"3c9e8cc7-abe9-4e05-bc8e-413892c2a1ef"],
Cell[800, 28, 819, 18, 103, "Text",ExpressionUUID->"c91b633a-faae-415f-b6bc-8385fb70d333"],
Cell[CellGroupData[{
Cell[1644, 50, 177, 3, 136, "Section",ExpressionUUID->"b512a19a-7c9e-44d4-aecc-6f39cc96852a"],
Cell[1824, 55, 3198, 82, 576, "Text",ExpressionUUID->"7e89d71e-8245-4bd5-a66a-34986c2a03e2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5059, 142, 230, 5, 136, "Section",ExpressionUUID->"3b47fbb6-a0dd-4746-bc0f-7e11ddb90e05",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[5314, 151, 446, 11, 150, "Code",ExpressionUUID->"e4915f6f-84f0-44b4-8693-4bb34eb57aff"],
Cell[5763, 164, 283, 5, 50, "Print",ExpressionUUID->"2d89178c-84c6-47d3-8fed-9c152e6a2245"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6083, 174, 164, 3, 110, "Subsection",ExpressionUUID->"c2a1c7cf-fbf7-40d7-b25f-ef0dc5406c0a"],
Cell[6250, 179, 165, 3, 71, "Text",ExpressionUUID->"c91126d0-558a-4a7f-9deb-d6afa88282dd"],
Cell[CellGroupData[{
Cell[6440, 186, 252, 5, 106, "Code",ExpressionUUID->"064612ab-a9e6-48d5-be1f-bb5757d161aa"],
Cell[6695, 193, 282, 5, 102, "Output",ExpressionUUID->"8deabded-1ee6-41c2-bc32-2f2ad29dc383"]
}, Open  ]],
Cell[6992, 201, 120, 0, 71, "Text",ExpressionUUID->"51dbdcbb-414b-416d-9766-99a00845a12d"],
Cell[CellGroupData[{
Cell[7137, 205, 561, 10, 106, "Code",ExpressionUUID->"01ee0912-a99f-403b-9928-d46fbcd5d1f3"],
Cell[7701, 217, 545, 13, 50, "Print",ExpressionUUID->"4692f2de-f16f-4bb1-b791-462b0ae5aace"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8295, 236, 366, 6, 110, "Subsection",ExpressionUUID->"1837f081-9c3d-4dda-a6e9-f2e480bf68f5"],
Cell[8664, 244, 2465, 68, 663, "Text",ExpressionUUID->"dc657191-56d4-48b9-914c-53c8385d1513",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[11166, 317, 260, 4, 110, "Subsection",ExpressionUUID->"2cf451b4-9072-4b3a-a9e8-d58397e7f50f"],
Cell[11429, 323, 266, 4, 79, "Text",ExpressionUUID->"901f7b72-5f3b-49a4-b3b1-9c41a464b178"],
Cell[11698, 329, 9261, 127, 106, "Code",ExpressionUUID->"75269f01-b031-482d-a93f-cdc45f2113cc"],
Cell[20962, 458, 253, 5, 71, "Text",ExpressionUUID->"0f6aa57c-96df-4655-ad8a-1b21e57970f3",
 InitializationCell->True],
Cell[21218, 465, 243, 5, 106, "Code",ExpressionUUID->"3f3efe54-2614-4237-bcda-ebb18f47fae0"],
Cell[21464, 472, 300, 6, 71, "Text",ExpressionUUID->"865ef279-642e-4ec6-8cd1-1e51851903a4"],
Cell[21767, 480, 829, 17, 150, "Code",ExpressionUUID->"57902212-09f8-43b6-b001-c45a1c1872c1"],
Cell[22599, 499, 763, 14, 212, "Text",ExpressionUUID->"c0d10c85-4930-4caa-9988-efe74a26a891"],
Cell[23365, 515, 1169, 21, 79, "Text",ExpressionUUID->"abb0629c-ed68-4f46-a702-60c570246c9f",
 InitializationCell->True],
Cell[24537, 538, 648, 12, 95, "Input",ExpressionUUID->"e0902b2a-66d7-42bf-8174-db9ec38b269e",
 InitializationCell->True],
Cell[25188, 552, 214, 3, 71, "Text",ExpressionUUID->"b8c937a7-2c92-40db-aae6-4f1613afda0a"],
Cell[25405, 557, 185, 5, 95, "Input",ExpressionUUID->"182e9cd2-a505-41dd-bd9a-2a1510ff84f4",
 InitializationCell->True],
Cell[25593, 564, 2993, 45, 165, "Text",ExpressionUUID->"e6985bdd-b689-4f84-a19b-1fe801d46423",
 InitializationCell->True],
Cell[28589, 611, 258, 6, 95, "Input",ExpressionUUID->"30c57e32-3a14-4321-8155-782b0e8372c6",
 InitializationCell->True],
Cell[28850, 619, 3354, 54, 121, "Text",ExpressionUUID->"bb60215e-c9ee-4117-8276-0831d09bd473",
 InitializationCell->True],
Cell[32207, 675, 5084, 72, 95, "Input",ExpressionUUID->"42d9e9d7-eb79-430b-b003-0b2b118795e6",
 InitializationCell->True],
Cell[37294, 749, 3104, 45, 118, "Text",ExpressionUUID->"6a81e2a7-e1ee-4585-bd1a-cc353b6658f4",
 InitializationCell->True],
Cell[40401, 796, 9929, 137, 95, "Input",ExpressionUUID->"70a53b33-8cb6-4fde-847c-036ecfc3076f",
 InitializationCell->True],
Cell[50333, 935, 5754, 91, 133, "Text",ExpressionUUID->"bdf1f708-abf5-4d3e-b4f4-5df9f5e07f5b",
 InitializationCell->True],
Cell[56090, 1028, 2519, 37, 95, "Input",ExpressionUUID->"6f3cb3b2-b2f0-488e-9778-9576d947cf21",
 InitializationCell->True],
Cell[58612, 1067, 2538, 38, 71, "Text",ExpressionUUID->"d21bcd79-8641-4553-875f-a7d5d74506ea",
 InitializationCell->True],
Cell[61153, 1107, 2829, 41, 95, "Input",ExpressionUUID->"6906aec7-7d72-4a33-aa3b-759e51f40261",
 InitializationCell->True],
Cell[63985, 1150, 334, 6, 118, "Text",ExpressionUUID->"5d44a79b-ace1-4e24-8a7f-741c413f48aa",
 InitializationCell->True],
Cell[64322, 1158, 4777, 67, 95, "Input",ExpressionUUID->"9567ad4d-55ea-478b-8f82-08981a005df9",
 InitializationCell->True],
Cell[69102, 1227, 428, 8, 71, "Text",ExpressionUUID->"d5e7c688-1452-4a37-a0b6-26ebb29c78a7"],
Cell[69533, 1237, 365, 8, 63, "Input",ExpressionUUID->"7e31273b-8767-4cbd-b4c2-a09ce5fb5b98"],
Cell[69901, 1247, 193, 3, 71, "Text",ExpressionUUID->"37970271-3a2c-4940-a69a-713e300e6ada"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70131, 1255, 300, 5, 110, "Subsection",ExpressionUUID->"39cf9565-37f8-41fc-a56d-b89c4ba515e1",
 InitializationCell->True],
Cell[70434, 1262, 662, 12, 353, "Text",ExpressionUUID->"228b3b2a-a215-4fb9-bc53-53520228fa7e"],
Cell[71099, 1276, 289, 7, 143, "Input",ExpressionUUID->"c968aaad-53a5-469f-9f76-4232b987e32e",
 InitializationCell->True],
Cell[71391, 1285, 603, 13, 306, "Text",ExpressionUUID->"a99ca887-8e3a-44a9-8a13-8e4a7e189b89",
 InitializationCell->True],
Cell[71997, 1300, 427, 12, 237, "Input",ExpressionUUID->"e6d52503-02df-4db8-9a47-a1241485febe",
 InitializationCell->True],
Cell[72427, 1314, 922, 16, 353, "Text",ExpressionUUID->"8c3bcf34-0c98-4d3a-a013-c987958c0ef0",
 InitializationCell->True],
Cell[73352, 1332, 2610, 47, 143, "Input",ExpressionUUID->"1da5bc33-a0ed-443f-82ea-bfdb3e5e5033",
 InitializationCell->True],
Cell[75965, 1381, 1297, 22, 447, "Text",ExpressionUUID->"03af5346-b386-48d9-a17c-03d5f3f4e2de",
 InitializationCell->True],
Cell[77265, 1405, 5962, 83, 95, "Input",ExpressionUUID->"d9567afb-a435-4b5e-902e-527c6697dbff",
 InitializationCell->True],
Cell[83230, 1490, 596, 13, 165, "Text",ExpressionUUID->"fa79171f-0816-4859-84b7-be812b0cfa75",
 InitializationCell->True],
Cell[83829, 1505, 2215, 33, 95, "Input",ExpressionUUID->"b99381b6-c944-4f4d-85e7-bbdc20dddd4b",
 InitializationCell->True],
Cell[86047, 1540, 684, 13, 259, "Text",ExpressionUUID->"5ba47d5f-c687-4a65-8d42-ea6888a0e68a",
 InitializationCell->True],
Cell[86734, 1555, 706, 15, 165, "Text",ExpressionUUID->"e49fd04f-c645-4648-a616-bd5d2cfe9012"],
Cell[87443, 1572, 308, 7, 95, "Input",ExpressionUUID->"fa803c13-24b4-4999-b525-fb7f5fbbcb20",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[87788, 1584, 263, 4, 110, "Subsection",ExpressionUUID->"5e722e23-782c-4e2a-934c-092750a85d70"],
Cell[88054, 1590, 1790, 34, 143, "Input",ExpressionUUID->"87d82ed7-e6e5-4764-a56f-1686c2b7371f",
 InitializationCell->True],
Cell[89847, 1626, 706, 13, 259, "Text",ExpressionUUID->"5f769a06-cbd7-43db-975e-650f6296e949",
 InitializationCell->True],
Cell[90556, 1641, 1988, 36, 95, "Input",ExpressionUUID->"4ab75b5d-9c3b-4da6-ac93-8ced73903c79",
 InitializationCell->True],
Cell[92547, 1679, 979, 13, 259, "Text",ExpressionUUID->"81460e21-0609-43ee-806e-f2aa7e3e29ff"],
Cell[93529, 1694, 6193, 86, 95, "Input",ExpressionUUID->"d6edfbcb-9da8-4568-a651-33e7a7447992",
 InitializationCell->True],
Cell[99725, 1782, 455, 9, 118, "Text",ExpressionUUID->"d101c2ed-4f04-472e-984b-8c8eef51f18b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100217, 1796, 167, 3, 110, "Subsection",ExpressionUUID->"bee3d7aa-99b5-4852-8ff9-1545252b109b"],
Cell[100387, 1801, 849, 16, 143, "Input",ExpressionUUID->"35a7ba33-6773-4885-9f8a-d3eaf520ee5e",
 InitializationCell->True],
Cell[101239, 1819, 795, 15, 165, "Text",ExpressionUUID->"3973867b-932b-465c-9cb9-f80dd9abaf1c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[102083, 1840, 217, 4, 139, "Chapter",ExpressionUUID->"d8c804c6-e331-4605-8de4-2305ab3861bb"],
Cell[CellGroupData[{
Cell[102325, 1848, 332, 6, 110, "Subsection",ExpressionUUID->"2bb5b4ef-4c31-4765-a6b5-908196e88138",
 InitializationCell->True],
Cell[102660, 1856, 1144, 26, 306, "Text",ExpressionUUID->"2da4740b-7f86-4d7f-987f-702517d25886"],
Cell[103807, 1884, 1389, 35, 284, "Input",ExpressionUUID->"1a4b23d9-d13a-4a2d-8e84-5b05925e06cf",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[105233, 1924, 286, 4, 110, "Subsection",ExpressionUUID->"63faa59c-8f47-4ffe-9088-a1f1b545ac96",
 InitializationCell->True],
Cell[105522, 1930, 560, 14, 71, "Text",ExpressionUUID->"09d11b21-26c5-4ad6-9b4c-e5e10e2a2046"],
Cell[106085, 1946, 3488, 59, 237, "Input",ExpressionUUID->"109b176c-e063-4831-9779-636dac072e60",
 InitializationCell->True],
Cell[109576, 2007, 242, 6, 71, "Text",ExpressionUUID->"f3f43723-9495-4281-85f4-29dda866f4b1"],
Cell[109821, 2015, 1771, 37, 144, "Input",ExpressionUUID->"df098e13-20e0-4f68-a6ff-d5cac0c310a9",
 InitializationCell->True],
Cell[111595, 2054, 2402, 62, 284, "Input",ExpressionUUID->"a6ebfc50-fc01-4e64-a9dd-dbcb0451fe9d",
 InitializationCell->True],
Cell[114000, 2118, 912, 18, 165, "Text",ExpressionUUID->"df35e7c2-f03a-4604-94ee-3811adb20223",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[114949, 2141, 220, 4, 110, "Subsection",ExpressionUUID->"cb5bcee3-241d-44e7-9d2c-cc525b688a6c",
 InitializationCell->True],
Cell[115172, 2147, 172, 3, 74, "Text",ExpressionUUID->"90fb0ef8-7a6e-45ed-a763-4d085ad46a27"],
Cell[115347, 2152, 970, 20, 133, "Text",ExpressionUUID->"98da1543-6121-48ce-ada1-2025c4dd4bbf",
 InitializationCell->True],
Cell[116320, 2174, 672, 16, 72, "Text",ExpressionUUID->"01ba93d8-c089-42a9-8e64-fe3ec967c480",
 InitializationCell->True],
Cell[116995, 2192, 567, 12, 72, "Text",ExpressionUUID->"8689666d-02d7-4d0e-8c28-b91f1167465d",
 InitializationCell->True],
Cell[117565, 2206, 1148, 21, 190, "Input",ExpressionUUID->"106c34e7-6b39-486f-955c-0bafbde1ab58",
 InitializationCell->True],
Cell[118716, 2229, 315, 7, 71, "Text",ExpressionUUID->"d275115e-b9fa-42bc-883d-f244a8cbdf18",
 InitializationCell->True],
Cell[119034, 2238, 1542, 41, 331, "Input",ExpressionUUID->"4c1cb408-d9b0-4951-a2ef-626610918cb1",
 InitializationCell->True],
Cell[120579, 2281, 502, 14, 190, "Input",ExpressionUUID->"8f4f4881-d61b-42a9-b3e6-45859e42105e",
 InitializationCell->True],
Cell[121084, 2297, 284, 5, 74, "Text",ExpressionUUID->"34383e91-7a39-410f-aeea-19d79f4f60e3",
 InitializationCell->True],
Cell[121371, 2304, 2117, 50, 281, "Input",ExpressionUUID->"7cb2030d-e2c6-4ab0-8f9d-e5f8f5c4c1ad",
 InitializationCell->True],
Cell[123491, 2356, 875, 15, 71, "Text",ExpressionUUID->"690e452c-bd75-482f-b9f5-391f31546bc6",
 InitializationCell->True],
Cell[124369, 2373, 1283, 27, 237, "Input",ExpressionUUID->"f3c0d75b-b0d5-4559-b04a-1983bdf6b342",
 InitializationCell->True],
Cell[125655, 2402, 191, 4, 71, "Text",ExpressionUUID->"c110bf12-59a7-4898-9852-80f34cbd4e1c",
 InitializationCell->True],
Cell[125849, 2408, 4711, 90, 287, "Input",ExpressionUUID->"7aa32139-949f-4328-8e6d-40518a62c2f5",
 InitializationCell->True],
Cell[130563, 2500, 3256, 56, 143, "Input",ExpressionUUID->"68be6e2a-4928-4b2e-9f55-68f65075498d",
 InitializationCell->True],
Cell[133822, 2558, 4577, 66, 165, "Text",ExpressionUUID->"e121256a-1a97-4cf3-8fa1-61014616f777",
 InitializationCell->True],
Cell[138402, 2626, 968, 21, 99, "Input",ExpressionUUID->"d86a4c70-2445-4ad9-aee2-77269380bb5c",
 InitializationCell->True],
Cell[139373, 2649, 249, 4, 74, "Text",ExpressionUUID->"92798007-f153-468c-96cc-15dd5bd833af"],
Cell[139625, 2655, 584, 11, 76, "Text",ExpressionUUID->"ce9153e3-7ae0-4862-9ee2-b7d0ad9bbf17",
 InitializationCell->True],
Cell[140212, 2668, 2536, 58, 425, "Input",ExpressionUUID->"fa14aca9-e004-4f1f-85e5-3f5a22912e21",
 InitializationCell->True],
Cell[142751, 2728, 206, 3, 74, "Text",ExpressionUUID->"eb7e8293-e8bc-4cc0-b4ed-cc112d58370d"],
Cell[142960, 2733, 312, 5, 71, "Text",ExpressionUUID->"6e77f860-cc16-47a9-b99d-61e40fbca22e",
 InitializationCell->True],
Cell[143275, 2740, 1541, 42, 237, "Input",ExpressionUUID->"d1d595b7-f1ac-4227-9846-64a20efad353",
 InitializationCell->True],
Cell[144819, 2784, 281, 7, 71, "Text",ExpressionUUID->"be56230d-fea1-42bb-99f1-c376b9383c4b",
 InitializationCell->True],
Cell[145103, 2793, 1506, 38, 224, "Input",ExpressionUUID->"069349e2-12e2-4d7c-9624-d49c8c262669",
 InitializationCell->True],
Cell[146612, 2833, 415, 7, 71, "Text",ExpressionUUID->"52254313-2c55-4945-b441-cc323d6ebb1c",
 InitializationCell->True],
Cell[147030, 2842, 2629, 47, 237, "Input",ExpressionUUID->"117e85d4-5807-49ab-a7f8-774cf4f53d39",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[149696, 2894, 296, 5, 110, "Subsection",ExpressionUUID->"aa1b8520-b11e-4357-a3ec-964079b564bb",
 InitializationCell->True],
Cell[149995, 2901, 288, 7, 71, "Text",ExpressionUUID->"b63a093e-c3d0-4b46-aa6f-612d10b4efd8"],
Cell[150286, 2910, 384, 11, 143, "Input",ExpressionUUID->"977058ec-d41e-47d4-9d2b-d7ee5e6cf9ca",
 InitializationCell->True],
Cell[150673, 2923, 1523, 44, 299, "Input",ExpressionUUID->"5ad1d76e-a27d-43e1-b9d5-ef8f3a18a8c2",
 InitializationCell->True],
Cell[152199, 2969, 689, 13, 126, "Text",ExpressionUUID->"60681f89-cd1b-454f-894b-2ab99d60db98"],
Cell[152891, 2984, 1434, 26, 138, "Input",ExpressionUUID->"a5157e2f-a042-4ccc-be36-d93c5ef24f7d",
 InitializationCell->True],
Cell[154328, 3012, 161, 3, 71, "Text",ExpressionUUID->"9ff5eacb-4cc1-4444-95b3-ba7c78f2a575"],
Cell[154492, 3017, 1182, 24, 143, "Input",ExpressionUUID->"7e866660-f5ed-4269-8b06-a511fd00ced3",
 InitializationCell->True],
Cell[155677, 3043, 296, 6, 71, "Text",ExpressionUUID->"75c1409c-4969-4180-a00f-3d5148845d7e",
 InitializationCell->True],
Cell[155976, 3051, 1713, 40, 367, "Input",ExpressionUUID->"eb4ea9b3-8370-4d00-93c9-a3f4e1d1fa02",
 InitializationCell->True],
Cell[157692, 3093, 1242, 24, 306, "Text",ExpressionUUID->"b72ad87a-4d11-4717-af22-f5488988c9d0",
 InitializationCell->True],
Cell[158937, 3119, 229, 4, 71, "Text",ExpressionUUID->"2420f904-b01d-41d2-afc5-92659a65cfe9",
 InitializationCell->True],
Cell[159169, 3125, 840, 19, 95, "Input",ExpressionUUID->"7cd98e4a-a313-4252-a61d-f88d187f729d",
 InitializationCell->True],
Cell[160012, 3146, 177, 3, 71, "Text",ExpressionUUID->"97291d97-453b-49d5-8c32-b727a0dd1e2f"],
Cell[160192, 3151, 659, 18, 190, "Input",ExpressionUUID->"c126d17c-91be-4d13-8587-02c29a846222",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[160888, 3174, 353, 6, 110, "Subsection",ExpressionUUID->"75bc1380-6397-4363-acf9-cae5475d916d",
 InitializationCell->True],
Cell[161244, 3182, 208, 4, 71, "Text",ExpressionUUID->"26563769-5afb-4f1f-a00a-d16f09b196fb",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[161477, 3190, 566, 14, 147, "Input",ExpressionUUID->"3acb21ce-8991-4b90-a57b-2d0178678e4e",
 InitializationCell->True],
Cell[162046, 3206, 890, 17, 102, "Output",ExpressionUUID->"a4c117e6-2a47-443a-a19c-db8335e5960c",
 InitializationCell->True]
}, Open  ]],
Cell[162951, 3226, 194, 5, 71, "Text",ExpressionUUID->"e591b665-7f01-4b7a-b02b-cc457982cacc",
 InitializationCell->True],
Cell[163148, 3233, 1610, 40, 238, "Input",ExpressionUUID->"c5c6a43d-0eea-4721-8bc9-594ed9333c22",
 InitializationCell->True],
Cell[164761, 3275, 289, 7, 71, "Text",ExpressionUUID->"8fac4809-95f8-4aa5-ad77-3798ca8162cb",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[165075, 3286, 161, 4, 95, "Input",ExpressionUUID->"bbd3b1d9-cdd0-422e-8076-0887eacce247",
 InitializationCell->True],
Cell[165239, 3292, 852, 16, 102, "Output",ExpressionUUID->"d9bb458d-f491-4fdd-8c39-3ff836c39554"]
}, Open  ]],
Cell[166106, 3311, 197, 3, 71, "Text",ExpressionUUID->"942c6aa6-85dc-41d2-98a7-f806b65663fc"],
Cell[166306, 3316, 666, 14, 97, "Input",ExpressionUUID->"5dabe352-99ef-459c-a307-ac26a4c32342",
 InitializationCell->True],
Cell[166975, 3332, 374, 8, 118, "Text",ExpressionUUID->"dc550510-17a0-4ed7-afbc-62f30a56b828"],
Cell[167352, 3342, 777, 17, 131, "Input",ExpressionUUID->"1db81fb1-c74f-44aa-9afe-4d9bb0c74157",
 InitializationCell->True],
Cell[168132, 3361, 379, 9, 71, "Text",ExpressionUUID->"95fe0ddf-f769-408d-a339-b56cb9cd2a1e",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[168536, 3374, 353, 8, 108, "Input",ExpressionUUID->"66ce3f35-6c03-4292-bc56-76f14d335dd4"],
Cell[168892, 3384, 899, 17, 133, "Output",ExpressionUUID->"ae2e4de9-81a2-4dc2-b408-7dbc961a33f5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[169840, 3407, 244, 5, 110, "Subsection",ExpressionUUID->"205a59ac-1e4a-40ba-9e3b-907e6274a58b",
 InitializationCell->True],
Cell[170087, 3414, 633, 16, 71, "Text",ExpressionUUID->"7ff3ae13-0dab-445f-83a2-0ff24f742e74",
 InitializationCell->True],
Cell[170723, 3432, 2597, 72, 614, "Input",ExpressionUUID->"62f85db8-df22-44d9-b926-a5f2df9d5385",
 InitializationCell->True],
Cell[173323, 3506, 300, 5, 71, "Text",ExpressionUUID->"aedfafb5-c089-4edc-9225-200b851e1090",
 InitializationCell->True],
Cell[173626, 3513, 673, 18, 137, "Input",ExpressionUUID->"1795a94b-77fb-470c-ab04-760ac29a09c2",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[174336, 3536, 352, 6, 110, "Subsection",ExpressionUUID->"9e0467e6-6766-400d-b0f9-7d10bf47cce8",
 InitializationCell->True],
Cell[174691, 3544, 304, 7, 71, "Text",ExpressionUUID->"8dec58f7-4b1e-452e-88c7-79cd55d3f051",
 InitializationCell->True],
Cell[174998, 3553, 428, 10, 95, "Input",ExpressionUUID->"0c8a7072-6039-4b2a-9d33-cbafcfb63774",
 InitializationCell->True],
Cell[175429, 3565, 237, 6, 71, "Text",ExpressionUUID->"e670a318-713d-4447-938b-2b3ad0677af0"],
Cell[175669, 3573, 364, 9, 95, "Input",ExpressionUUID->"4ab1e4b7-ff8e-4a70-bdf2-272883179021",
 InitializationCell->True],
Cell[176036, 3584, 339, 7, 71, "Text",ExpressionUUID->"526cb019-f861-4d37-8e35-4693265010b6"],
Cell[176378, 3593, 1902, 51, 378, "Input",ExpressionUUID->"18a3433d-2269-4ea7-b60f-90c2da005fcd",
 InitializationCell->True],
Cell[178283, 3646, 296, 7, 118, "Text",ExpressionUUID->"fc30af7b-45e1-4564-90de-eff693ea30ab"],
Cell[178582, 3655, 1452, 28, 143, "Input",ExpressionUUID->"8688bf8f-addc-4ac5-bc72-aeaba74ab7e6",
 InitializationCell->True],
Cell[180037, 3685, 364, 7, 71, "Text",ExpressionUUID->"87b0d044-a924-4e72-9672-98c133fad5a1"],
Cell[180404, 3694, 613, 18, 143, "Input",ExpressionUUID->"92e94952-b75c-4eb4-aa46-51358194eea1",
 InitializationCell->True],
Cell[181020, 3714, 363, 8, 71, "Text",ExpressionUUID->"0e07ff5c-8fe4-4dfe-be35-4ee80d83df38"],
Cell[181386, 3724, 2534, 70, 190, "Input",ExpressionUUID->"1c568d81-ef72-4f71-b794-3e26a66f5062",
 InitializationCell->True],
Cell[183923, 3796, 294, 4, 71, "Text",ExpressionUUID->"9a1a1a2e-3889-4e0c-81cb-7511241d23fe"],
Cell[184220, 3802, 1032, 22, 143, "Input",ExpressionUUID->"9f836f26-1f30-4091-ad69-dac7129d3e66",
 InitializationCell->True],
Cell[185255, 3826, 176, 3, 71, "Text",ExpressionUUID->"57f1d73d-3da4-4f15-a67c-0592e439b0ea"],
Cell[185434, 3831, 908, 21, 95, "Input",ExpressionUUID->"315c3a09-3d94-4d79-8bcd-6f455bc40adc",
 InitializationCell->True],
Cell[186345, 3854, 182, 3, 71, "Text",ExpressionUUID->"e41240f3-020b-498d-bd6a-3dd90f2d6853"],
Cell[186530, 3859, 1229, 33, 143, "Input",ExpressionUUID->"07163bc0-ebbb-4c25-9550-fb9171ffc5a7",
 InitializationCell->True],
Cell[187762, 3894, 303, 7, 71, "Text",ExpressionUUID->"4fe8a34e-8430-4e55-a142-a1cff9b0d066"],
Cell[188068, 3903, 1517, 35, 237, "Input",ExpressionUUID->"f0f6ed0d-64bf-487d-8041-77b718ca30e0",
 InitializationCell->True],
Cell[189588, 3940, 233, 4, 71, "Text",ExpressionUUID->"d39bbd05-9675-4e55-a3fe-6e58b9ebc472"],
Cell[189824, 3946, 3896, 103, 400, "Input",ExpressionUUID->"3c9213de-d2a5-4d06-9d40-27ffb091165b",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[193769, 4055, 253, 5, 139, "Chapter",ExpressionUUID->"d839e9df-4a99-4a03-b8a1-fbc3486d8b53",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[194047, 4064, 169, 3, 136, "Section",ExpressionUUID->"7a6467c2-3d75-4341-b5d8-b64e6338a85c"],
Cell[194219, 4069, 267, 4, 71, "Text",ExpressionUUID->"d119a72c-02ce-430f-9740-0efde4c1e1ea"],
Cell[194489, 4075, 3387, 97, 599, "Input",ExpressionUUID->"bb7424c0-69f0-455d-b535-657955539454",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[197913, 4177, 265, 5, 136, "Section",ExpressionUUID->"c3adb8b0-676a-401a-998d-7d473d8a3e92",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[198203, 4186, 341, 6, 110, "Subsection",ExpressionUUID->"bee20232-05e1-41cb-97c6-b28231f33478",
 InitializationCell->True],
Cell[198547, 4194, 1241, 31, 263, "Text",ExpressionUUID->"57e12874-0277-4ab7-bcb1-4be49cf27069",
 InitializationCell->True],
Cell[199791, 4227, 1366, 42, 229, "Input",ExpressionUUID->"cd3d174b-a9e5-4cf8-82ff-6d4883a24f39",
 InitializationCell->True],
Cell[201160, 4271, 687, 13, 118, "Text",ExpressionUUID->"78aff461-97ee-410e-996a-561efe129cb1",
 InitializationCell->True],
Cell[201850, 4286, 2781, 55, 284, "Input",ExpressionUUID->"c99d09ff-69d5-42b7-b912-bf88d425dda6",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[204656, 4345, 3240, 65, 425, "Input",ExpressionUUID->"96d9beed-cec2-43f1-a84f-a1b61f4a83ce",
 InitializationCell->True],
Cell[207899, 4412, 902, 18, 102, "Output",ExpressionUUID->"dfdbbecf-2434-4566-8284-de0c1e55a216"]
}, Open  ]],
Cell[208816, 4433, 260, 6, 71, "Text",ExpressionUUID->"f6c21998-b3ad-4d6b-8f37-04a641717de9"],
Cell[209079, 4441, 2066, 35, 143, "Input",ExpressionUUID->"d84fb41b-ec77-4c0e-8c85-109a516cf3c4",
 InitializationCell->True],
Cell[211148, 4478, 448, 8, 118, "Text",ExpressionUUID->"9a66dfce-73aa-4730-9bf6-347397f47165"],
Cell[211599, 4488, 1192, 30, 143, "Input",ExpressionUUID->"6873e003-1abe-4639-8706-97d4510779b7",
 InitializationCell->True],
Cell[212794, 4520, 650, 19, 71, "Text",ExpressionUUID->"0a055772-5326-4bc1-bedd-25ae76cbdbc7",
 InitializationCell->True],
Cell[213447, 4541, 513, 13, 95, "Input",ExpressionUUID->"9443429f-7b5d-454c-98d8-760df365e0ea",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[213997, 4559, 296, 5, 110, "Subsection",ExpressionUUID->"7c51a17e-a9fc-43b6-b99d-7fbff3050bc4",
 InitializationCell->True],
Cell[214296, 4566, 481, 8, 118, "Text",ExpressionUUID->"6ee91e1f-e727-412d-9fec-c12843528ec8",
 InitializationCell->True],
Cell[214780, 4576, 1370, 38, 136, "Input",ExpressionUUID->"d6b49c9c-e1b1-4fe9-9e25-63e6a3e52b47",
 InitializationCell->True],
Cell[216153, 4616, 368, 7, 71, "Text",ExpressionUUID->"b1bbd474-dcba-45a9-a2f3-807d22bd5afe"],
Cell[216524, 4625, 5765, 143, 924, "Input",ExpressionUUID->"ddc0c52b-cc92-4501-a2e3-c3edc1b3b01c",
 InitializationCell->True],
Cell[222292, 4770, 366, 8, 71, "Text",ExpressionUUID->"94f3d2b8-94a4-419c-90d7-0e7decf33a4d",
 InitializationCell->True],
Cell[222661, 4780, 1483, 34, 190, "Input",ExpressionUUID->"6e2a7394-77d7-4404-b795-456292500ece",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[224181, 4819, 302, 5, 110, "Subsection",ExpressionUUID->"2ffba81a-b569-425e-8611-f6ca5e3ba17a",
 InitializationCell->True],
Cell[224486, 4826, 236, 5, 71, "Text",ExpressionUUID->"7922e7be-6c36-43d3-9481-4631a9257e34",
 InitializationCell->True],
Cell[224725, 4833, 722, 18, 143, "Input",ExpressionUUID->"e6b73ea9-62d8-4d7d-b9bc-13708891261a",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[225484, 4856, 314, 5, 110, "Subsection",ExpressionUUID->"cd97dcfb-3ccf-4347-a209-d34ada1ce1c8",
 InitializationCell->True],
Cell[225801, 4863, 239, 5, 71, "Text",ExpressionUUID->"20fa28a6-ee89-42a6-976b-bbf75c659825",
 InitializationCell->True],
Cell[226043, 4870, 962, 29, 239, "Input",ExpressionUUID->"c453cf12-2ac2-4f7a-bc96-6e4ddf04cdd8",
 InitializationCell->True],
Cell[227008, 4901, 566, 11, 71, "Text",ExpressionUUID->"7f46b82a-383c-4fe1-b299-7b47c93b52bd",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[227599, 4916, 3398, 75, 566, "Input",ExpressionUUID->"ad5fd616-48fe-442a-a323-0a4db5d68b66",
 InitializationCell->True],
Cell[231000, 4993, 892, 18, 108, "Output",ExpressionUUID->"55624e60-128f-4364-938d-986617fde8c6"]
}, Open  ]],
Cell[231907, 5014, 235, 6, 71, "Text",ExpressionUUID->"1a8812af-8cbc-475d-9ac0-f9e8e24bf63d"],
Cell[232145, 5022, 1980, 35, 143, "Input",ExpressionUUID->"9f598df5-aff7-4545-b550-9b163092e4fa",
 InitializationCell->True],
Cell[234128, 5059, 715, 19, 76, "Text",ExpressionUUID->"072f1082-a2fd-4e02-b621-32c42d161f8c",
 InitializationCell->True],
Cell[234846, 5080, 991, 27, 143, "Input",ExpressionUUID->"c6a233f3-eeb6-4b82-b980-c393f54492f3",
 InitializationCell->True],
Cell[235840, 5109, 674, 18, 71, "Text",ExpressionUUID->"f2341878-092f-4f93-af0a-b3df14297804",
 InitializationCell->True],
Cell[236517, 5129, 829, 21, 222, "Input",ExpressionUUID->"8f46e5c2-03b1-4b22-9325-6f4a6e88441f",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[237395, 5156, 356, 6, 136, "Section",ExpressionUUID->"66386419-2718-4bdc-a558-40fc16e1fe0b",
 InitializationCell->True],
Cell[237754, 5164, 812, 16, 306, "Text",ExpressionUUID->"216964d7-8021-4975-a016-9a323559dd8b",
 InitializationCell->True],
Cell[238569, 5182, 454, 7, 71, "Text",ExpressionUUID->"b9db7730-9905-457f-8e96-2cf7ba232f1a",
 InitializationCell->True],
Cell[239026, 5191, 426, 8, 118, "Text",ExpressionUUID->"855106c0-f02d-4090-89a4-abee156abc2e",
 InitializationCell->True],
Cell[239455, 5201, 3429, 83, 374, "Input",ExpressionUUID->"0aba7972-9003-4c4c-abd1-59075c277b38",
 InitializationCell->True],
Cell[242887, 5286, 440, 9, 118, "Text",ExpressionUUID->"84bff0a6-6a95-4a69-afed-7d38ac95801e",
 InitializationCell->True],
Cell[243330, 5297, 2253, 50, 228, "Input",ExpressionUUID->"49fd6727-f4bb-4a9a-861a-a1937dc552a7",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[245620, 5352, 482, 9, 136, "Section",ExpressionUUID->"1aa422d6-e018-46c7-ac33-447138896fcf",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[246127, 5365, 285, 7, 106, "Code",ExpressionUUID->"1f406f72-10ea-4c3a-94b0-c0432c7cda42"],
Cell[246415, 5374, 294, 5, 50, "Print",ExpressionUUID->"68761b1a-acb0-48fc-a053-adf3830b2501"]
}, Open  ]],
Cell[246724, 5382, 466, 9, 71, "Text",ExpressionUUID->"19d9d409-a983-4dcc-8085-638080b85ac0"],
Cell[CellGroupData[{
Cell[247215, 5395, 1833, 38, 451, "Code",ExpressionUUID->"35cbcbd0-80ef-4d24-8d61-459bd2269b53"],
Cell[CellGroupData[{
Cell[249073, 5437, 597, 12, 50, "Print",ExpressionUUID->"f90d509f-18fd-4c15-baa8-ea7a4d439a1d"],
Cell[249673, 5451, 536, 11, 50, "Print",ExpressionUUID->"c3b7b15f-1015-421a-a3a9-27e3110e510a"],
Cell[250212, 5464, 528, 11, 50, "Print",ExpressionUUID->"ae899c41-0065-4a2e-94da-358bcd92f4bc"],
Cell[250743, 5477, 549, 12, 50, "Print",ExpressionUUID->"e6281c07-fc9d-4de2-a7cc-28763f1fa81e"]
}, Open  ]]
}, Open  ]],
Cell[251319, 5493, 381, 11, 71, "Text",ExpressionUUID->"f2dedb06-e5d9-4a25-b2d2-b4a64ea32ada"],
Cell[251703, 5506, 964, 23, 95, "Input",ExpressionUUID->"c10937ff-af93-4d69-8ced-28730c785571",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[252716, 5535, 579, 9, 139, "Chapter",ExpressionUUID->"d964d11c-5c10-482c-8d1a-914a04748af6",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[253320, 5548, 301, 5, 136, "Section",ExpressionUUID->"0f1bca87-7de7-421d-8d15-280d01a42377",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[253646, 5557, 277, 6, 106, "Code",ExpressionUUID->"bc00aee4-c0c5-44ea-bc02-a0a693e20274"],
Cell[253926, 5565, 288, 5, 50, "Print",ExpressionUUID->"c40e25fa-6e6e-4c24-9dd9-4d428a342c17"]
}, Open  ]],
Cell[254229, 5573, 568, 14, 165, "Text",ExpressionUUID->"e328805b-93d5-4662-8d98-fa2f411f6f8c",
 InitializationCell->True],
Cell[254800, 5589, 3429, 106, 472, "Input",ExpressionUUID->"48f58606-6dc9-4994-a945-898d6c09b46a",
 InitializationCell->True],
Cell[258232, 5697, 3809, 107, 472, "Input",ExpressionUUID->"acc173a4-c2b6-4300-bbc4-b76194bad307",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[262078, 5809, 259, 6, 136, "Section",ExpressionUUID->"7db62c4d-d0a1-406a-b642-972265f94513",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[262362, 5819, 396, 11, 110, "Subsection",ExpressionUUID->"0ebe464d-2abb-45dc-8c30-e20131b21959",
 InitializationCell->True],
Cell[262761, 5832, 180, 4, 71, "Text",ExpressionUUID->"17edc3fc-3c31-42b0-be46-e15b33c894cf",
 InitializationCell->True],
Cell[262944, 5838, 1431, 42, 75, "Text",ExpressionUUID->"cd7902be-680e-4bfa-939a-2074fdbe3ec5",
 InitializationCell->True],
Cell[264378, 5882, 1964, 40, 126, "Input",ExpressionUUID->"a433a40c-204f-4fa2-bbcc-99b2a442479c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[266379, 5927, 399, 7, 110, "Subsection",ExpressionUUID->"fd382002-c6cb-449d-81c6-eeec94e88b58",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[266803, 5938, 561, 10, 91, "Subsubsection",ExpressionUUID->"2a02a048-297c-447d-9c4a-6347e976088a",
 InitializationCell->True],
Cell[267367, 5950, 328, 5, 118, "Text",ExpressionUUID->"484f13e7-decc-490f-83fe-33843daa8283"],
Cell[267698, 5957, 1235, 28, 237, "Input",ExpressionUUID->"14d4ed3b-fd1d-4560-b8e7-8f96eccafc18",
 InitializationCell->True],
Cell[268936, 5987, 219, 5, 71, "Text",ExpressionUUID->"46d13898-5611-4f0b-a417-f33f28c6d04b"],
Cell[269158, 5994, 667, 14, 134, "Input",ExpressionUUID->"6b95bfb1-95bf-420b-a45a-ead321e0a570",
 InitializationCell->True],
Cell[269828, 6010, 472, 15, 94, "Text",ExpressionUUID->"f2dbfe32-01da-4a32-9ed2-66e96b67fe5f"],
Cell[270303, 6027, 964, 26, 132, "Input",ExpressionUUID->"edd9685e-2725-43b3-a630-675f420d3a64",
 InitializationCell->True],
Cell[271270, 6055, 213, 3, 71, "Text",ExpressionUUID->"2b221114-07ae-42e6-b131-6acff2fb0a60"],
Cell[271486, 6060, 781, 24, 134, "Input",ExpressionUUID->"770fd7f2-9a31-45f4-96ff-c6278de245c4",
 InitializationCell->True],
Cell[272270, 6086, 250, 4, 71, "Text",ExpressionUUID->"48738604-58d5-459f-bea1-50442890abdf"],
Cell[272523, 6092, 2129, 67, 342, "Input",ExpressionUUID->"541923f4-e244-404d-96e9-35560d4f1877",
 InitializationCell->True],
Cell[274655, 6161, 5113, 95, 129, "Text",ExpressionUUID->"640c4b1d-e6c6-4305-a51f-280e1eed14d2"],
Cell[279771, 6258, 500, 12, 118, "Text",ExpressionUUID->"c4b19e9d-7f39-42b7-aa9d-08508f97ae9e"],
Cell[280274, 6272, 216, 3, 71, "Text",ExpressionUUID->"280c9538-823b-4440-ba5b-f50561cef8dc"],
Cell[280493, 6277, 753, 18, 237, "Input",ExpressionUUID->"858e3208-d718-44da-8650-f4bb7bbf4106",
 InitializationCell->True],
Cell[281249, 6297, 1449, 42, 228, "Input",ExpressionUUID->"fae90968-7930-4bf9-a4d4-ed02ad78e3d7",
 InitializationCell->True],
Cell[282701, 6341, 225, 5, 71, "Text",ExpressionUUID->"17c4cb30-65d9-453c-a763-1ab80fad5e38"],
Cell[282929, 6348, 1437, 30, 133, "Input",ExpressionUUID->"4b7162cd-f884-4a49-9c9b-9c4cca28b552",
 InitializationCell->True],
Cell[284369, 6380, 401, 8, 118, "Text",ExpressionUUID->"1adeb5d9-aa6b-4044-85a7-c7adb7011d1f"],
Cell[284773, 6390, 2206, 64, 364, "Input",ExpressionUUID->"7539fed7-0b24-494a-91f1-40c1ff5330f2",
 InitializationCell->True],
Cell[286982, 6456, 1519, 37, 439, "Input",ExpressionUUID->"3761d1a8-a3d7-4ea2-be59-841aede4e1ae",
 InitializationCell->True],
Cell[288504, 6495, 330, 6, 71, "Text",ExpressionUUID->"48f32096-f2f2-433f-8507-6411e9bd7c3c"],
Cell[288837, 6503, 1148, 33, 194, "Input",ExpressionUUID->"12df7d1d-571f-497f-8260-aedbf607efb5",
 InitializationCell->True],
Cell[289988, 6538, 197, 3, 71, "Text",ExpressionUUID->"9c134fa9-4cb8-4bc9-884b-bf5f36ac617f"],
Cell[290188, 6543, 346, 8, 71, "Text",ExpressionUUID->"8146f173-3453-4b54-8b04-30abdccc3c59",
 InitializationCell->True],
Cell[290537, 6553, 1912, 45, 194, "Input",ExpressionUUID->"f1d9d7dc-e85f-4f2d-8bef-2f0b54e565f8",
 InitializationCell->True],
Cell[292452, 6600, 196, 3, 71, "Text",ExpressionUUID->"6590673c-cb4a-4b75-ac66-416e49793062"],
Cell[292651, 6605, 285, 7, 71, "Text",ExpressionUUID->"e8668922-d12a-4828-9a05-1706cbffbf57"]
}, Open  ]],
Cell[CellGroupData[{
Cell[292973, 6617, 752, 16, 91, "Subsubsection",ExpressionUUID->"1ad40d36-696f-4c46-83b7-84b9d21b0704",
 InitializationCell->True],
Cell[293728, 6635, 325, 6, 118, "Text",ExpressionUUID->"b5a9e717-6055-4e37-a1f4-44cf853fbc60",
 InitializationCell->True],
Cell[294056, 6643, 1414, 30, 205, "Input",ExpressionUUID->"4f887b57-b76f-47f3-994d-f25a39726ac5",
 InitializationCell->True],
Cell[295473, 6675, 5854, 125, 696, "Input",ExpressionUUID->"f11feccd-a477-43ed-94f5-f12492b012c1",
 InitializationCell->True],
Cell[301330, 6802, 219, 5, 71, "Text",ExpressionUUID->"2b17b514-92b7-4d37-af3a-857ce508c118"],
Cell[301552, 6809, 2546, 54, 267, "Input",ExpressionUUID->"9fd08656-b663-47d6-b159-c99d6cee8f40",
 InitializationCell->True],
Cell[304101, 6865, 606, 13, 126, "Input",ExpressionUUID->"1ae279eb-9f78-4d87-9c75-cfbb6470faff",
 InitializationCell->True],
Cell[304710, 6880, 331, 7, 71, "Text",ExpressionUUID->"88014744-5fc4-4ca1-9e32-0dfb0690d2e2"],
Cell[305044, 6889, 587, 11, 118, "Text",ExpressionUUID->"bc978538-4767-49c6-8a59-75dad9de87d8",
 InitializationCell->True],
Cell[305634, 6902, 494, 9, 118, "Text",ExpressionUUID->"51d22cb0-9136-408d-99a0-931c2e2f8233",
 InitializationCell->True],
Cell[306131, 6913, 7373, 174, 312, "Input",ExpressionUUID->"21b33116-9ed8-4552-a416-07584d23f2b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[313541, 7092, 194, 4, 91, "Subsubsection",ExpressionUUID->"6293fb0d-db54-45ac-9684-a07657448b5f",
 InitializationCell->True],
Cell[313738, 7098, 506, 12, 71, "Text",ExpressionUUID->"235d0a71-0758-4774-8749-eb35d48ed486",
 InitializationCell->True],
Cell[314247, 7112, 204, 3, 71, "Text",ExpressionUUID->"948fd360-1619-4e24-9dbc-8cc1c87256d3"],
Cell[314454, 7117, 229, 5, 126, "Input",ExpressionUUID->"3d3791dd-4e6f-4194-b971-46c9bc51699b",
 InitializationCell->True],
Cell[314686, 7124, 160, 3, 71, "Text",ExpressionUUID->"f96f74ff-d110-467f-bfcc-8a1cbefb02d3"],
Cell[314849, 7129, 233, 5, 126, "Input",ExpressionUUID->"9f277fe9-2156-40b5-9da4-db0dc0af2833",
 InitializationCell->True],
Cell[315085, 7136, 121, 0, 71, "Text",ExpressionUUID->"ac4307d0-ec91-4cfb-bab7-634618ebb7f2"],
Cell[315209, 7138, 1763, 27, 126, "Input",ExpressionUUID->"2a6485ed-a426-4f1f-9172-262c09c4eb2b",
 InitializationCell->True],
Cell[316975, 7167, 182, 3, 71, "Text",ExpressionUUID->"47c18dab-d45e-4247-b719-05ee993ef630"],
Cell[317160, 7172, 410, 8, 71, "Text",ExpressionUUID->"761966d3-a4fc-4097-884a-9075bc91606f"],
Cell[317573, 7182, 1174, 31, 174, "Input",ExpressionUUID->"eea34792-2b5b-439c-aff8-9494c2d29b1c",
 InitializationCell->True],
Cell[318750, 7215, 425, 9, 71, "Text",ExpressionUUID->"1ec4e9da-f343-448e-ac04-588d86376e41",
 InitializationCell->True],
Cell[319178, 7226, 3110, 68, 319, "Input",ExpressionUUID->"29abbc03-dd41-43da-9ab4-2900c984b26c",
 InitializationCell->True],
Cell[322291, 7296, 717, 14, 118, "Text",ExpressionUUID->"5b723d5f-d14d-420d-b7cd-414f35586187"],
Cell[323011, 7312, 248, 4, 71, "Text",ExpressionUUID->"120f3cfa-4a48-495c-99aa-20c8b0dd1994"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[323320, 7323, 181, 4, 136, "Section",ExpressionUUID->"0a946751-a117-4719-8b42-08f5a5e4af45",
 InitializationCell->True],
Cell[323504, 7329, 243, 6, 71, "Text",ExpressionUUID->"27e1a108-f5d4-4444-884a-118fe5792c6a",
 InitializationCell->True],
Cell[323750, 7337, 218, 4, 71, "Text",ExpressionUUID->"bdf9d26c-ac89-497c-81d3-1eaf143a16eb",
 InitializationCell->True],
Cell[323971, 7343, 2521, 52, 273, "Input",ExpressionUUID->"2a3b0471-b7fc-4dc6-91dd-e138e1b2a054",
 InitializationCell->True],
Cell[326495, 7397, 211, 3, 71, "Text",ExpressionUUID->"b8231bf5-ae3b-42fd-8c90-f542b2983c72"],
Cell[326709, 7402, 500, 10, 126, "Input",ExpressionUUID->"61d479f9-1ee9-4be7-a0f6-d05f50ed9201",
 InitializationCell->True],
Cell[327212, 7414, 5423, 100, 512, "Input",ExpressionUUID->"9520c07e-d39a-478c-853d-92a23dc5364f",
 InitializationCell->True],
Cell[332638, 7516, 410, 8, 118, "Text",ExpressionUUID->"7ee89c75-22e3-4107-8865-d5a8c4899e1e"],
Cell[333051, 7526, 601, 16, 132, "Input",ExpressionUUID->"d0d51a82-3164-4008-89cb-dff494f0dc02",
 InitializationCell->True],
Cell[333655, 7544, 376, 7, 71, "Text",ExpressionUUID->"7eef18f2-c24d-4bb2-91ca-d84f48196186"],
Cell[334034, 7553, 1540, 38, 231, "Input",ExpressionUUID->"3c6d5dad-bd6b-4e20-ba27-18f4fc926d17",
 InitializationCell->True],
Cell[335577, 7593, 942, 22, 174, "Input",ExpressionUUID->"9313ce37-ccbf-4037-9576-03838c5b14f7",
 InitializationCell->True],
Cell[336522, 7617, 2681, 63, 278, "Input",ExpressionUUID->"eb23cbbb-e0b6-4770-8138-b524ca706f39",
 InitializationCell->True],
Cell[339206, 7682, 198, 5, 71, "Text",ExpressionUUID->"8ff8497e-b299-4e92-8a52-4deaee79775b",
 InitializationCell->True],
Cell[339407, 7689, 1453, 36, 132, "Input",ExpressionUUID->"f22f2b69-0352-4639-89d8-b6ffe299b722",
 InitializationCell->True],
Cell[340863, 7727, 192, 5, 71, "Text",ExpressionUUID->"b353db33-8d6c-4550-b782-1ece7208537d",
 InitializationCell->True],
Cell[341058, 7734, 1517, 27, 126, "Input",ExpressionUUID->"77221fcc-4bbc-44cd-ba5c-3493d0e574ce",
 InitializationCell->True],
Cell[342578, 7763, 415, 9, 118, "Text",ExpressionUUID->"2be3d427-7cab-4516-a8a2-6f6ab9910885",
 InitializationCell->True],
Cell[342996, 7774, 1117, 21, 132, "Input",ExpressionUUID->"77b77f46-53d5-4ec2-827a-9855477a83ad",
 InitializationCell->True],
Cell[344116, 7797, 479, 9, 71, "Text",ExpressionUUID->"a7d465fd-73c3-46d6-8f2c-cc0a1bb23b93",
 InitializationCell->True],
Cell[344598, 7808, 1596, 30, 174, "Input",ExpressionUUID->"8c85cc93-0c99-4882-8964-ddc3233147e2",
 InitializationCell->True],
Cell[346197, 7840, 434, 9, 71, "Text",ExpressionUUID->"21beab32-10b2-4584-8505-97af38a9c27a",
 InitializationCell->True],
Cell[346634, 7851, 1217, 24, 174, "Input",ExpressionUUID->"b0aa3f34-af67-4556-9008-87f240fa0f8a",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[347888, 7880, 244, 5, 136, "Section",ExpressionUUID->"723317c7-2342-4aca-a638-46f8f874aa9e",
 InitializationCell->True],
Cell[348135, 7887, 308, 7, 118, "Text",ExpressionUUID->"e41e1e3e-e45f-42c1-8e51-903cf72712ad",
 InitializationCell->True],
Cell[348446, 7896, 13873, 297, 1379, "Input",ExpressionUUID->"1516f96e-e5cb-41ce-b912-d8b5552f8330",
 InitializationCell->True],
Cell[362322, 8195, 354, 8, 71, "Text",ExpressionUUID->"91afd98c-f111-4b8b-b346-37170a827618",
 InitializationCell->True],
Cell[362679, 8205, 2290, 42, 174, "Input",ExpressionUUID->"f5376b45-03ed-4ff4-b908-c2af6bdb6410",
 InitializationCell->True],
Cell[364972, 8249, 307, 7, 71, "Text",ExpressionUUID->"8e460082-b944-44d5-889c-5a36d170242b",
 InitializationCell->True],
Cell[365282, 8258, 773, 16, 126, "Input",ExpressionUUID->"c7314dda-41f7-4916-b5a9-60589e3197e1",
 InitializationCell->True],
Cell[366058, 8276, 1106, 19, 126, "Input",ExpressionUUID->"72f6988d-8a30-499f-a89e-ddb72068fe9e",
 InitializationCell->True],
Cell[367167, 8297, 555, 12, 71, "Text",ExpressionUUID->"b3e10e1f-5256-4b59-ae82-0ed3df1885e6",
 InitializationCell->True],
Cell[367725, 8311, 1799, 32, 174, "Input",ExpressionUUID->"de64227a-0bdf-476f-9ec7-b09a9bb3466d",
 InitializationCell->True],
Cell[369527, 8345, 633, 15, 71, "Text",ExpressionUUID->"4620b4f0-f41a-4238-b109-d19fd4ef8c9a",
 InitializationCell->True],
Cell[370163, 8362, 1802, 32, 174, "Input",ExpressionUUID->"f4451e6b-512f-4bd5-bf60-ebdb677ae141",
 InitializationCell->True],
Cell[371968, 8396, 485, 8, 72, "Text",ExpressionUUID->"7ac05251-7bf5-414e-b711-d86eb916b762",
 InitializationCell->True],
Cell[372456, 8406, 1050, 24, 174, "Input",ExpressionUUID->"452c3adf-f12e-4f28-ba5d-79826ad3d4f9",
 InitializationCell->True],
Cell[373509, 8432, 294, 7, 71, "Text",ExpressionUUID->"d04e64ca-ed76-4a1a-b413-00e0f92cd5eb",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[373828, 8443, 202, 4, 110, "Subsection",ExpressionUUID->"a88ca11e-4e40-4fa3-ad61-fc276dc6bbd5",
 InitializationCell->True],
Cell[374033, 8449, 205, 4, 71, "Text",ExpressionUUID->"84a84357-ca12-4db7-8029-23b9ed4450f3",
 InitializationCell->True],
Cell[374241, 8455, 1543, 29, 168, "Input",ExpressionUUID->"2d32ffd0-c007-4d9d-8621-78999f8471ff",
 InitializationCell->True],
Cell[375787, 8486, 376, 8, 71, "Text",ExpressionUUID->"5fe1a335-1ef0-4f62-a23e-7b88f36d63c8",
 InitializationCell->True],
Cell[376166, 8496, 1675, 35, 174, "Input",ExpressionUUID->"4cab1aea-71cc-407a-814f-25b1b4b5f430",
 InitializationCell->True],
Cell[377844, 8533, 538, 11, 71, "Text",ExpressionUUID->"46816bd7-9381-441a-8372-6eab46c8cb61"],
Cell[378385, 8546, 1810, 37, 170, "Input",ExpressionUUID->"897208c4-337b-4d72-b9df-70cdba421e47",
 InitializationCell->True],
Cell[380198, 8585, 435, 10, 118, "Text",ExpressionUUID->"970b9acd-b6e8-468c-9d6b-ab5d15277cc0",
 InitializationCell->True],
Cell[380636, 8597, 553, 10, 118, "Text",ExpressionUUID->"87915065-dfe5-4d80-b112-9fbdef9cc0da",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[381238, 8613, 250, 5, 136, "Section",ExpressionUUID->"9c0d5916-5706-4a64-8805-c4452336559b",
 InitializationCell->True],
Cell[381491, 8620, 1078, 22, 272, "Text",ExpressionUUID->"6fb94578-c2e4-4da0-b468-19573c655fad",
 InitializationCell->True],
Cell[382572, 8644, 656, 16, 126, "Input",ExpressionUUID->"f5e19d5f-dcce-4bd9-a7c0-e585740457b7",
 InitializationCell->True],
Cell[383231, 8662, 1738, 32, 174, "Input",ExpressionUUID->"a814a364-1111-4021-9ca6-48cbfe1fc5d6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[385006, 8699, 340, 6, 136, "Section",ExpressionUUID->"796a2c72-649c-460e-bde4-03237cb89614",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[385371, 8709, 153, 3, 110, "Subsection",ExpressionUUID->"5a792a66-3049-4c3d-acc8-ce1b3210bb94"],
Cell[385527, 8714, 471, 9, 165, "Text",ExpressionUUID->"f9694a7f-1685-4766-b9f7-a12a1646c55d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[386035, 8728, 231, 4, 110, "Subsection",ExpressionUUID->"ff312926-d311-4761-a937-5b9132e1bf63"],
Cell[386269, 8734, 228, 5, 71, "Text",ExpressionUUID->"385736b0-a9a0-4950-88c3-1bbfccaeb084"],
Cell[386500, 8741, 415, 12, 126, "Input",ExpressionUUID->"33545788-7b10-4e5d-ae31-a2ea99a4e338",
 InitializationCell->True],
Cell[386918, 8755, 273, 5, 72, "Text",ExpressionUUID->"250d2e6f-7b9d-46d7-acff-15657f2c3409"],
Cell[387194, 8762, 863, 25, 126, "Input",ExpressionUUID->"53dcc720-6b66-4465-9633-2aa1b2c4a7f3",
 InitializationCell->True],
Cell[388060, 8789, 251, 4, 165, "Text",ExpressionUUID->"303c681e-d506-4d30-80ec-b591c0998c91"],
Cell[388314, 8795, 7233, 182, 747, "Input",ExpressionUUID->"53cfe635-7831-4d85-93c6-04f21df61ce0",
 InitializationCell->True],
Cell[395550, 8979, 244, 4, 118, "Text",ExpressionUUID->"6b83d46a-25a3-4c95-9e96-dfe065cb665d"],
Cell[395797, 8985, 8188, 193, 705, "Input",ExpressionUUID->"d0be71b7-a7ca-4539-bd89-55689b3ead81",
 InitializationCell->True],
Cell[403988, 9180, 476, 10, 118, "Text",ExpressionUUID->"5bbe805a-42ff-4ef8-b2f0-0228ac3cd4f1",
 InitializationCell->True],
Cell[404467, 9192, 5340, 143, 693, "Input",ExpressionUUID->"86062f24-7f5b-491a-80fa-4dfbe4a42146",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[409844, 9340, 231, 4, 110, "Subsection",ExpressionUUID->"fc5a519c-044c-41c2-8b8e-c18f9fc94d2d"],
Cell[410078, 9346, 200, 3, 71, "Text",ExpressionUUID->"362acbee-0764-4946-9e83-456a072503fc"],
Cell[410281, 9351, 499, 10, 165, "Text",ExpressionUUID->"da793b32-a693-4901-9d1a-f5bb48a61af3",
 InitializationCell->True],
Cell[410783, 9363, 227, 3, 71, "Text",ExpressionUUID->"5d8bc187-f0d7-4847-bd01-67426cc62a97"],
Cell[411013, 9368, 1862, 46, 175, "Input",ExpressionUUID->"42dae31b-01fd-4549-b526-2887f01b6f90",
 InitializationCell->True],
Cell[412878, 9416, 234, 4, 71, "Text",ExpressionUUID->"8323285d-7277-4952-9e2b-162eeff7b4e3",
 InitializationCell->True],
Cell[413115, 9422, 153, 2, 71, "Text",ExpressionUUID->"93ae5bb0-dbe7-473d-bef2-db1655a7c0cc"],
Cell[413271, 9426, 12404, 320, 1512, "Input",ExpressionUUID->"28fc4704-184b-4bc7-8dc0-c7e6fee89cce",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[425712, 9751, 222, 4, 110, "Subsection",ExpressionUUID->"f3677493-ad71-46ce-ae8e-88b9c1ece9a7"],
Cell[425937, 9757, 313, 8, 259, "Text",ExpressionUUID->"9f75ebfd-0398-45d6-9d72-b18fa4f9b1bb",
 InitializationCell->True],
Cell[426253, 9767, 172, 2, 71, "Text",ExpressionUUID->"79e6f394-be83-438c-a840-ebc2facee63f"],
Cell[426428, 9771, 775, 13, 142, "Input",ExpressionUUID->"a9479f35-6b54-4e43-a3d7-ab058599c19e"],
Cell[427206, 9786, 4294, 111, 569, "Input",ExpressionUUID->"5b09f7b8-2a70-492e-8702-889ef2225c21",
 InitializationCell->True],
Cell[431503, 9899, 360, 7, 71, "Text",ExpressionUUID->"eec702f1-9a46-41fb-ad96-5c9c645d5c2b"],
Cell[431866, 9908, 5792, 132, 512, "Input",ExpressionUUID->"538fe268-799d-4732-9189-637c968b8efd",
 InitializationCell->True],
Cell[437661, 10042, 197, 3, 71, "Text",ExpressionUUID->"9f717899-a1e4-4e00-af16-adfd7e45ff3d"],
Cell[437861, 10047, 2399, 57, 276, "Input",ExpressionUUID->"d93cc058-9001-4984-bc50-d4f229ee9bf7",
 InitializationCell->True],
Cell[440263, 10106, 177, 3, 71, "Text",ExpressionUUID->"8fbc4548-f4f8-4da5-b830-ae70821f5c5a"],
Cell[440443, 10111, 479, 10, 118, "Text",ExpressionUUID->"20a5b656-5261-45a4-9ced-281a0cb27465",
 InitializationCell->True],
Cell[440925, 10123, 16121, 326, 1238, "Input",ExpressionUUID->"ec6154eb-b241-4374-9346-a09ea3f4d533",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[457083, 10454, 339, 5, 110, "Subsection",ExpressionUUID->"d2dc865e-00f3-440c-8900-c687f79f0cfb"],
Cell[457425, 10461, 306, 4, 118, "Text",ExpressionUUID->"26935800-4224-45f0-9a11-d069362e2db6"],
Cell[457734, 10467, 1452, 33, 221, "Input",ExpressionUUID->"3d22df03-bfce-4ada-917c-f2bf43e21347",
 InitializationCell->True],
Cell[459189, 10502, 473, 9, 71, "Text",ExpressionUUID->"628e3b84-bad5-462f-b140-b944ddffc91a",
 InitializationCell->True],
Cell[459665, 10513, 672, 17, 126, "Input",ExpressionUUID->"d1629a70-0ffb-4e57-a9e9-14930147e9ce",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[460386, 10536, 170, 3, 136, "Section",ExpressionUUID->"1dda229b-1df7-44f8-98ed-3df5b878e9d6"],
Cell[460559, 10541, 103, 0, 71, "Text",ExpressionUUID->"34d31060-a104-4f69-ad77-fd211d63a546"],
Cell[460665, 10543, 4577, 90, 597, "Input",ExpressionUUID->"9d8adf05-77ee-430f-b806-8bbb80b00470",
 InitializationCell->True],
Cell[465245, 10635, 808, 21, 221, "Input",ExpressionUUID->"9cb79178-05ea-4aba-9104-042c376fffb7",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[466090, 10661, 404, 6, 136, "Section",ExpressionUUID->"d7fb6dc0-79f4-4c35-b59d-633e95dc9643",
 InitializationCell->True],
Cell[466497, 10669, 552, 11, 118, "Text",ExpressionUUID->"2df703e6-e6ab-452c-9465-0406bc56d708",
 InitializationCell->True],
Cell[467052, 10682, 371, 7, 71, "Text",ExpressionUUID->"cb74fbb5-3670-4931-aaaf-c730d65ed74c"],
Cell[CellGroupData[{
Cell[467448, 10693, 1328, 30, 268, "Input",ExpressionUUID->"82866637-a832-488c-8bed-3445bd549f04",
 InitializationCell->True],
Cell[468779, 10725, 661, 13, 102, "Output",ExpressionUUID->"737ef55b-b194-4680-93a5-706d586c9c51"]
}, Open  ]],
Cell[469455, 10741, 924, 17, 174, "Input",ExpressionUUID->"c6a6272f-050b-41fe-a4c9-a01528cd58c8",
 InitializationCell->True],
Cell[470382, 10760, 624, 13, 126, "Input",ExpressionUUID->"d4e6efe5-31d0-43ee-9e1b-46350ea23df7",
 InitializationCell->True],
Cell[471009, 10775, 723, 14, 72, "Text",ExpressionUUID->"e9facffe-bb50-4220-b464-d90979030326"],
Cell[471735, 10791, 527, 11, 71, "Text",ExpressionUUID->"def768aa-e09d-4ad1-86ea-ee90f5a32461"],
Cell[472265, 10804, 2176, 57, 644, "Input",ExpressionUUID->"5e486bd9-fa38-46e2-b586-5e7c7a408bbe",
 InitializationCell->True],
Cell[474444, 10863, 270, 5, 71, "Text",ExpressionUUID->"cfb25198-5671-4d65-8d90-2985f00e5289"],
Cell[CellGroupData[{
Cell[474739, 10872, 3638, 87, 691, "Input",ExpressionUUID->"a238ba9e-05a7-4f12-817e-84e903c0f624",
 InitializationCell->True],
Cell[478380, 10961, 1462, 23, 102, "Output",ExpressionUUID->"92303e89-4c77-4eaf-b59a-e8083795802e"]
}, Open  ]],
Cell[479857, 10987, 616, 15, 71, "Text",ExpressionUUID->"2e09d548-cdbf-4c7a-a90e-1fe02ee09601",
 InitializationCell->True],
Cell[480476, 11004, 1208, 29, 221, "Input",ExpressionUUID->"29fcf689-3451-41b1-8878-47e3b01f3564",
 InitializationCell->True],
Cell[481687, 11035, 871, 21, 71, "Text",ExpressionUUID->"e97c8450-f5f2-42bb-8055-87dd8789799d",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[482583, 11060, 661, 12, 126, "Input",ExpressionUUID->"6fb48859-7390-4309-b1ec-1c2809bf2a67",
 InitializationCell->True],
Cell[483247, 11074, 1506, 22, 102, "Output",ExpressionUUID->"62510b2d-71b4-416b-b5b8-0f0ee4c7b109"]
}, Open  ]],
Cell[CellGroupData[{
Cell[484790, 11101, 749, 15, 181, "Code",ExpressionUUID->"af5e75bb-fb0e-4926-9104-644b711dd58a"],
Cell[485542, 11118, 495, 10, 50, "Print",ExpressionUUID->"c138821e-460f-4f7f-ac4e-e513f3fa7245"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

